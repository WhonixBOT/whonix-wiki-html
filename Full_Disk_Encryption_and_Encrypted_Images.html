<!DOCTYPE html>
<html class="client-nojs" dir="ltr" lang="en"><!-- 
 single html processed by https://github.com/zTrix/webpage2html
 title: Full Disk Encryption and Encrypted Images - Whonix
 url: ./Full_Disk_Encryption_and_Encrypted_Images
 date: Wed Jan  2 07:54:42 2019
-->
<head>
<meta charset="utf-8"/>
<title>Full Disk Encryption and Encrypted Images - Whonix</title>
<link rel="stylesheet" type="text/css" href="style.css">




<meta content="" name="ResourceLoaderDynamicStyles"/>

<meta content="MediaWiki 1.31.1" name="generator"/>
<meta content="" name="google-site-verification"/>
<meta content="https://www.whonix.org/w/images/0/0d/Fulldeskencryption423423.jpg" name="image"/>
<meta content="https://www.whonix.org/w/images/0/0d/Fulldeskencryption423423.jpg" name="twitter:image:src"/>
<meta content="summary_large_image" name="twitter:card"/>
<meta content="@Whonix" name="twitter:site"/>
<meta content="Whonix" name="twitter:domain"/>
<meta content="@Whonix" name="twitter:creator"/>
<meta content="Full Disk Encryption and Encrypted Images, Additional Security Measures" name="description"/>
<meta content="Full Disk Encryption and Encrypted Images, Additional Security Measures" name="twitter:description"/>
<meta content="width=device-width, user-scalable=yes, initial-scale=1.0" name="viewport"/>
<link data-href="/w/index.php?title=Full_Disk_Encryption_and_Encrypted_Images&amp;action=edit" href="https://www.whonix.org/w/index.php?title=Full_Disk_Encryption_and_Encrypted_Images&amp;action=edit" rel="alternate.html" title="Edit" type="application/x-wiki"/>
<link data-href="/w/index.php?title=Full_Disk_Encryption_and_Encrypted_Images&amp;action=edit" href="https://www.whonix.org/w/index.php?title=Full_Disk_Encryption_and_Encrypted_Images&amp;action=edit" rel="edit.html" title="Edit"/>
<link data-href="/favicon.ico" href="https://www.whonix.org/favicon.ico" rel="shortcut icon"/>
<link data-href="/w/opensearch_desc.php" href="https://www.whonix.org/w/opensearch_desc.php" rel="search.html" title="Whonix (en)" type="application/opensearchdescription+xml"/>
<link data-href="http://dds6qkxpwdeubwucdiaord2xgbbeyds25rbsgr73tbfpqpt4a6vjwsyd.onion/w/api.php?action=rsd" href="http://dds6qkxpwdeubwucdiaord2xgbbeyds25rbsgr73tbfpqpt4a6vjwsyd.onion/w/api.php?action=rsd" rel="EditURI" type="application/rsd+xml"/>
<link data-href="/w/index.php?title=Special:RecentChanges&amp;feed=atom" href="https://www.whonix.org/w/index.php?title=Special:RecentChanges&amp;feed=atom" rel="alternate.html" title="Whonix Atom feed" type="application/atom+xml"/>
<meta content="article" property="og:type"/>
<meta content="Whonix" property="og:site_name"/>
<meta content="Full Disk Encryption and Encrypted Images" property="og:title"/>
<meta content="http://dds6qkxpwdeubwucdiaord2xgbbeyds25rbsgr73tbfpqpt4a6vjwsyd.onion/wiki/Full_Disk_Encryption_and_Encrypted_Images" property="og:url"/>
<meta content="https://www.whonix.org/w/images/0/0d/Fulldeskencryption423423.jpg" property="og:image"/>
<meta content="Full Disk Encryption and Encrypted Images, Additional Security Measures" property="og:description"/>

<meta content="" property="fb:app_id"/>
<meta content="" property="fb:admins"/>
<meta content="https://www.facebook.com/Whonix" property="article:author"/>
<meta content="https://www.facebook.com/Whonix" property="article:publisher"/>
<meta content="IE=edge" http-equiv="X-UA-Compatible"/>
<!--[if lt IE 9]><script src="/w/load.php?debug=false&amp;lang=en&amp;modules=html5shiv&amp;only=scripts&amp;skin=foreground&amp;sync=1"></script><![endif]-->
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Full_Disk_Encryption_and_Encrypted_Images rootpage-Full_Disk_Encryption_and_Encrypted_Images skin-foreground action-view"><div id="navwrapper"><!-- START FOREGROUNDTEMPLATE -->

</div>
<div id="page-content">
<div class="row">
<div class="large-12 columns">
<!-- Output page indicators -->
<div class="mw-indicators mw-body-content">
</div>
<!-- If user is logged in output echo location -->
<!--[if lt IE 9]>
				<div id="siteNotice" class="sitenotice panel radius">Whonix may not look as expected in this version of Internet Explorer. We recommend you upgrade to a newer version of Internet Explorer or switch to a browser like Firefox or Chrome.</div>
				<![endif]-->
<div class="sitenotice" id="siteNotice"><div dir="ltr" id="localNotice" lang="en"><div class="mw-parser-output"><p><style type="text/css">

#banner {
 position: relative;
 overflow: hidden;
 margin-bottom: 0.5em !important;
 margin-top: 0.5em !important;
 background-color:#D03232;
 border: solid 1px #aaaaaa; 
 height:66px;
}

#banner a.cn-full-banner-click {
 display:block;
 height:100%;
 width:100%;
 cursor: pointer;
}


#banner-logo {
 position: absolute;
 top: 8px;
 left: 15px;
 background-image: url(data:image/png;base64,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);
 height: 50px;
 width: 100%;
 background-repeat: no-repeat;
}

#banner #black-text {
 font-size: 1.1em;
 color: white;
 padding: 0.5em 40px 0.4em 60px;
 line-height: 1.3em;
 text-align: center;
}
</style>
</p><div id="banner">
<a class="cn-full-banner-click" data-href="/wiki/Payments" href="./Payments.html" title="">
<div id="banner-logo"></div>
<div id="black-text">
Whonix requires money to stay alive.
     </div>
</a>
</div>
</div></div></div> </div>
</div>
<div id="mw-js-message" style="display:none;"></div>
<div class="row">
<div class="large-12 columns" id="p-cactions">
<a class="button small secondary radius" data-dropdown="actions" data-options="align:left; is_hover: true; hover_timeout:700" href="#" id="actions-button"><i class="fa fa-cog"><span class="show-for-medium-up"> Actions</span></i></a>
<!--RTL -->
<ul class="f-dropdown" data-dropdown-content="" id="actions">
<li class="selected" id="ca-nstab-main"><a accesskey="c" data-href="/wiki/Full_Disk_Encryption_and_Encrypted_Images" href="./Full_Disk_Encryption_and_Encrypted_Images.html" title="View the content page [c]">Page</a></li><li class="new" id="ca-talk"><a accesskey="t" data-href="/w/index.php?title=Talk:Full_Disk_Encryption_and_Encrypted_Images&amp;action=edit&amp;redlink=1" href="https://www.whonix.org/w/index.php?title=Talk:Full_Disk_Encryption_and_Encrypted_Images&amp;action=edit&amp;redlink=1" rel="discussion.html" title="Discussion about the content page (page does not exist) [t]">Discussion</a></li><li id="ca-edit"><a accesskey="e" data-href="/w/index.php?title=Full_Disk_Encryption_and_Encrypted_Images&amp;action=edit" href="https://www.whonix.org/w/index.php?title=Full_Disk_Encryption_and_Encrypted_Images&amp;action=edit.html" title="Edit this page [e]">Edit</a></li><li id="ca-history"><a accesskey="h" data-href="/w/index.php?title=Full_Disk_Encryption_and_Encrypted_Images&amp;action=history" href="https://www.whonix.org/w/index.php?title=Full_Disk_Encryption_and_Encrypted_Images&amp;action=history.html" title="Past revisions of this page [h]">History</a></li> </ul>
<!--RTL -->
<div id="content">
<h1 class="title" id="firstHeading">Full Disk Encryption and Encrypted Images</h1>
<h5 class="subtitle" id="siteSub"></h5>
<div class="clear_both" id="contentSub"></div>
<div class="mw-bodytext" id="bodyContent">
<div class="mw-content-ltr" dir="ltr" id="mw-content-text" lang="en"><div class="mw-parser-output">
<table class="wikitable" style="background-color: #fff;text-align: center">
<tbody><tr>
<th colspan="2">About this <i><span style="background-color:#FBFBFB">Full Disk Encryption and Encrypted Images</span></i> Page
</th></tr>
<tr>
<th>Support Status
</th>
<th>stable
</th></tr>
<tr>
<th>Difficulty
</th>
<th>easy
</th></tr>
<tr>
<th><a data-href="/wiki/Contribute#Maintainer" href="./Contribute.html" title="Contribute">Maintainer</a>
</th>
<th><a class="external text" data-href="https://forums.whonix.org/users/HulaHoop" href="https://forums.whonix.org/users/HulaHoop" rel="noreferrer noopener" target="_blank">HulaHoop</a>
</th></tr>
<tr>
<th>Support
</th>
<th><a data-href="/wiki/Support" href="./Support.html" title="Support">Support</a>
</th></tr>
</tbody></table>
<div class="toc" id="toc"><div class="toctitle" dir="ltr" lang="en"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Full_Disk_Encryption_on_the_Host"><span class="tocnumber">1</span> <span class="toctext">Full Disk Encryption on the Host</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#Protection_Against_Powerful_Adversaries"><span class="tocnumber">1.1</span> <span class="toctext">Protection Against Powerful Adversaries</span></a>
<ul>
<li class="toclevel-3 tocsection-3"><a href="#Debian_Hosts"><span class="tocnumber">1.1.1</span> <span class="toctext">Debian Hosts</span></a></li>
<li class="toclevel-3 tocsection-4"><a href="#Removable_Media"><span class="tocnumber">1.1.2</span> <span class="toctext">Removable Media</span></a>
<ul>
<li class="toclevel-4 tocsection-5"><a href="#New_Removable_Media"><span class="tocnumber">1.1.2.1</span> <span class="toctext">New Removable Media</span></a></li>
<li class="toclevel-4 tocsection-6"><a href="#Legacy_Device_Encryption_Upgrade"><span class="tocnumber">1.1.2.2</span> <span class="toctext">Legacy Device Encryption Upgrade</span></a></li>
</ul>
</li>
<li class="toclevel-3 tocsection-7"><a href="#Additional_Measures"><span class="tocnumber">1.1.3</span> <span class="toctext">Additional Measures</span></a>
<ul>
<li class="toclevel-4 tocsection-8"><a href="#LUKS_Suspend_Scripts"><span class="tocnumber">1.1.3.1</span> <span class="toctext">LUKS Suspend Scripts</span></a></li>
<li class="toclevel-4 tocsection-9"><a href="#Magic_Key_Feature"><span class="tocnumber">1.1.3.2</span> <span class="toctext">Magic Key Feature</span></a></li>
<li class="toclevel-4 tocsection-10"><a href="#USBKill"><span class="tocnumber">1.1.3.3</span> <span class="toctext">USBKill</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-2 tocsection-11"><a href="#Protection_Against_Lesser_Adversaries"><span class="tocnumber">1.2</span> <span class="toctext">Protection Against Lesser Adversaries</span></a>
<ul>
<li class="toclevel-3 tocsection-12"><a href="#Advice_for_Solid-state_Drives_and_USB_Storage"><span class="tocnumber">1.2.1</span> <span class="toctext">Advice for Solid-state Drives and USB Storage</span></a></li>
<li class="toclevel-3 tocsection-13"><a href="#Gnome_Disks_Utility"><span class="tocnumber">1.2.2</span> <span class="toctext">Gnome Disks Utility</span></a></li>
<li class="toclevel-3 tocsection-14"><a href="#Nuke_Patch_for_cryptsetup"><span class="tocnumber">1.2.3</span> <span class="toctext">Nuke Patch for cryptsetup</span></a></li>
<li class="toclevel-3 tocsection-15"><a href="#Separate_.2Fboot_Partition"><span class="tocnumber">1.2.4</span> <span class="toctext">Separate /boot Partition</span></a></li>
<li class="toclevel-3 tocsection-16"><a href="#TRESOR_Kernel_Patch"><span class="tocnumber">1.2.5</span> <span class="toctext">TRESOR Kernel Patch</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-17"><a href="#Encrypted_Guest_Images"><span class="tocnumber">2</span> <span class="toctext">Encrypted Guest Images</span></a>
<ul>
<li class="toclevel-2 tocsection-18"><a href="#Full_Disk_Encryption_within_the_Virtual_Machine"><span class="tocnumber">2.1</span> <span class="toctext">Full Disk Encryption within the Virtual Machine</span></a></li>
<li class="toclevel-2 tocsection-19"><a href="#Virtual_Machine_Files_in_an_Encrypted_Container"><span class="tocnumber">2.2</span> <span class="toctext">Virtual Machine Files in an Encrypted Container</span></a></li>
<li class="toclevel-2 tocsection-20"><a href="#Other_Security_Considerations"><span class="tocnumber">2.3</span> <span class="toctext">Other Security Considerations</span></a></li>
<li class="toclevel-2 tocsection-21"><a href="#Open_Security_Research_Questions"><span class="tocnumber">2.4</span> <span class="toctext">Open Security Research Questions</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-22"><a href="#Footnotes"><span class="tocnumber">3</span> <span class="toctext">Footnotes</span></a></li>
<li class="toclevel-1 tocsection-23"><a href="#License"><span class="tocnumber">4</span> <span class="toctext">License</span></a></li>
</ul>
</div>
<h1><span class="mw-headline" id="Full_Disk_Encryption_on_the_Host">Full Disk Encryption on the Host</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Full_Disk_Encryption_and_Encrypted_Images&amp;action=edit&amp;section=1" href="https://www.whonix.org/w/index.php?title=Full_Disk_Encryption_and_Encrypted_Images&amp;action=edit&amp;section=1.html" title="Edit section: Full Disk Encryption on the Host">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<table class="plainlinks metadata ambox ambox-notice" role="presentation"><tbody><tr><td class="mbox-image"><div style="width:52px"><a class="image" data-href="/w/index.php?title=File:Ambox_warning_pn.svg.png&amp;filetimestamp=20130717200816&amp;" href="https://www.whonix.org/w/index.php?title=File:Ambox_warning_pn.svg.png&amp;filetimestamp=20130717200816&amp;"><img alt="Ambox warning pn.svg.png" data-src="/w/images/thumb/f/f7/Ambox_warning_pn.svg.png/40px-Ambox_warning_pn.svg.png" data-srcset="/w/images/thumb/f/f7/Ambox_warning_pn.svg.png/60px-Ambox_warning_pn.svg.png 1.5x, /w/images/thumb/f/f7/Ambox_warning_pn.svg.png/80px-Ambox_warning_pn.svg.png 2x" height="35" src="data:image/png;base64,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" width="40"/></a></div></td><td class="mbox-text"><div class="mbox-text-span">As outlined on the <a data-href="/wiki/Warning#Whonix_is_not_Amnesic" href="./Warning.html" title="Warning">Warning page</a>, Whonix has not been designed as an amnesic operating system. Traces of the installation and user activities will be written to disk. <sup class="reference" id="cite_ref-1"><a href="#cite_note-1">[1]</a></sup></div></td></tr></tbody></table>
<h2><span class="mw-headline" id="Protection_Against_Powerful_Adversaries">Protection Against Powerful Adversaries</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Full_Disk_Encryption_and_Encrypted_Images&amp;action=edit&amp;section=2" href="https://www.whonix.org/w/index.php?title=Full_Disk_Encryption_and_Encrypted_Images&amp;action=edit&amp;section=2.html" title="Edit section: Protection Against Powerful Adversaries">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>To protect against theft or robbery of personal information or data, users should apply FDE (Full Disk Encryption) on the host, and power off their computer when exposed to higher-risk situations like traveling. Laptop users should temporarily remove the laptop battery after powering off. This ensures that the RAM chips are completely powered down and that any encryption key/s in memory are erased. Hibernation is also a safe alternative, as the swap partition is encrypted in the default FDE configuration for various platforms (like Debian), provided the user did not change anything. 
</p><p>Users should follow the standard advice for picking <a data-href="/wiki/Passwords#Generating_Unbreakable_Passwords" href="./Passwords.html" title="Passwords">strong and unique passphrases</a>, so they cannot be feasibly brute-forced. Computers should never be left unattended in untrusted venues.
</p>
<h3><span class="mw-headline" id="Debian_Hosts">Debian Hosts</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Full_Disk_Encryption_and_Encrypted_Images&amp;action=edit&amp;section=3" href="https://www.whonix.org/w/index.php?title=Full_Disk_Encryption_and_Encrypted_Images&amp;action=edit&amp;section=3.html" title="Edit section: Debian Hosts">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Configuring FDE during system install is straightforward. The default cipher is AES-256 in XTS mode. 
</p>
<h3><span class="mw-headline" id="Removable_Media">Removable Media</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Full_Disk_Encryption_and_Encrypted_Images&amp;action=edit&amp;section=4" href="https://www.whonix.org/w/index.php?title=Full_Disk_Encryption_and_Encrypted_Images&amp;action=edit&amp;section=4.html" title="Edit section: Removable Media">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<h4><span class="mw-headline" id="New_Removable_Media">New Removable Media</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Full_Disk_Encryption_and_Encrypted_Images&amp;action=edit&amp;section=5" href="https://www.whonix.org/w/index.php?title=Full_Disk_Encryption_and_Encrypted_Images&amp;action=edit&amp;section=5.html" title="Edit section: New Removable Media">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>Gnome Disks Utility creates LUKS partitions with AES-128 by default which is insufficient in event of quantum computers materializing. Therefore, an appropriately secure container must be manually created. Afterwards, unlock the device and format the internal filesystem as EXT4 in Gnome Disks. 
</p><p>First enumerate the device. They will usually be called 'sdb1', as sdaX is reserved for the system on default installs. To avoid confusion, only connect one removable device at a time:
</p><div class="codeContainerNew">
<div class="preDiv">
<pre># ls /dev/</pre>
</div>
<div class="textareaDiv">
<textarea class="codeBoxAreaNew" onfocus="this.select()" readonly="readonly" rows="1"># ls /dev/</textarea>
</div>
</div>
<p>Create a LUKS container and change the device name as needed, then follow the prompts:
</p><div class="codeContainerNew">
<div class="preDiv">
<pre># cryptsetup -v --cipher aes-xts-plain64 --key-size 512 --use-random luksFormat &lt;device&gt;</pre>
</div>
<div class="textareaDiv">
<textarea class="codeBoxAreaNew" onfocus="this.select()" readonly="readonly" rows="1"># cryptsetup -v --cipher aes-xts-plain64 --key-size 512 --use-random luksFormat &lt;device&gt;</textarea>
</div>
</div>
<h4><span class="mw-headline" id="Legacy_Device_Encryption_Upgrade">Legacy Device Encryption Upgrade</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Full_Disk_Encryption_and_Encrypted_Images&amp;action=edit&amp;section=6" href="https://www.whonix.org/w/index.php?title=Full_Disk_Encryption_and_Encrypted_Images&amp;action=edit&amp;section=6.html" title="Edit section: Legacy Device Encryption Upgrade">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>It is safer to re-encrypt the device with a stronger key rather than performing a quick format that will otherwise leave the old/weaker header intact. 
</p><p>First enumerate the device. They will usually be called 'sdb1', as sdaX is reserved for the system on default installs. To avoid confusion, only connect one removable device at a time:
</p><div class="codeContainerNew">
<div class="preDiv">
<pre># ls /dev/</pre>
</div>
<div class="textareaDiv">
<textarea class="codeBoxAreaNew" onfocus="this.select()" readonly="readonly" rows="1"># ls /dev/</textarea>
</div>
</div>
<p>To view the LUKS header data in order to make necessary adjustments, run:
</p><div class="codeContainerNew">
<div class="preDiv">
<pre># cryptsetup luksDump --debug &lt;device&gt;</pre>
</div>
<div class="textareaDiv">
<textarea class="codeBoxAreaNew" onfocus="this.select()" readonly="readonly" rows="1"># cryptsetup luksDump --debug &lt;device&gt;</textarea>
</div>
</div>
<p>LUKS header data legend: 
</p>
<ul><li>'MK' means 'Master Key'. <sup class="reference" id="cite_ref-2"><a href="#cite_note-2">[2]</a></sup></li>
<li>AES in XTS mode uses a key size double its bit size (512 in this case) since in XTS the key is split in 2, resulting in AES with 256-bit keys. <sup class="reference" id="cite_ref-3"><a href="#cite_note-3">[3]</a></sup></li>
<li>'Payload offset' is 4096 for 256-bit keys and 2048 for 128-bit keys. <sup class="reference" id="cite_ref-4"><a href="#cite_note-4">[4]</a></sup></li></ul>
<p>Re-encrypt the device with stronger keys. <sup class="reference" id="cite_ref-5"><a href="#cite_note-5">[5]</a></sup> Fortunately, header resizing is usually unnecessary (otherwise it will abort the process):
</p><div class="codeContainerNew">
<div class="preDiv">
<pre># cryptsetup-reencrypt &lt;device&gt; -c aes-xts-plain64 -s 512 --use-directio</pre>
</div>
<div class="textareaDiv">
<textarea class="codeBoxAreaNew" onfocus="this.select()" readonly="readonly" rows="1"># cryptsetup-reencrypt &lt;device&gt; -c aes-xts-plain64 -s 512 --use-directio</textarea>
</div>
</div>
<p>Abruptly disconnecting power can cause data loss. To safely pause the process (in case of system sleep/shutdown), cryptsetup can be suspended (e.g. by <code>Ctrl+c</code>) and it will automatically restart from where it left off if temporary header files are present in the home directory. <sup class="reference" id="cite_ref-6"><a href="#cite_note-6">[6]</a></sup>
</p>
<table class="plainlinks metadata ambox ambox-notice" role="presentation"><tbody><tr><td class="mbox-image"><div style="width:52px"><a class="image" data-href="/w/index.php?title=File:Ambox_notice.png&amp;filetimestamp=20130717195411&amp;" href="https://www.whonix.org/w/index.php?title=File:Ambox_notice.png&amp;filetimestamp=20130717195411&amp;"><img alt="Info" data-src="/w/images/c/c8/Ambox_notice.png" height="40" src="data:image/png;base64,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" width="40"/></a></div></td><td class="mbox-text"><div class="mbox-text-span">It is safest to assume that a machine has been compromised after any unauthorized physical access.</div></td></tr></tbody></table>
<p><br/>
If unauthorized access is strongly suspected or confirmed, the hardware should not be trusted or used after it is back in the user's possession. This scenario is only relevant to a smaller subset of users who are already targeted for physical surveillance. A sufficiently skilled adversary can infect it with spyware or sabotage it in a number of ways that are virtually undetectable. For example, malicious firmware could be installed to record all activities, or the machine rendered inoperable by bricking the hardware. In that eventuality, none of the measures outlined will help.
</p>
<h3><span class="mw-headline" id="Additional_Measures">Additional Measures</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Full_Disk_Encryption_and_Encrypted_Images&amp;action=edit&amp;section=7" href="https://www.whonix.org/w/index.php?title=Full_Disk_Encryption_and_Encrypted_Images&amp;action=edit&amp;section=7.html" title="Edit section: Additional Measures">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<h4><span class="mw-headline" id="LUKS_Suspend_Scripts">LUKS Suspend Scripts</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Full_Disk_Encryption_and_Encrypted_Images&amp;action=edit&amp;section=8" href="https://www.whonix.org/w/index.php?title=Full_Disk_Encryption_and_Encrypted_Images&amp;action=edit&amp;section=8.html" title="Edit section: LUKS Suspend Scripts">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>On Linux hosts, there is one interesting solution for the risks posed by a computer in a suspended state; luks-suspend scripts. <sup class="reference" id="cite_ref-7"><a href="#cite_note-7">[7]</a></sup> This approach has some limitations because it is not yet packaged for Debian, and it has only been tested in the Ubuntu and Arch distributions. As of 2018, luks-suspend and keyslot nuking (mentioned below) is being merged upstream. <sup class="reference" id="cite_ref-8"><a href="#cite_note-8">[8]</a></sup>
</p>
<h4><span class="mw-headline" id="Magic_Key_Feature">Magic Key Feature</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Full_Disk_Encryption_and_Encrypted_Images&amp;action=edit&amp;section=9" href="https://www.whonix.org/w/index.php?title=Full_Disk_Encryption_and_Encrypted_Images&amp;action=edit&amp;section=9.html" title="Edit section: Magic Key Feature">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>In an emergency, <a data-href="/wiki/Non-Qubes-Whonix" href="./Non-Qubes-Whonix.html" title="Non-Qubes-Whonix">Non-Qubes-Whonix</a> users can power-off the computer immediately with the Magic SysRq key feature. This is invoked by pressing the key combination: <code>Alt</code> + <code>PrintScreen</code> + <code>o</code> (lower-case letter). On bare-metal linux systems, the FDE passphrase is prompted after rebooting.<sup class="reference" id="cite_ref-9"><a href="#cite_note-9">[9]</a></sup> <sup class="reference" id="cite_ref-10"><a href="#cite_note-10">[10]</a></sup> <sup class="reference" id="cite_ref-11"><a href="#cite_note-11">[11]</a></sup>  The magic key feature does not work on Qubes hosts because the Xen hypervisor does not recognize these commands. <sup class="reference" id="cite_ref-12"><a href="#cite_note-12">[12]</a></sup>
</p>
<h4><span class="mw-headline" id="USBKill">USBKill</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Full_Disk_Encryption_and_Encrypted_Images&amp;action=edit&amp;section=10" href="https://www.whonix.org/w/index.php?title=Full_Disk_Encryption_and_Encrypted_Images&amp;action=edit&amp;section=10.html" title="Edit section: USBKill">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p><a class="external text" data-href="https://en.wikipedia.org/wiki/USBKill" href="https://en.wikipedia.org/wiki/USBKill" rel="noreferrer noopener" target="_blank">USBKill</a> is an anti-forensics script written in the aftermath of the SilkRoad trial. Its purpose is to trigger protection events that prevent adversaries from siphoning files, installing malware, or running a mouse jiggler. The script creates a white-list of allowable USB devices. If anything else is plugged into the machine, the RAM is erased and the computer is immediately shutdown. 
</p><p>USBKill can also be configured to exclude all devices from being attached. In another high-security configuration, a white-listed flash drive serves as a key, and must be in the USB port at all times. If the flash drive is forcibly removed, the program will initiate the desired routines. <sup class="reference" id="cite_ref-13"><a href="#cite_note-13">[13]</a></sup> <sup class="reference" id="cite_ref-14"><a href="#cite_note-14">[14]</a></sup>
</p>
<h2><span class="mw-headline" id="Protection_Against_Lesser_Adversaries">Protection Against Lesser Adversaries</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Full_Disk_Encryption_and_Encrypted_Images&amp;action=edit&amp;section=11" href="https://www.whonix.org/w/index.php?title=Full_Disk_Encryption_and_Encrypted_Images&amp;action=edit&amp;section=11.html" title="Edit section: Protection Against Lesser Adversaries">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>The reader is reminded that advanced attackers have virtually limitless possibilities to infect a computer under their physical control, such as flashing low-level firmware or adding physical implants.
</p><p>It may be possible to get plausible deniability on Linux hosts using methods other than thosed listed below, but the topic is a rabbit hole (see footnotes in this section). <sup class="reference" id="cite_ref-15"><a href="#cite_note-15">[15]</a></sup> Plausible deniability and FDE are also useless if the user is subject to physical abuse by a captor.
</p>
<h3><span class="mw-headline" id="Advice_for_Solid-state_Drives_and_USB_Storage">Advice for Solid-state Drives and USB Storage</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Full_Disk_Encryption_and_Encrypted_Images&amp;action=edit&amp;section=12" href="https://www.whonix.org/w/index.php?title=Full_Disk_Encryption_and_Encrypted_Images&amp;action=edit&amp;section=12.html" title="Edit section: Advice for Solid-state Drives and USB Storage">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<table class="plainlinks metadata ambox ambox-notice" role="presentation"><tbody><tr><td class="mbox-image"><div style="width:52px"><a class="image" data-href="/w/index.php?title=File:Ambox_warning_pn.svg.png&amp;filetimestamp=20130717200816&amp;" href="https://www.whonix.org/w/index.php?title=File:Ambox_warning_pn.svg.png&amp;filetimestamp=20130717200816&amp;"><img alt="Ambox warning pn.svg.png" data-src="/w/images/thumb/f/f7/Ambox_warning_pn.svg.png/40px-Ambox_warning_pn.svg.png" data-srcset="/w/images/thumb/f/f7/Ambox_warning_pn.svg.png/60px-Ambox_warning_pn.svg.png 1.5x, /w/images/thumb/f/f7/Ambox_warning_pn.svg.png/80px-Ambox_warning_pn.svg.png 2x" height="35" src="data:image/png;base64,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" width="40"/></a></div></td><td class="mbox-text"><div class="mbox-text-span">In the case of flash-based storage like solid-state drives (SSDs) and USBs, the only way to protect data is to never store it unencrypted in the first place!</div></td></tr></tbody></table>
<p><br/>
Unlike hard-disk drives (HDDs), overwriting data on SSDs is no longer effective in wiping the disk. <sup class="reference" id="cite_ref-16"><a href="#cite_note-16">[16]</a></sup> <sup class="reference" id="cite_ref-17"><a href="#cite_note-17">[17]</a></sup> For instance, it is insecure to rely upon a fast erase mechanism by overwriting the header and key-slot area. <sup class="reference" id="cite_ref-18"><a href="#cite_note-18">[18]</a></sup>
</p><p>The most dire potential consequence is that old passwords are not erased, and for a significant period. Consider the following concrete example: a user changes their computer password because they noticed it was exposed to shoulder-surfing or CCTV. On a SSD, the old password is still retrievable and can be used to decrypt the master key and all data. The reason is that secure overwriting is only guaranteed with magnetic disks.
</p><p>Wear-leveling mechanisms like TRIM also leak information about the filesystem that can aid forensics. <sup class="reference" id="cite_ref-19"><a href="#cite_note-19">[19]</a></sup> <sup class="reference" id="cite_ref-20"><a href="#cite_note-20">[20]</a></sup> <sup class="reference" id="cite_ref-21"><a href="#cite_note-21">[21]</a></sup> <sup class="reference" id="cite_ref-22"><a href="#cite_note-22">[22]</a></sup> <sup class="reference" id="cite_ref-23"><a href="#cite_note-23">[23]</a></sup> It is strongly recommended to keep TRIM <i>disabled</i> (the default) during Linux LUKS-encrypted installations.
</p>
<h3><span class="mw-headline" id="Gnome_Disks_Utility">Gnome Disks Utility</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Full_Disk_Encryption_and_Encrypted_Images&amp;action=edit&amp;section=13" href="https://www.whonix.org/w/index.php?title=Full_Disk_Encryption_and_Encrypted_Images&amp;action=edit&amp;section=13.html" title="Edit section: Gnome Disks Utility">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Gnome Disks utility provides a convenient way to manipulate LUKS container passphrases (including the host's) and the overlying filesystems. However, it should not be relied upon for encryption because it uses AES-128 as a hardcoded default <sup class="reference" id="cite_ref-24"><a href="#cite_note-24">[24]</a></sup> <sup class="reference" id="cite_ref-25"><a href="#cite_note-25">[25]</a></sup> (as of Debian Stretch), which does not provide adequate <a data-href="/wiki/PQCrypto" href="./PQCrypto.html" title="PQCrypto">post-quantum security</a>. For encrypting removable media refer to this <a href="#Protection_Against_Powerful_Adversaries">guide</a>.
</p><p>To install it, run:
</p><p></p><div class="codeContainerNew">
<div class="preDiv">
<pre>sudo apt-get install gnome-disk-utility</pre>
</div>
<div class="textareaDiv">
<textarea class="codeBoxAreaNew" onfocus="this.select()" readonly="readonly" rows="1">sudo apt-get install gnome-disk-utility</textarea>
</div>
</div>
<h3><span class="mw-headline" id="Nuke_Patch_for_cryptsetup">Nuke Patch for cryptsetup</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Full_Disk_Encryption_and_Encrypted_Images&amp;action=edit&amp;section=14" href="https://www.whonix.org/w/index.php?title=Full_Disk_Encryption_and_Encrypted_Images&amp;action=edit&amp;section=14.html" title="Edit section: Nuke Patch for cryptsetup">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>The Kali penetration testing distro team has written a <a class="external text" data-href="https://www.kali.org/tutorials/emergency-self-destruction-luks-kali/" href="https://www.kali.org/tutorials/emergency-self-destruction-luks-kali/" rel="noreferrer noopener" target="_blank">nuke patch for cryptsetup</a>, which adds the option to nuke all keyslots after a certain passphrase is entered.  <sup class="reference" id="cite_ref-26"><a href="#cite_note-26">[26]</a></sup>
</p>
<table class="plainlinks metadata ambox ambox-notice" role="presentation"><tbody><tr><td class="mbox-image"><div style="width:52px"><a class="image" data-href="/w/index.php?title=File:Ambox_warning_pn.svg.png&amp;filetimestamp=20130717200816&amp;" href="https://www.whonix.org/w/index.php?title=File:Ambox_warning_pn.svg.png&amp;filetimestamp=20130717200816&amp;"><img alt="Ambox warning pn.svg.png" data-src="/w/images/thumb/f/f7/Ambox_warning_pn.svg.png/40px-Ambox_warning_pn.svg.png" data-srcset="/w/images/thumb/f/f7/Ambox_warning_pn.svg.png/60px-Ambox_warning_pn.svg.png 1.5x, /w/images/thumb/f/f7/Ambox_warning_pn.svg.png/80px-Ambox_warning_pn.svg.png 2x" height="35" src="data:image/png;base64,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" width="40"/></a></div></td><td class="mbox-text"><div class="mbox-text-span">Under most emergency conditions, the user will not have enough time to reboot the computer and enter the dead-man switch passphrase.</div></td></tr></tbody></table>
<p><br/>
Supplying the dead-man switch as the "real passphrase" to the interceptors of the machine is unlikely to be an effective strategy. It is standard forensics procedure to create multiple images of the drive beforehand.
</p>
<h3><span id="Separate_/boot_Partition"></span><span class="mw-headline" id="Separate_.2Fboot_Partition">Separate /boot Partition</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Full_Disk_Encryption_and_Encrypted_Images&amp;action=edit&amp;section=15" href="https://www.whonix.org/w/index.php?title=Full_Disk_Encryption_and_Encrypted_Images&amp;action=edit&amp;section=15.html" title="Edit section: Separate /boot Partition">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>When FDE is used on the host, it is inadvisable to keep any unencrypted files on that same physical media. High-risk users are recommended to move the /boot partition to a separate USB media. The bootloader (Grub) should then also be installed on the separate USB. To read more on this subject, see <a class="external text" data-href="https://twopointfouristan.wordpress.com/2011/04/17/pwning-past-whole-disk-encryption/" href="https://twopointfouristan.wordpress.com/2011/04/17/pwning-past-whole-disk-encryption/" rel="noreferrer noopener" target="_blank">Pwning Past Whole Disk Encryption</a>.
</p>
<h3><span class="mw-headline" id="TRESOR_Kernel_Patch">TRESOR Kernel Patch</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Full_Disk_Encryption_and_Encrypted_Images&amp;action=edit&amp;section=16" href="https://www.whonix.org/w/index.php?title=Full_Disk_Encryption_and_Encrypted_Images&amp;action=edit&amp;section=16.html" title="Edit section: TRESOR Kernel Patch">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Another useful protection is the <a class="external text" data-href="https://en.wikipedia.org/wiki/TRESOR" href="https://en.wikipedia.org/wiki/TRESOR" rel="noreferrer noopener" target="_blank">TRESOR</a> <a class="external text" data-href="https://www1.cs.fau.de/tresor" href="https://www1.cs.fau.de/tresor" rel="noreferrer noopener" target="_blank">kernel patch</a>, which keeps the disk encryption key outside of RAM by storing it inside the CPU. TRESOR does have several limitations. It is only available for the x86 architecture, and it complicates software debugging by disabling DR registers for security reasons. <sup class="reference" id="cite_ref-27"><a href="#cite_note-27">[27]</a></sup> Moreover, a specialized attacker who can reverse engineer hardware designs is also capable of extracting secrets held in processor caches or specialized chips like TPMs.
</p>
<h1><span class="mw-headline" id="Encrypted_Guest_Images">Encrypted Guest Images</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Full_Disk_Encryption_and_Encrypted_Images&amp;action=edit&amp;section=17" href="https://www.whonix.org/w/index.php?title=Full_Disk_Encryption_and_Encrypted_Images&amp;action=edit&amp;section=17.html" title="Edit section: Encrypted Guest Images">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<table class="plainlinks metadata ambox ambox-notice" role="presentation"><tbody><tr><td class="mbox-image"><div style="width:52px"><a class="image" data-href="/w/index.php?title=File:Ambox_notice.png&amp;filetimestamp=20130717195411&amp;" href="https://www.whonix.org/w/index.php?title=File:Ambox_notice.png&amp;filetimestamp=20130717195411&amp;"><img alt="Info" data-src="/w/images/c/c8/Ambox_notice.png" height="40" src="data:image/png;base64,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" width="40"/></a></div></td><td class="mbox-text"><div class="mbox-text-span">This encrypted images chapter is mostly theoretical at this point, because it contains numerous open research questions and is currently <a data-href="/wiki/FAQ#What_does_Unsupported_Mean.3F" href="./FAQ.html" title="FAQ">unsupported</a>.</div></td></tr></tbody></table>
<p><br/>
The greatest security benefit comes from applying full disk encryption <a href="#Full_Disk_Encryption_on_the_Host">on the host</a> because that is the only place where it is most effective. Nevertheless, for the interested reader this section makes recommendations to deal with the following threat model:
</p>
<ul><li>The host is running when an adversary gets access to it, or the host is unencrypted.</li>
<li>The VM is powered down (otherwise the adversary would already have access to it).</li></ul>
<p><i><span style="background-color:#FBFBFB">The following security considerations are based on modified quotes by <a class="external text" data-href="http://security.stackexchange.com/users/953/iszi" href="http://security.stackexchange.com/users/953/iszi" rel="noreferrer noopener" target="_blank">Iszi</a> from the answer posted on <a class="external text" data-href="http://security.stackexchange.com/a/29538" href="http://security.stackexchange.com/a/29538" rel="noreferrer noopener" target="_blank">security.stackexchange.com</a>, which was a user contribution to stackexchange, licensed under <a class="external text" data-href="http://creativecommons.org/licenses/by-sa/3.0/" href="http://creativecommons.org/licenses/by-sa/3.0/" rel="noreferrer noopener" target="_blank">cc by-sa 3.0</a> with <a class="external text" data-href="https://blog.stackexchange.com/2009/06/attribution-required/" href="https://blog.stackexchange.com/2009/06/attribution-required/" rel="noreferrer noopener" target="_blank">attribution required</a>.</span></i>
</p>
<h2><span class="mw-headline" id="Full_Disk_Encryption_within_the_Virtual_Machine">Full Disk Encryption within the Virtual Machine</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Full_Disk_Encryption_and_Encrypted_Images&amp;action=edit&amp;section=18" href="https://www.whonix.org/w/index.php?title=Full_Disk_Encryption_and_Encrypted_Images&amp;action=edit&amp;section=18.html" title="Edit section: Full Disk Encryption within the Virtual Machine">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>When using FDE within the VM, never save (suspend/pause) the VM machine state, but instead shut it down completely. If this advice is ignored, the saved machine state could be stored outside of the encrypted image. This includes a RAM dump, which contains the encryption key required to decrypt the image. Upon resuming the VM, that stored file is not necessarily securely deleted, since it is virtualizer-specific. <sup class="reference" id="cite_ref-28"><a href="#cite_note-28">[28]</a></sup>
</p><p>While the VM is running, users should not use the host system's sleep, suspend, or hibernate functions. Similar to the first scenario, these actions leave a RAM dump on disk, but this time it belongs to the host. This also contains sensitive data, such as encryption keys.
</p>
<h2><span class="mw-headline" id="Virtual_Machine_Files_in_an_Encrypted_Container">Virtual Machine Files in an Encrypted Container</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Full_Disk_Encryption_and_Encrypted_Images&amp;action=edit&amp;section=19" href="https://www.whonix.org/w/index.php?title=Full_Disk_Encryption_and_Encrypted_Images&amp;action=edit&amp;section=19.html" title="Edit section: Virtual Machine Files in an Encrypted Container">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>VM files can also be stored in an encrypted container, such as a LUKS container. Newer and native support for LUKS encryption of disk images is available as of libvirt 2.10 <sup class="reference" id="cite_ref-29"><a href="#cite_note-29">[29]</a></sup>
The same precautions should be taken as outlined in the previous section, as the risks equally apply.
</p><p>FDE within the VM, LUKS encrypted containers for VM images, and FDE on the host can all be used independently, or in conjunction. However, increasing the layers of encryption may begin to significantly degrade performance. <i><span style="background-color:#FBFBFB">End modified quote by Iszi.</span></i>
</p>
<h2><span class="mw-headline" id="Other_Security_Considerations">Other Security Considerations</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Full_Disk_Encryption_and_Encrypted_Images&amp;action=edit&amp;section=20" href="https://www.whonix.org/w/index.php?title=Full_Disk_Encryption_and_Encrypted_Images&amp;action=edit&amp;section=20.html" title="Edit section: Other Security Considerations">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Encryption is an area with many pitfalls. The user should also consider the following:
</p>
<ul><li><b>KVM:</b> It is not <i>expected</i> that KVM guests could access data from other process' memory pages via <a class="external text" data-href="https://www.techopedia.com/definition/30466/memory-ballooning" href="https://www.techopedia.com/definition/30466/memory-ballooning" rel="noreferrer noopener" target="_blank">memory ballooning</a>, since KVM guests are Linux processes and subject to Linux memory allocation rules. <sup class="reference" id="cite_ref-30"><a href="#cite_note-30">[30]</a></sup></li>
<li><b>Memory Dumps:</b> These are caused by BSOD or kernel crashes, and can leave unintended traces on the host.</li>
<li><b>Powered-down VMs:</b> After a VM has shutdown, the RAM that previously contained the VM's encryption key might not have been wiped yet. Memory pages belonging to a terminated process do not have their contents wiped (zeroed) until they are about to be used by another process. <sup class="reference" id="cite_ref-31"><a href="#cite_note-31">[31]</a></sup> <sup class="reference" id="cite_ref-32"><a href="#cite_note-32">[32]</a></sup> <sup class="reference" id="cite_ref-33"><a href="#cite_note-33">[33]</a></sup> <sup class="reference" id="cite_ref-34"><a href="#cite_note-34">[34]</a></sup></li>
<li><b>Swap:</b> An encrypted swap provides no protection so  long as the host is powered up, because the key is still in RAM.
<ul><li><u>Disabling Swap:</u> This action requires a special, secure wiping of the existing swap. It is safer to have never used swap before.</li></ul></li>
<li><b>Xen:</b> Memory ballooning in Xen creates privacy concerns because when it is enabled the memory contents of other VMs are exposed. <sup class="reference" id="cite_ref-35"><a href="#cite_note-35">[35]</a></sup></li></ul>
<p>The host of security considerations suggest that an unrealistic set of operational rules are required to defend the integrity of a purely encrypted guest image, without host FDE.
</p>
<h2><span class="mw-headline" id="Open_Security_Research_Questions">Open Security Research Questions</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Full_Disk_Encryption_and_Encrypted_Images&amp;action=edit&amp;section=21" href="https://www.whonix.org/w/index.php?title=Full_Disk_Encryption_and_Encrypted_Images&amp;action=edit&amp;section=21.html" title="Edit section: Open Security Research Questions">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>The following questions and configurations require further research:
</p>
<ul><li>With swap and crash dumps disabled, it is unknown whether the virtualizer writes parts of the VM's RAM contents to the disk. TODO: Specifically ask virtualizer vendors about this possibility.</li>
<li>Potential setup configurations:
<ul><li>Theoretically, a fullly encrypted operating system (currently: Debian) could be installed inside a VM and Whonix could be built using <code>--target root</code> inside another VM. This is analogous to the <a data-href="/wiki/Dev/Build_Documentation/Physical_Isolation" href="./Dev/Build_Documentation/Physical_Isolation.html" title="Dev/Build Documentation/Physical Isolation">physical isolation</a> model, but secure VM settings would be missing (similar to <a data-href="/wiki/Manually_Create_Whonix_VM_Settings" href="./Manually_Create_Whonix_VM_Settings.html" title="Manually Create Whonix VM Settings">Manually Create Whonix VM Settings</a>).</li>
<li>An encryption feature could be added to grml-debootstrap and/or the Whonix build script. There was an  <a class="external text" data-href="https://forums.whonix.org/t/whonix-container-encryption-options/193" href="https://forums.whonix.org/t/whonix-container-encryption-options/193" rel="noreferrer noopener" target="_blank">attempt</a> to do that, but this effort has stalled.</li>
<li>cryptsetup-reencrypt could be used, allowing for the shipping of encrypted Whonix images. The master key and the password (potentially blank) would be known to the public at first. Later, users would use cryptsetup-reencrypt to fix the master key and password, that is, to make the encryption effective.</li></ul></li></ul>
<p>For further information about encrypted images, see <a class="external text" data-href="https://forums.whonix.org/t/how-useful-is-in-guest-encryption/1253" href="https://forums.whonix.org/t/how-useful-is-in-guest-encryption/1253" rel="noreferrer noopener" target="_blank">How Useful is In-Guest Encryption?</a> Users interested in running Whonix as a live OS, should read <a class="external text" data-href="https://forums.whonix.org/t/whonix-live-mode/3894/9" href="https://forums.whonix.org/t/whonix-live-mode/3894/9" rel="noreferrer noopener" target="_blank">this entry</a>. <sup class="reference" id="cite_ref-36"><a href="#cite_note-36">[36]</a></sup>
</p>
<h1><span class="mw-headline" id="Footnotes">Footnotes</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Full_Disk_Encryption_and_Encrypted_Images&amp;action=edit&amp;section=22" href="https://www.whonix.org/w/index.php?title=Full_Disk_Encryption_and_Encrypted_Images&amp;action=edit&amp;section=22.html" title="Edit section: Footnotes">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<div class="reflist" style="list-style-type: decimal;">
<div class="mw-references-wrap mw-references-columns"><ol class="references">
<li id="cite_note-1"><span class="mw-cite-backlink"><a href="#cite_ref-1">↑</a></span> <span class="reference-text">Until <a class="external text" data-href="https://github.com/QubesOS/qubes-issues/issues/904" href="https://github.com/QubesOS/qubes-issues/issues/904" rel="noreferrer noopener" target="_blank">in-RAM execution of disposableVMs</a> is implemented in Qubes-Whonix, this threat is not easily mitigated.</span>
</li>
<li id="cite_note-2"><span class="mw-cite-backlink"><a href="#cite_ref-2">↑</a></span> <span class="reference-text"><a class="external free" data-href="https://security.stackexchange.com/questions/109981/how-can-i-extract-the-encrypted-master-key-from-luks-header" href="https://security.stackexchange.com/questions/109981/how-can-i-extract-the-encrypted-master-key-from-luks-header" rel="noreferrer noopener" target="_blank">https://security.stackexchange.com/questions/109981/how-can-i-extract-the-encrypted-master-key-from-luks-header</a></span>
</li>
<li id="cite_note-3"><span class="mw-cite-backlink"><a href="#cite_ref-3">↑</a></span> <span class="reference-text"><a class="external free" data-href="https://unix.stackexchange.com/questions/254017/how-to-interpret-cryptsetup-benchmark-results" href="https://unix.stackexchange.com/questions/254017/how-to-interpret-cryptsetup-benchmark-results" rel="noreferrer noopener" target="_blank">https://unix.stackexchange.com/questions/254017/how-to-interpret-cryptsetup-benchmark-results</a></span>
</li>
<li id="cite_note-4"><span class="mw-cite-backlink"><a href="#cite_ref-4">↑</a></span> <span class="reference-text"><a class="external free" data-href="https://wiki.archlinux.org/index.php/dm-crypt/Device_encryption#Re-encrypting_an_existing_LUKS_partition" href="https://wiki.archlinux.org/index.php/dm-crypt/Device_encryption" rel="noreferrer noopener" target="_blank">https://wiki.archlinux.org/index.php/dm-crypt/Device_encryption#Re-encrypting_an_existing_LUKS_partition</a></span>
</li>
<li id="cite_note-5"><span class="mw-cite-backlink"><a href="#cite_ref-5">↑</a></span> <span class="reference-text"><a class="external free" data-href="https://jlk.fjfi.cvut.cz/arch/manpages/man/cryptsetup-reencrypt.8" href="https://jlk.fjfi.cvut.cz/arch/manpages/man/cryptsetup-reencrypt.8" rel="noreferrer noopener" target="_blank">https://jlk.fjfi.cvut.cz/arch/manpages/man/cryptsetup-reencrypt.8</a></span>
</li>
<li id="cite_note-6"><span class="mw-cite-backlink"><a href="#cite_ref-6">↑</a></span> <span class="reference-text"><a class="external free" data-href="https://asalor.blogspot.com/2012/08/re-encryption-of-luks-device-cryptsetup.html" href="https://asalor.blogspot.com/2012/08/re-encryption-of-luks-device-cryptsetup.html" rel="noreferrer noopener" target="_blank">https://asalor.blogspot.com/2012/08/re-encryption-of-luks-device-cryptsetup.html</a></span>
</li>
<li id="cite_note-7"><span class="mw-cite-backlink"><a href="#cite_ref-7">↑</a></span> <span class="reference-text"><a class="external free" data-href="https://github.com/vianney/arch-luks-suspend/issues/7" href="https://github.com/vianney/arch-luks-suspend/issues/7" rel="noreferrer noopener" target="_blank">https://github.com/vianney/arch-luks-suspend/issues/7</a></span>
</li>
<li id="cite_note-8"><span class="mw-cite-backlink"><a href="#cite_ref-8">↑</a></span> <span class="reference-text"><a class="external free" data-href="https://blog.freesources.org/posts/2018/06/debian_cryptsetup_sprint_report/" href="https://blog.freesources.org/posts/2018/06/debian_cryptsetup_sprint_report/" rel="noreferrer noopener" target="_blank">https://blog.freesources.org/posts/2018/06/debian_cryptsetup_sprint_report/</a></span>
</li>
<li id="cite_note-9"><span class="mw-cite-backlink"><a href="#cite_ref-9">↑</a></span> <span class="reference-text"><a class="external free" data-href="https://en.wikipedia.org/wiki/Magic_SysRq_key" href="https://en.wikipedia.org/wiki/Magic_SysRq_key" rel="noreferrer noopener" target="_blank">https://en.wikipedia.org/wiki/Magic_SysRq_key</a></span>
</li>
<li id="cite_note-10"><span class="mw-cite-backlink"><a href="#cite_ref-10">↑</a></span> <span class="reference-text"><a class="external free" data-href="http://www.thegeekstuff.com/2008/12/safe-reboot-of-linux-using-magic-sysrq-key/" href="http://www.thegeekstuff.com/2008/12/safe-reboot-of-linux-using-magic-sysrq-key/" rel="noreferrer noopener" target="_blank">http://www.thegeekstuff.com/2008/12/safe-reboot-of-linux-using-magic-sysrq-key/</a></span>
</li>
<li id="cite_note-11"><span class="mw-cite-backlink"><a href="#cite_ref-11">↑</a></span> <span class="reference-text"><a class="external free" data-href="https://phabricator.whonix.org/T553" href="https://phabricator.whonix.org/T553" rel="noreferrer noopener" target="_blank">https://phabricator.whonix.org/T553</a></span>
</li>
<li id="cite_note-12"><span class="mw-cite-backlink"><a href="#cite_ref-12">↑</a></span> <span class="reference-text"><a class="external free" data-href="https://forums.whonix.org/t/fde-emergency-feature-testing-requested" href="https://forums.whonix.org/t/fde-emergency-feature-testing-requested" rel="noreferrer noopener" target="_blank">https://forums.whonix.org/t/fde-emergency-feature-testing-requested</a></span>
</li>
<li id="cite_note-13"><span class="mw-cite-backlink"><a href="#cite_ref-13">↑</a></span> <span class="reference-text">For example, this can be done quickly if the flash drive is attached to the user's wrist via a lanyard.</span>
</li>
<li id="cite_note-14"><span class="mw-cite-backlink"><a href="#cite_ref-14">↑</a></span> <span class="reference-text">
<ul><li><a class="external free" data-href="https://github.com/hephaest0s/usbkill" href="https://github.com/hephaest0s/usbkill" rel="noreferrer noopener" target="_blank">https://github.com/hephaest0s/usbkill</a></li>
<li><a class="external free" data-href="https://en.wikipedia.org/wiki/USBKill" href="https://en.wikipedia.org/wiki/USBKill" rel="noreferrer noopener" target="_blank">https://en.wikipedia.org/wiki/USBKill</a></li>
<li><a class="external free" data-href="https://7io.net/2015/07/02/python-usbkill-anti-forensic-usb-killswitch/#more-201" href="https://7io.net/2015/07/02/python-usbkill-anti-forensic-usb-killswitch/" rel="noreferrer noopener" target="_blank">https://7io.net/2015/07/02/python-usbkill-anti-forensic-usb-killswitch/#more-201</a></li>
<li><a class="external free" data-href="https://phabricator.whonix.org/T552" href="https://phabricator.whonix.org/T552" rel="noreferrer noopener" target="_blank">https://phabricator.whonix.org/T552</a></li></ul>
</span></li>
<li id="cite_note-15"><span class="mw-cite-backlink"><a href="#cite_ref-15">↑</a></span> <span class="reference-text"><a class="external free" data-href="https://evilzone.org/operating-system/plausible-deniability-in-qubes-os/msg86174" href="https://evilzone.org/operating-system/plausible-deniability-in-qubes-os/msg86174" rel="noreferrer noopener" target="_blank">https://evilzone.org/operating-system/plausible-deniability-in-qubes-os/msg86174</a></span>
</li>
<li id="cite_note-16"><span class="mw-cite-backlink"><a href="#cite_ref-16">↑</a></span> <span class="reference-text"><a class="external free" data-href="http://www.infosecisland.com/blogview/12153-Data-Remains-on-USB-and-SSDs-After-Secure-Erase.html" href="http://www.infosecisland.com/blogview/12153-Data-Remains-on-USB-and-SSDs-After-Secure-Erase.html" rel="noreferrer noopener" target="_blank">http://www.infosecisland.com/blogview/12153-Data-Remains-on-USB-and-SSDs-After-Secure-Erase.html</a></span>
</li>
<li id="cite_note-17"><span class="mw-cite-backlink"><a href="#cite_ref-17">↑</a></span> <span class="reference-text"><a class="external free" data-href="http://www.theregister.co.uk/2011/02/21/flash_drive_erasing_peril/" href="http://www.theregister.co.uk/2011/02/21/flash_drive_erasing_peril/" rel="noreferrer noopener" target="_blank">http://www.theregister.co.uk/2011/02/21/flash_drive_erasing_peril/</a></span>
</li>
<li id="cite_note-18"><span class="mw-cite-backlink"><a href="#cite_ref-18">↑</a></span> <span class="reference-text"><a class="external text" data-href="https://gitlab.com/cryptsetup/cryptsetup/wikis/FrequentlyAskedQuestions" href="https://gitlab.com/cryptsetup/cryptsetup/wikis/FrequentlyAskedQuestions" rel="noreferrer noopener" target="_blank">cryptsetup FAQ - Section: 5.19 What about SSDs, Flash and Hybrid Drives?</a></span>
</li>
<li id="cite_note-19"><span class="mw-cite-backlink"><a href="#cite_ref-19">↑</a></span> <span class="reference-text"><a class="external free" data-href="http://asalor.blogspot.com/2011/08/trim-dm-crypt-problems.html" href="http://asalor.blogspot.com/2011/08/trim-dm-crypt-problems.html" rel="noreferrer noopener" target="_blank">http://asalor.blogspot.com/2011/08/trim-dm-crypt-problems.html</a></span>
</li>
<li id="cite_note-20"><span class="mw-cite-backlink"><a href="#cite_ref-20">↑</a></span> <span class="reference-text"><a class="external free" data-href="https://wiki.archlinux.org/index.php/Dm-crypt/Specialties#Discard.2FTRIM_support_for_solid_state_drives_.28SSD.29" href="https://wiki.archlinux.org/index.php/Dm-crypt/Specialties" rel="noreferrer noopener" target="_blank">https://wiki.archlinux.org/index.php/Dm-crypt/Specialties#Discard.2FTRIM_support_for_solid_state_drives_.28SSD.29</a></span>
</li>
<li id="cite_note-21"><span class="mw-cite-backlink"><a href="#cite_ref-21">↑</a></span> <span class="reference-text"><a class="external free" data-href="https://wiki.archlinux.org/index.php/Solid_State_Drives#dm-crypt" href="https://wiki.archlinux.org/index.php/Solid_State_Drives" rel="noreferrer noopener" target="_blank">https://wiki.archlinux.org/index.php/Solid_State_Drives#dm-crypt</a></span>
</li>
<li id="cite_note-22"><span class="mw-cite-backlink"><a href="#cite_ref-22">↑</a></span> <span class="reference-text"><a class="external free" data-href="http://www.saout.de/pipermail/dm-crypt/2011-September/002019.html" href="http://www.saout.de/pipermail/dm-crypt/2011-September/002019.html" rel="noreferrer noopener" target="_blank">http://www.saout.de/pipermail/dm-crypt/2011-September/002019.html</a></span>
</li>
<li id="cite_note-23"><span class="mw-cite-backlink"><a href="#cite_ref-23">↑</a></span> <span class="reference-text"><a class="external free" data-href="http://www.saout.de/pipermail/dm-crypt/2012-April/002420.html" href="http://www.saout.de/pipermail/dm-crypt/2012-April/002420.html" rel="noreferrer noopener" target="_blank">http://www.saout.de/pipermail/dm-crypt/2012-April/002420.html</a></span>
</li>
<li id="cite_note-24"><span class="mw-cite-backlink"><a href="#cite_ref-24">↑</a></span> <span class="reference-text">As tested by Whonix developer HulaHoop.</span>
</li>
<li id="cite_note-25"><span class="mw-cite-backlink"><a href="#cite_ref-25">↑</a></span> <span class="reference-text">
<ul><li>Debian bug report: <a class="external text" data-href="https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=910249" href="https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=910249" rel="noreferrer noopener" target="_blank">Bumping up encryption to AES-256 by default</a></li>
<li>Gnome disks utility upstream bug report: <a class="external text" data-href="https://gitlab.gnome.org/GNOME/gnome-disk-utility/issues/103" href="https://gitlab.gnome.org/GNOME/gnome-disk-utility/issues/103" rel="noreferrer noopener" target="_blank">Bumping up encryption to AES-256 by default</a></li></ul>
</span></li>
<li id="cite_note-26"><span class="mw-cite-backlink"><a href="#cite_ref-26">↑</a></span> <span class="reference-text"><a class="external free" data-href="https://github.com/offensive-security/cryptsetup-nuke-keys" href="https://github.com/offensive-security/cryptsetup-nuke-keys" rel="noreferrer noopener" target="_blank">https://github.com/offensive-security/cryptsetup-nuke-keys</a></span>
</li>
<li id="cite_note-27"><span class="mw-cite-backlink"><a href="#cite_ref-27">↑</a></span> <span class="reference-text"><a class="external free" data-href="https://security.stackexchange.com/a/119835" href="https://security.stackexchange.com/a/119835" rel="noreferrer noopener" target="_blank">https://security.stackexchange.com/a/119835</a></span>
</li>
<li id="cite_note-28"><span class="mw-cite-backlink"><a href="#cite_ref-28">↑</a></span> <span class="reference-text">In the case of <a data-href="/wiki/VirtualBox" href="./VirtualBox.html" title="VirtualBox">VirtualBox</a>, the file could end up in the folder <i><span style="background-color:#FBFBFB">~/.virtualbox</span></i>. A definitive answer requires further research.</span>
</li>
<li id="cite_note-29"><span class="mw-cite-backlink"><a href="#cite_ref-29">↑</a></span> <span class="reference-text"><a class="external free" data-href="https://libvirt.org/formatstorageencryption.html#StorageEncryptionLuks" href="https://libvirt.org/formatstorageencryption.html" rel="noreferrer noopener" target="_blank">https://libvirt.org/formatstorageencryption.html#StorageEncryptionLuks</a></span>
</li>
<li id="cite_note-30"><span class="mw-cite-backlink"><a href="#cite_ref-30">↑</a></span> <span class="reference-text"><a class="external free" data-href="https://www.techopedia.com/definition/30466/memory-ballooning" href="https://www.techopedia.com/definition/30466/memory-ballooning" rel="noreferrer noopener" target="_blank">https://www.techopedia.com/definition/30466/memory-ballooning</a> : "Memory ballooning is a memory management feature used in most virtualization platforms which allows a host system to artificially enlarge its pool of memory by taking advantage or reclaiming unused memory previously allocated to various virtual machines."</span>
</li>
<li id="cite_note-31"><span class="mw-cite-backlink"><a href="#cite_ref-31">↑</a></span> <span class="reference-text">
<a class="external free" data-href="https://security.stackexchange.com/a/42186" href="https://security.stackexchange.com/a/42186" rel="noreferrer noopener" target="_blank">https://security.stackexchange.com/a/42186</a> : "Linux zeroes out (i.e. fills with zeros) all pages of memory not when they are released, but when they are given to another process. Thus, no process may obtain data excerpts from another process. However, the pages will retain their old contents until they are reused."</span>
</li>
<li id="cite_note-32"><span class="mw-cite-backlink"><a href="#cite_ref-32">↑</a></span> <span class="reference-text"><a class="external free" data-href="https://superuser.com/a/894936" href="https://superuser.com/a/894936" rel="noreferrer noopener" target="_blank">https://superuser.com/a/894936</a></span>
</li>
<li id="cite_note-33"><span class="mw-cite-backlink"><a href="#cite_ref-33">↑</a></span> <span class="reference-text"><a class="external free" data-href="https://askubuntu.com/a/721207" href="https://askubuntu.com/a/721207" rel="noreferrer noopener" target="_blank">https://askubuntu.com/a/721207</a></span>
</li>
<li id="cite_note-34"><span class="mw-cite-backlink"><a href="#cite_ref-34">↑</a></span> <span class="reference-text">The threat is similar to <a href="#Cold_Boot_Attacks">cold boot attacks</a>, but in this case it might even be a "warm" attack, because under this threat model, the machine and RAM is still powered. <a class="external text" data-href="http://en.wikibooks.org/wiki/Grsecurity/Appendix/Grsecurity_and_PaX_Configuration_Options#Sanitize_all_freed_memory" href="http://en.wikibooks.org/wiki/Grsecurity/Appendix/Grsecurity_and_PaX_Configuration_Options" rel="noreferrer noopener" target="_blank">PAX_MEMORY_SANITIZE</a> and its <a class="external text" data-href="https://github.com/thestinger/linux-hardened/wiki#sanitize-all-freed-memory" href="https://github.com/thestinger/linux-hardened/wiki" rel="noreferrer noopener" target="_blank">KSPP successor</a> may mitigate this, but at the cost of a non-trivial performance hit.</span>
</li>
<li id="cite_note-35"><span class="mw-cite-backlink"><a href="#cite_ref-35">↑</a></span> <span class="reference-text"><a class="external free" data-href="http://docs.openstack.org/security-guide/content/data-privacy-concerns.html" href="http://docs.openstack.org/security-guide/content/data-privacy-concerns.html" rel="noreferrer noopener" target="_blank">http://docs.openstack.org/security-guide/content/data-privacy-concerns.html</a> : Xen explicitly assigns dedicated memory regions to instances and scrubs data upon the destruction of instances (or domains in Xen parlance). KVM depends more greatly on Linux page management; A complex set of rules related to KVM paging is defined in the KVM documentation. It is important to note that use of the Xen memory balloon feature is likely to result in information disclosure. We strongly recommended to avoid use of this feature.</span>
</li>
<li id="cite_note-36"><span class="mw-cite-backlink"><a href="#cite_ref-36">↑</a></span> <span class="reference-text">Live OS systems are designed to not leave traces of user activity on disk.</span>
</li>
</ol></div></div>
<h1><span class="mw-headline" id="License">License</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Full_Disk_Encryption_and_Encrypted_Images&amp;action=edit&amp;section=23" href="https://www.whonix.org/w/index.php?title=Full_Disk_Encryption_and_Encrypted_Images&amp;action=edit&amp;section=23.html" title="Edit section: License">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<blockquote>
<p>Whonix Full Disk Encryption and Encrypted Images wiki page Copyright (C) Amnesia &lt;amnesia at boum dot org&gt;<br/>
Whonix Full Disk Encryption and Encrypted Images wiki page Copyright (C) 2012 - 2018 ENCRYPTED SUPPORT LP &lt;adrelanos@riseup.net&gt;<br/>
<br/>
This program comes with ABSOLUTELY NO WARRANTY; for details see the wiki source code.<br/>
This is free software, and you are welcome to redistribute it under certain conditions; see the wiki source code for details.
</p>
</blockquote>
<hr/>
<div style="padding-bottom:1px; padding-top:6px; border:thin solid black; background:#EEEEEE; text-align:center;"><u>Random News:</u>
<p>Don't mind having your name connected to Whonix? Follow us on <a class="external text" data-href="https://twitter.com/Whonix" href="https://twitter.com/Whonix" rel="noreferrer noopener" target="_blank">Twitter</a> / <a class="external text" data-href="https://www.facebook.com/Whonix" href="https://www.facebook.com/Whonix" rel="noreferrer noopener" target="_blank">Facebook</a> / <a class="external text" data-href="https://plus.google.com/108150429836421683225" href="https://plus.google.com/108150429836421683225" rel="noreferrer noopener" target="_blank">g+</a>.
</p>
</div>
<hr/><p><font size="-1"><a class="external text" data-href="./Full_Disk_Encryption_and_Encrypted_Images" href="./Full_Disk_Encryption_and_Encrypted_Images" rel="noreferrer noopener" target="_blank">https</a> | (<a data-href="/wiki/Forcing_.onion_on_Whonix.org" href="./Forcing_.onion_on_Whonix.org.html" title="Forcing .onion on Whonix.org">forcing</a>) <a class="external text" data-href="http://dds6qkxpwdeubwucdiaord2xgbbeyds25rbsgr73tbfpqpt4a6vjwsyd.onion/wiki/Full_Disk_Encryption_and_Encrypted_Images" href="http://dds6qkxpwdeubwucdiaord2xgbbeyds25rbsgr73tbfpqpt4a6vjwsyd.onion/wiki/Full_Disk_Encryption_and_Encrypted_Images" rel="noreferrer noopener" target="_blank">onion</a><br/>
</font></p><font size="-1"></font><p><font size="-1">Share: <a data-href="https://twitter.com/intent/tweet?url=./Full_Disk_Encryption_and_Encrypted_Images&amp;text=&amp;via=Whonix" href="https://twitter.com/intent/tweet?url=./Full_Disk_Encryption_and_Encrypted_Images&amp;text=&amp;via=Whonix">Twitter</a>
|
<a data-href="https://facebook.com/sharer.php?u=./Full_Disk_Encryption_and_Encrypted_Images" href="https://facebook.com/sharer.php?u=./Full_Disk_Encryption_and_Encrypted_Images">Facebook</a></font>
</p><p><font size="-1">This is a wiki. Want to improve this page? Help is welcome and volunteer contributions are happily considered! See <a class="external text" data-href="https://github.com/Whonix/Whonix/blob/master/CONTRIBUTING.md" href="https://github.com/Whonix/Whonix/blob/master/CONTRIBUTING.md" rel="noreferrer noopener" target="_blank">Conditions for Contributions to Whonix</a>, then <a data-href="/w/index.php?title=Full_Disk_Encryption_and_Encrypted_Images&amp;action=edit" href="https://www.whonix.org/w/index.php?title=Full_Disk_Encryption_and_Encrypted_Images&amp;action=edit">Edit</a>! IP addresses are scrubbed, but editing over Tor is recommended. Edits are held for moderation.</font>
</p><p><font size="-1">Whonix is a <a class="external text" data-href="http://www.openinventionnetwork.com/licensees.php" href="http://www.openinventionnetwork.com/licensees.php" rel="noreferrer noopener" target="_blank">licensee</a> of the Open Invention Network. Unless otherwise noted, the content of this page is <a data-href="/wiki/Whonix:Copyrights" href="./Whonix:Copyrights.html" title="Whonix:Copyrights">copyrighted</a> and licensed under the same Libre Software <a class="external text" data-href="https://github.com/Whonix/Whonix/blob/master/debian/copyright" href="https://github.com/Whonix/Whonix/blob/master/debian/copyright" rel="noreferrer noopener" target="_blank">license</a> as Whonix itself. (<a data-href="/wiki/Why_Whonix_is_Free_Software" href="./Why_Whonix_is_Free_Software.html" title="Why Whonix is Free Software">Why?</a>)</font>
</p><p><font size="-1">Whonix is provided by ENCRYPTED SUPPORT LP. See <a class="mw-redirect" data-href="/wiki/Impressum" href="./Impressum.html" title="Impressum">Imprint</a>.</font>
</p>
<!-- 
NewPP limit report
Cached time: 20181224135243
Cache expiry: 0
Dynamic content: true
CPU time usage: 0.216 seconds
Real time usage: 0.278 seconds
Preprocessor visited node count: 869/1000000
Preprocessor generated node count: 2449/1000000
Post‐expand include size: 8706/2097152 bytes
Template argument size: 1037/2097152 bytes
Highest expansion depth: 5/40
Expensive parser function count: 0/100
Unstrip recursion depth: 0/20
Unstrip post‐expand size: 18539/5000000 bytes
Lua time usage: 0.040/7.000 seconds
Lua virtual size: 14.93 MB/50 MB
Lua estimated memory usage: 0 bytes
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00%  198.034      1 -total
 41.06%   81.308      5 Template:Mbox
 15.44%   30.575      1 Template:Reflist
 11.58%   22.933      6 Template:CodeSelect
  7.29%   14.435      1 Template:Footer
  3.63%    7.187      1 Template:Header
  2.34%    4.636      1 Template:Edit_it
  2.25%    4.456      1 Template:Share
  2.01%    3.990      1 Template:Maintainer
  1.06%    2.104      1 Template:License_Amnesia
-->
</div></div><div class="printfooter">
Retrieved from "<a data-href="http://dds6qkxpwdeubwucdiaord2xgbbeyds25rbsgr73tbfpqpt4a6vjwsyd.onion/w/index.php?title=Full_Disk_Encryption_and_Encrypted_Images&amp;oldid=40253" dir="ltr" href="http://dds6qkxpwdeubwucdiaord2xgbbeyds25rbsgr73tbfpqpt4a6vjwsyd.onion/w/index.php?title=Full_Disk_Encryption_and_Encrypted_Images&amp;oldid=40253">http://dds6qkxpwdeubwucdiaord2xgbbeyds25rbsgr73tbfpqpt4a6vjwsyd.onion/w/index.php?title=Full_Disk_Encryption_and_Encrypted_Images&amp;oldid=40253</a>"</div>
<div class="clear_both"></div>
</div>
<div class="group"><div class="catlinks" data-mw="interface" id="catlinks"><div class="mw-normal-catlinks" id="mw-normal-catlinks"><a data-href="/wiki/Special:Categories" href="./Special:Categories.html" title="Special:Categories">Category</a>: <ul><li><a data-href="/wiki/Category:Documentation" href="./Category:Documentation.html" title="Category:Documentation">Documentation</a></li></ul></div></div></div>
</div>
</div>
</div>
<footer class="row">
<div id="footer">
<div class="small-12 large-centered columns text-center" id="footer-left">
<ul id="footer-left">
<li id="footer-lastmod"> This page was last edited on 24 December 2018, at 13:11.</li>
<li id="footer-Imprint"><a data-href="/wiki/Imprint" href="./Imprint.html" title="Imprint">Imprint</a></li>
<li id="footer-Privacy_Policy"><a data-href="/wiki/Privacy_Policy" href="./Privacy_Policy.html" title="Privacy Policy">Privacy Policy</a></li>
<li id="footer-Disclaimer"><a class="mw-redirect" data-href="/wiki/Disclaimer" href="./Disclaimer.html" title="Disclaimer">Disclaimer</a></li>
<li id="footer-Terms_of_Service"><a class="mw-redirect" data-href="/wiki/Terms_of_Service" href="./Terms_of_Service.html" title="Terms of Service">Terms of Service</a></li>
<li id="footer-Priority_Support"><a data-href="/wiki/Priority_Support" href="./Priority_Support.html" title="Priority Support">Priority Support</a></li>
<li id="footer-Investors"><a data-href="/wiki/Investors" href="./Investors.html" title="Investors">Investors</a></li>
<li id="footer-Professional_Support"><a data-href="/wiki/Professional_Support" href="./Professional_Support.html" title="Professional Support">Professional Support</a></li>
</ul>
</div>
<div class="large-12 small-12 columns" id="footer-right-icons">
<ul id="poweredby">
</ul>
</div>
</div>
</footer>
</div>

</body>
<!-- Cached/compressed 20181224135243 -->
</html>
