<!DOCTYPE html>
<html class="client-nojs" dir="ltr" lang="en"><!-- 
 single html processed by https://github.com/zTrix/webpage2html
 title: Tunnels/Connecting to Tor before a proxy - Whonix
 url: ../Tunnels/Connecting_to_Tor_before_a_proxy
 date: Wed Sep 12 08:13:26 2018
-->
<head>
<meta charset="utf-8"/>
<title>Tunnels/Connecting to Tor before a proxy - Whonix</title>
<link rel="stylesheet" type="text/css" href="../style.css">




<style>.firstHeading, .subtitle, #siteSub, #contentSub, .pagetitle { display: none; }</style>
<meta content="" name="ResourceLoaderDynamicStyles"/>

<meta content="MediaWiki 1.31.0" name="generator"/>
<meta content="" name="google-site-verification"/>
<meta content="https://www.whonix.org/w/images/f/f3/Balloon-936780640.jpg" name="image"/>
<meta content="https://www.whonix.org/w/images/f/f3/Balloon-936780640.jpg" name="twitter:image:src"/>
<meta content="summary_large_image" name="twitter:card"/>
<meta content="@Whonix" name="twitter:site"/>
<meta content="Whonix" name="twitter:domain"/>
<meta content="@Whonix" name="twitter:creator"/>
<meta content="Instructions on how to connect to Tor before a proxy (User -&amp;gt; Tor -&amp;gt; Proxy -&amp;gt; Internet)" name="description"/>
<meta content="Instructions on how to connect to Tor before a proxy (User -&amp;gt; Tor -&amp;gt; Proxy -&amp;gt; Internet)" name="twitter:description"/>
<meta content="width=device-width, user-scalable=yes, initial-scale=1.0" name="viewport"/>
<link data-href="/w/index.php?title=Tunnels/Connecting_to_Tor_before_a_proxy&amp;action=edit" href="https://www.whonix.org/w/index.php?title=Tunnels/Connecting_to_Tor_before_a_proxy&amp;action=edit" rel="alternate.html" title="Edit" type="application/x-wiki"/>
<link data-href="/w/index.php?title=Tunnels/Connecting_to_Tor_before_a_proxy&amp;action=edit" href="https://www.whonix.org/w/index.php?title=Tunnels/Connecting_to_Tor_before_a_proxy&amp;action=edit" rel="edit.html" title="Edit"/>
<link data-href="/favicon.ico" href="data:image/x-icon;base64,AAABAAEAEBAAAAEAIABoBAAAFgAAACgAAAAQAAAAIAAAAAEAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOPj4wC5q6j/xba0/8W2tP+3qab/4+PiBQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALyurP/Ku7n/yru5/8q7uf/Ku7n/yru5/8q7uf+6rKr/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALyurP/Ku7n/yru5/8CohP/VnhL/1Z4S/8CohP/Ku7n/yru5/7mrqf8AAAAAAAAAAAAAAAAAAAAAAAAAAI6Mi//Ku7n/yru5/8GRHP/iqhL/////////////////wJEd/8q7uf/Ku7n/xsXE/wAAAAAAAAAAAAAAAAAAAAC5q6n/yru5/8q7uf/hqRH//////0bcy/9G3Mv//////+GpEf/Ku7n/yru5/7qsqv8AAAAAAAAAAAAAAAAAAAAAxLW0/8q7uf/Ku7n/4qoS/////////////////0bcy//iqhL/yru5/8q7uf/Gt7T/AAAAAAAAAAAAAAAAAAAAAMKzsP/Ku7n/yru5/96lFf//////RtzL/0bcy///////3qUV/8q7uf/Ku7n/wrWy/wAAAAAAAAAAAAAAAAAAAACvo6D/yru5/8q7uf/Ku7n/4akQ//fnvP/57tD/4akQ/8q7uf/Ku7n/yru5/7Gkov8AAAAAAAAAAAAAAAAAAAAAAAAAAMq7uf/Ku7n/yru5/8q7uf/hqRD/4akQ/8q7uf/Ku7n/yru5/8q7uf8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACOjIv/yru5/8q7uf/Ku7n/yru5/8q7uf/Ku7n/yru5/8q7uf+Mioj/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAISDgf/Iurj/yru5/8q7uf/Ku7n/yru5/8i5uP+EgoH/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAC6rKr/q56c/wAAAACOjIv/joyL/wAAAACom5r/taim/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAuqyp/66hnv8AAAAAAAAAAAAAAAAAAAAAqp2b/7SnpP8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKmcm/+9r6z/AAAAAAAAAAAAAAAAAAAAALmrqf+jl5b/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwLOw/6uenP8AAAAAAAAAAKqenP+/sq//AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACtoJ7/vK2r/72vrP+sn57/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/D8AAPAPAADgBwAAwAMAAMADAADAAwAAwAMAAMADAADgBwAA4AcAAPAPAADyTwAA888AAPPPAAD5nwAA/D8AAA==" rel="shortcut icon"/>
<link data-href="/w/opensearch_desc.php" href="https://www.whonix.org/w/opensearch_desc.php" rel="search.html" title="Whonix (en)" type="application/opensearchdescription+xml"/>
<link data-href="https://www.whonix.org/w/api.php?action=rsd" href="https://www.whonix.org/w/api.php?action=rsd" rel="EditURI" type="application/rsd+xml"/>
<link data-href="/w/index.php?title=Special:RecentChanges&amp;feed=atom" href="https://www.whonix.org/w/index.php?title=Special:RecentChanges&amp;feed=atom" rel="alternate.html" title="Whonix Atom feed" type="application/atom+xml"/>
<meta content="article" property="og:type"/>
<meta content="Whonix" property="og:site_name"/>
<meta content="Tunnels/Connecting to Tor before a proxy" property="og:title"/>
<meta content="../Tunnels/Connecting_to_Tor_before_a_proxy" property="og:url"/>
<meta content="https://www.whonix.org/w/images/f/f3/Balloon-936780640.jpg" property="og:image"/>
<meta content="Instructions on how to connect to Tor before a proxy (User -&amp;gt; Tor -&amp;gt; Proxy -&amp;gt; Internet)" property="og:description"/>

<meta content="" property="fb:app_id"/>
<meta content="" property="fb:admins"/>
<meta content="https://www.facebook.com/Whonix" property="article:author"/>
<meta content="https://www.facebook.com/Whonix" property="article:publisher"/>
<meta content="IE=edge" http-equiv="X-UA-Compatible"/>
<!--[if lt IE 9]><script src="/w/load.php?debug=false&amp;lang=en&amp;modules=html5shiv&amp;only=scripts&amp;skin=foreground&amp;sync=1"></script><![endif]-->
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Tunnels_Connecting_to_Tor_before_a_proxy rootpage-Tunnels skin-foreground action-view"><div id="navwrapper"><!-- START FOREGROUNDTEMPLATE -->

</div>
<div id="page-content">
<div class="row">
<div class="large-12 columns">
<!-- Output page indicators -->
<div class="mw-indicators mw-body-content">
</div>
<!-- If user is logged in output echo location -->
<!--[if lt IE 9]>
				<div id="siteNotice" class="sitenotice panel radius">Whonix may not look as expected in this version of Internet Explorer. We recommend you upgrade to a newer version of Internet Explorer or switch to a browser like Firefox or Chrome.</div>
				<![endif]-->
<div class="sitenotice" id="siteNotice"><div dir="ltr" id="localNotice" lang="en"><div class="mw-parser-output"><p><style type="text/css">

#banner {
 position: relative;
 overflow: hidden;
 margin-bottom: 0.5em !important;
 margin-top: 0.5em !important;
 background-color:#D03232;
 border: solid 1px #aaaaaa; 
 height:66px;
}

#banner a.cn-full-banner-click {
 display:block;
 height:100%;
 width:100%;
 cursor: pointer;
}


#banner-logo {
 position: absolute;
 top: 8px;
 left: 15px;
 background-image: url(data:image/png;base64,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);
 height: 50px;
 width: 100%;
 background-repeat: no-repeat;
}

#banner #black-text {
 font-size: 1.1em;
 color: white;
 padding: 0.5em 40px 0.4em 60px;
 line-height: 1.3em;
 text-align: center;
}
</style>
</p><div id="banner">
<a class="cn-full-banner-click" data-href="/wiki/Payments" href="../Payments.html" title="">
<div id="banner-logo"></div>
<div id="black-text">
Whonix requires payments to stay alive.
     </div>
</a>
</div>
</div></div></div> </div>
</div>
<div id="mw-js-message" style="display:none;"></div>
<div class="row">
<div class="large-12 columns" id="p-cactions">
<a class="button small secondary radius" data-dropdown="actions" data-options="align:left; is_hover: true; hover_timeout:700" href="#" id="actions-button"><i class="fa fa-cog"><span class="show-for-medium-up"> Actions</span></i></a>
<!--RTL -->
<ul class="f-dropdown" data-dropdown-content="" id="actions">
<li class="selected" id="ca-nstab-main"><a accesskey="c" data-href="/wiki/Tunnels/Connecting_to_Tor_before_a_proxy" href="../Tunnels/Connecting_to_Tor_before_a_proxy.html" title="View the content page [c]">Page</a></li><li class="new" id="ca-talk"><a accesskey="t" data-href="/w/index.php?title=Talk:Tunnels/Connecting_to_Tor_before_a_proxy&amp;action=edit&amp;redlink=1" href="https://www.whonix.org/w/index.php?title=Talk:Tunnels/Connecting_to_Tor_before_a_proxy&amp;action=edit&amp;redlink=1" rel="discussion.html" title="Discussion about the content page (page does not exist) [t]">Discussion</a></li><li id="ca-edit"><a accesskey="e" data-href="/w/index.php?title=Tunnels/Connecting_to_Tor_before_a_proxy&amp;action=edit" href="https://www.whonix.org/w/index.php?title=Tunnels/Connecting_to_Tor_before_a_proxy&amp;action=edit.html" title="Edit this page [e]">Edit</a></li><li id="ca-history"><a accesskey="h" data-href="/w/index.php?title=Tunnels/Connecting_to_Tor_before_a_proxy&amp;action=history" href="https://www.whonix.org/w/index.php?title=Tunnels/Connecting_to_Tor_before_a_proxy&amp;action=history.html" title="Past revisions of this page [h]">History</a></li> </ul>
<!--RTL -->
<div id="content">
<h1 class="title" id="firstHeading">Tunnels/Connecting to Tor before a proxy</h1>
<h5 class="subtitle" id="siteSub"><span class="subpages">&lt; <a class="mw-redirect" data-href="/wiki/Tunnels" href="../Tunnels.html" title="Tunnels">Tunnels</a></span></h5>
<div class="clear_both" id="contentSub"></div>
<div class="mw-bodytext" id="bodyContent">
<div class="mw-content-ltr" dir="ltr" id="mw-content-text" lang="en"><div class="mw-parser-output">
<table class="metadata plainlinks ambox ambox-notice" style="">
<tbody><tr><td class="mbox-image"><div style="width: 52px;"><a class="image" data-href="/w/index.php?title=File:Ambox_warning_pn.svg.png&amp;filetimestamp=20130717200816&amp;" href="https://www.whonix.org/w/index.php?title=File:Ambox_warning_pn.svg.png&amp;filetimestamp=20130717200816&amp;"><img alt="Ambox warning pn.svg.png" data-src="/w/images/thumb/f/f7/Ambox_warning_pn.svg.png/40px-Ambox_warning_pn.svg.png" data-srcset="/w/images/thumb/f/f7/Ambox_warning_pn.svg.png/60px-Ambox_warning_pn.svg.png 1.5x, /w/images/thumb/f/f7/Ambox_warning_pn.svg.png/80px-Ambox_warning_pn.svg.png 2x" height="35" src="data:image/png;base64,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" width="40"/></a></div></td><td class="mbox-text" style=""><span class="mbox-text-span"><font size="4"><b><u>Before combining Tor with other tunnels, <a data-href="/wiki/Tunnels/Introduction" href="../Tunnels/Introduction.html" title="Tunnels/Introduction">be sure to read and understand the risks</a>!</u></b></font><span class="hide-when-compact"> </span><span class="hide-when-compact"> </span></span></td></tr></tbody></table>
<table class="metadata plainlinks ambox ambox-notice" style="">
<tbody><tr><td class="mbox-image"><div style="width: 52px;"><a class="image" data-href="/w/index.php?title=File:Ambox_notice.png&amp;filetimestamp=20130717195411&amp;" href="https://www.whonix.org/w/index.php?title=File:Ambox_notice.png&amp;filetimestamp=20130717195411&amp;"><img alt="Ambox notice.png" data-src="/w/images/c/c8/Ambox_notice.png" height="40" src="data:image/png;base64,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" width="40"/></a></div></td><td class="mbox-text" style=""><span class="mbox-text-span"><u>Advertisement</u>:<br/>
Too difficult to set up? Provider specific automation can be created for you by the lead developer of Whonix. Send reasonable price suggestions. Get in <a data-href="/wiki/Contact#For_Private_Inquiries" href="../Contact.html" title="Contact">contact</a>.<span class="hide-when-compact"> </span><span class="hide-when-compact"> </span></span></td></tr></tbody></table>
<p><br/>
<b><code>User</code> -&gt; <code>Tor</code> -&gt; <code>Proxy</code> -&gt; <code>Internet</code></b>
</p>
<div class="toc" id="toc"><div class="toctitle" dir="ltr" lang="en"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Introduction"><span class="tocnumber">1</span> <span class="toctext">Introduction</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#Proxy_Warning"><span class="tocnumber">1.1</span> <span class="toctext">Proxy Warning</span></a></li>
<li class="toclevel-2 tocsection-3"><a href="#Generally"><span class="tocnumber">1.2</span> <span class="toctext">Generally</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-4"><a href="#Proxy_Settings_Method"><span class="tocnumber">2</span> <span class="toctext">Proxy Settings Method</span></a>
<ul>
<li class="toclevel-2 tocsection-5"><a href="#Introduction_2"><span class="tocnumber">2.1</span> <span class="toctext">Introduction</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="#Tor_Browser_Notes"><span class="tocnumber">2.2</span> <span class="toctext">Tor Browser Notes</span></a></li>
<li class="toclevel-2 tocsection-7"><a href="#Misc_Application_Notes"><span class="tocnumber">2.3</span> <span class="toctext">Misc Application Notes</span></a></li>
<li class="toclevel-2 tocsection-8"><a href="#uwt_wrapped_application_notes"><span class="tocnumber">2.4</span> <span class="toctext">uwt wrapped application notes</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-9"><a href="#Proxyfier_Method"><span class="tocnumber">3</span> <span class="toctext">Proxyfier Method</span></a>
<ul>
<li class="toclevel-2 tocsection-10"><a href="#General"><span class="tocnumber">3.1</span> <span class="toctext">General</span></a></li>
<li class="toclevel-2 tocsection-11"><a href="#Tor_Browser_Notes_2"><span class="tocnumber">3.2</span> <span class="toctext">Tor Browser Notes</span></a></li>
<li class="toclevel-2 tocsection-12"><a href="#Misc_Application_Notes_2"><span class="tocnumber">3.3</span> <span class="toctext">Misc Application Notes</span></a></li>
<li class="toclevel-2 tocsection-13"><a href="#uwt_wrapped_application_notes_2"><span class="tocnumber">3.4</span> <span class="toctext">uwt wrapped application notes</span></a></li>
<li class="toclevel-2 tocsection-14"><a href="#uwt"><span class="tocnumber">3.5</span> <span class="toctext">uwt</span></a>
<ul>
<li class="toclevel-3 tocsection-15"><a href="#Introduction_3"><span class="tocnumber">3.5.1</span> <span class="toctext">Introduction</span></a></li>
<li class="toclevel-3 tocsection-16"><a href="#uwt_wrapped_application_example"><span class="tocnumber">3.5.2</span> <span class="toctext">uwt wrapped application example</span></a></li>
<li class="toclevel-3 tocsection-17"><a href="#regular_application_example"><span class="tocnumber">3.5.3</span> <span class="toctext">regular application example</span></a></li>
<li class="toclevel-3 tocsection-18"><a href="#Tor_Browser_Example"><span class="tocnumber">3.5.4</span> <span class="toctext">Tor Browser Example</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-19"><a href="#proxychains"><span class="tocnumber">3.6</span> <span class="toctext">proxychains</span></a>
<ul>
<li class="toclevel-3 tocsection-20"><a href="#Warnings"><span class="tocnumber">3.6.1</span> <span class="toctext">Warnings</span></a></li>
<li class="toclevel-3 tocsection-21"><a href="#Setup"><span class="tocnumber">3.6.2</span> <span class="toctext">Setup</span></a></li>
<li class="toclevel-3 tocsection-22"><a href="#example_uwt_wrapped_application"><span class="tocnumber">3.6.3</span> <span class="toctext">example uwt wrapped application</span></a></li>
<li class="toclevel-3 tocsection-23"><a href="#example_regular_application"><span class="tocnumber">3.6.4</span> <span class="toctext">example regular application</span></a></li>
<li class="toclevel-3 tocsection-24"><a href="#Tor_Browser_example_2"><span class="tocnumber">3.6.5</span> <span class="toctext">Tor Browser example</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-25"><a href="#Transparent_Proxying_Method"><span class="tocnumber">4</span> <span class="toctext">Transparent Proxying  Method</span></a>
<ul>
<li class="toclevel-2 tocsection-26"><a href="#Introduction_4"><span class="tocnumber">4.1</span> <span class="toctext">Introduction</span></a></li>
<li class="toclevel-2 tocsection-27"><a href="#Tools"><span class="tocnumber">4.2</span> <span class="toctext">Tools</span></a></li>
<li class="toclevel-2 tocsection-28"><a href="#DNS_resolution"><span class="tocnumber">4.3</span> <span class="toctext">DNS resolution</span></a></li>
<li class="toclevel-2 tocsection-29"><a href="#Prevent_Bypassing_the_Tunnel-Link"><span class="tocnumber">4.4</span> <span class="toctext">Prevent Bypassing the Tunnel-Link</span></a></li>
<li class="toclevel-2 tocsection-30"><a href="#How_to_setup_proxy_tunnel-link_after_Tor_.28User-.3ETor-.3EProxy-.3EInternet.29"><span class="tocnumber">4.5</span> <span class="toctext">How to setup proxy tunnel-link after Tor (User-&gt;Tor-&gt;Proxy-&gt;Internet)</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-31"><a href="#Footnotes"><span class="tocnumber">5</span> <span class="toctext">Footnotes</span></a></li>
</ul>
</div>
<h1><span class="mw-headline" id="Introduction">Introduction</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Tunnels/Connecting_to_Tor_before_a_proxy&amp;action=edit&amp;section=1" href="https://www.whonix.org/w/index.php?title=Tunnels/Connecting_to_Tor_before_a_proxy&amp;action=edit&amp;section=1.html" title="Edit section: Introduction">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<h2><span class="mw-headline" id="Proxy_Warning">Proxy Warning</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Tunnels/Connecting_to_Tor_before_a_proxy&amp;action=edit&amp;section=2" href="https://www.whonix.org/w/index.php?title=Tunnels/Connecting_to_Tor_before_a_proxy&amp;action=edit&amp;section=2.html" title="Edit section: Proxy Warning">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<table class="metadata plainlinks ambox ambox-notice" style="">
<tbody><tr><td class="mbox-image"><div style="width: 52px;"><a class="image" data-href="/w/index.php?title=File:Ambox_warning_pn.svg.png&amp;filetimestamp=20130717200816&amp;" href="https://www.whonix.org/w/index.php?title=File:Ambox_warning_pn.svg.png&amp;filetimestamp=20130717200816&amp;"><img alt="Whonix first time users warning" data-src="/w/images/thumb/f/f7/Ambox_warning_pn.svg.png/40px-Ambox_warning_pn.svg.png" data-srcset="/w/images/thumb/f/f7/Ambox_warning_pn.svg.png/60px-Ambox_warning_pn.svg.png 1.5x, /w/images/thumb/f/f7/Ambox_warning_pn.svg.png/80px-Ambox_warning_pn.svg.png 2x" height="35" src="data:image/png;base64,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" width="40"/></a></div></td><td class="mbox-text" style=""><span class="mbox-text-span"><b><u>Warning!</u></b>
<p>There are issues you should be aware of when using standard, common http(s)/socks4(a)/5 proxies. (Anonymizers, that only use http(s)/socks4(a)/5 as an interface<sup class="reference" id="cite_ref-1"><a href="#cite_note-1">[1]</a></sup> are exempt.)
</p>
<ul><li>Most problems with these proxies are not caused by Whonix.</li>
<li>Tor exit relays and their ISPs can still monitor your connection to its destination.</li>
<li>Be especially careful with http(s) proxies. Some of them send the "<a class="external text" data-href="https://trac.torproject.org/projects/tor/wiki/doc/TorPlusVPN#VPNSSHversusProxy" href="https://trac.torproject.org/projects/tor/wiki/doc/TorPlusVPN" rel="noreferrer noopener" target="_blank">http forwarded for</a>" header which discloses your IP. Http(s) proxies that do not send this header are sometimes called "elite" or "anonymous" proxies.</li>
<li>When using "http forwarded for" http(s) proxies, destination servers can determine the IP of your Tor exit relay.</li></ul>
See also: <a data-href="/wiki/Comparison_Of_Tor_with_CGI_Proxies,_Proxy_Chains,_and_VPN_Services" href="../Comparison_Of_Tor_with_CGI_Proxies,_Proxy_Chains,_and_VPN_Services.html" title="Comparison Of Tor with CGI Proxies, Proxy Chains, and VPN Services">Comparison Of Tor with CGI Proxies, Proxy Chains, and VPN_Services</a>.<span class="hide-when-compact"> </span><span class="hide-when-compact"> </span></span></td></tr></tbody></table>
<h2><span class="mw-headline" id="Generally">Generally</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Tunnels/Connecting_to_Tor_before_a_proxy&amp;action=edit&amp;section=3" href="https://www.whonix.org/w/index.php?title=Tunnels/Connecting_to_Tor_before_a_proxy&amp;action=edit&amp;section=3.html" title="Edit section: Generally">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>There are three different methods.
</p>
<table class="wikitable" style="background-color: #fff;text-align: center">
<tbody><tr>
<th>
</th>
<th><a href="#Proxy_Settings_Method">#Proxy Settings Method</a>
</th>
<th><a href="#Proxifier_Method">#Proxifier Method</a>
</th>
<th><a href="#Transparent_Proxying_Method">#Transparent Proxying Method</a>
</th></tr>
<tr>
<th>application requires no support for proxy settings
</th>
<td style="background-color: #FF9090">No
</td>
<td style="background-color: #90FF90">Yes
</td>
<td style="background-color: #90FF90">Yes
</td></tr>
<tr>
<th>likelihood of leaks <sup class="reference" id="cite_ref-2"><a href="#cite_note-2">[2]</a></sup> going user -&gt; Tor -&gt; Internet
</th>
<td>depends <sup class="reference" id="cite_ref-3"><a href="#cite_note-3">[3]</a></sup>
</td>
<td>depends <sup class="reference" id="cite_ref-4"><a href="#cite_note-4">[4]</a></sup>
</td>
<td>lower <sup class="reference" id="cite_ref-5"><a href="#cite_note-5">[5]</a></sup>
</td></tr>
<tr>
<th>DNS can be resolved by the same proxy
</th>
<td style="background-color: #90FF90">Yes
</td>
<td style="background-color: #90FF90">Yes
</td>
<td>needs extra DNS resolver <sup class="reference" id="cite_ref-6"><a href="#cite_note-6">[6]</a></sup>
</td></tr>
<tr>
<th>per application configuration required
</th>
<td style="background-color: #90FF90">Yes
</td>
<td style="background-color: #90FF90">Yes
</td>
<td style="background-color: #FF9090">No
</td></tr>
<tr>
<th>system wide configuration
</th>
<td style="background-color: #FF9090">No
</td>
<td style="background-color: #FF9090">No
</td>
<td style="background-color: #90FF90">Yes
</td></tr>
<tr>
<th>proxy chains possible
</th>
<td>No
</td>
<td>Yes, but see footnote
<p><sup class="reference" id="cite_ref-7"><a href="#cite_note-7">[7]</a></sup>
</p>
</td>
<td>No <sup class="reference" id="cite_ref-8"><a href="#cite_note-8">[8]</a></sup>
</td></tr>
<tr>
<th>setup difficulty
</th>
<td>different per application
</td>
<td>always very similar
</td>
<td>initial setup difficult
</td></tr>
</tbody></table>
<hr/>
<h1><span class="mw-headline" id="Proxy_Settings_Method">Proxy Settings Method</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Tunnels/Connecting_to_Tor_before_a_proxy&amp;action=edit&amp;section=4" href="https://www.whonix.org/w/index.php?title=Tunnels/Connecting_to_Tor_before_a_proxy&amp;action=edit&amp;section=4.html" title="Edit section: Proxy Settings Method">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<h2><span class="mw-headline" id="Introduction_2">Introduction</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Tunnels/Connecting_to_Tor_before_a_proxy&amp;action=edit&amp;section=5" href="https://www.whonix.org/w/index.php?title=Tunnels/Connecting_to_Tor_before_a_proxy&amp;action=edit&amp;section=5.html" title="Edit section: Introduction">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>You could use an application's native proxy settings to configure applications in Whonix to use an extra proxy. This of course supposes, that the application has proxy settings. After understanding Whonix's default stream isolation configuration, there is no difference from using proxy settings in an ordinary way, other than that it is running inside Whonix-Workstation. If proxy settings are honored by an application or not is another question and out of scope, see <a class="external text" data-href="https://trac.torproject.org/projects/tor/wiki/doc/TorifyHOWTO" href="https://trac.torproject.org/projects/tor/wiki/doc/TorifyHOWTO" rel="noreferrer noopener" target="_blank">TorifyHOWTO</a>. There is a <a data-href="/wiki/Stream_Isolation#List" href="../Stream_Isolation.html" title="Stream Isolation">list</a> of applications that come pre-configured with Whonix for <a data-href="/wiki/Stream_Isolation" href="../Stream_Isolation.html" title="Stream Isolation">Stream Isolation</a>. If you plan on changing the proxy settings of any of those, you must read the notes below.
</p>
<table class="metadata plainlinks ambox ambox-notice" style="">
<tbody><tr><td class="mbox-image"><div style="width: 52px;"><a class="image" data-href="/w/index.php?title=File:Ambox_warning_pn.svg.png&amp;filetimestamp=20130717200816&amp;" href="https://www.whonix.org/w/index.php?title=File:Ambox_warning_pn.svg.png&amp;filetimestamp=20130717200816&amp;"><img alt="Ambox warning pn.svg.png" data-src="/w/images/thumb/f/f7/Ambox_warning_pn.svg.png/40px-Ambox_warning_pn.svg.png" data-srcset="/w/images/thumb/f/f7/Ambox_warning_pn.svg.png/60px-Ambox_warning_pn.svg.png 1.5x, /w/images/thumb/f/f7/Ambox_warning_pn.svg.png/80px-Ambox_warning_pn.svg.png 2x" height="35" src="data:image/png;base64,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" width="40"/></a></div></td><td class="mbox-text" style=""><span class="mbox-text-span">Apply the following steps to avoid unexpected results such as broken connectivity and/or traffic bypassing the tunnel-link and only going through Tor. 
<p><br/>
</p>
<a class="mw-redirect" data-href="/wiki/Qubes-Whonix" href="../Qubes-Whonix.html" title="Qubes-Whonix">Qubes-Whonix</a> exception: There is one tunnel configuration where Qubes-Whonix users are better placed. When a separate tunnel-link VM is used between anon-whonix and sys-whonix (<code>anon-whonix</code> -&gt; <code>Tunnel-link</code> -&gt; <code>sys-whonix</code>), these connections simply fail without the following modifications.<span class="hide-when-compact"> </span><span class="hide-when-compact"> </span></span></td></tr></tbody></table>
<p><span id="Tor_Browser_Proxy_Configuration"></span>
</p>
<h2><span class="mw-headline" id="Tor_Browser_Notes">Tor Browser Notes</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Tunnels/Connecting_to_Tor_before_a_proxy&amp;action=edit&amp;section=6" href="https://www.whonix.org/w/index.php?title=Tunnels/Connecting_to_Tor_before_a_proxy&amp;action=edit&amp;section=6.html" title="Edit section: Tor Browser Notes">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<div style="background: #F8F8F8; border: 2px; padding: 5px; margin: 10px; border-style: solid; border-color: black; width: 100%">
<p>Complete the following steps inside Whonix-Workstation (<code>anon-whonix</code>). Launch Tor Browser and enter <code>about:config</code> into the URL bar. Change the following settings.
</p><p><i>extensions.torbutton.use_nontor_proxy;true</i><br/>
<i>network.proxy.no_proxies_on;0</i>
</p><p>Add the CGI HTTP proxy address and port number to the following strings.
</p><p><i>network.proxy.http; </i><br/>
<i>network.proxy.http_port;</i>
</p><p>If a HTTPS proxy is being used, modify the following strings instead.
</p><p><i>network.proxy.ssl;</i><br/>
<i>network.proxy.ssl_port;</i>
</p><p>This process can be repeated with web socks proxies, but it is redundant and does not provide any advantage over the former types. The reason is because only Tor Browser is modified and no other programs are being tunneled through it.
</p>
</div>
<h2><span class="mw-headline" id="Misc_Application_Notes">Misc Application Notes</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Tunnels/Connecting_to_Tor_before_a_proxy&amp;action=edit&amp;section=7" href="https://www.whonix.org/w/index.php?title=Tunnels/Connecting_to_Tor_before_a_proxy&amp;action=edit&amp;section=7.html" title="Edit section: Misc Application Notes">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<div style="background: #F8F8F8; border: 2px; padding: 5px; margin: 10px; border-style: solid; border-color: black; width: 100%">
<p>On the <a data-href="/wiki/Stream_Isolation" href="../Stream_Isolation.html" title="Stream Isolation">Stream Isolation</a> page, there is a list of applications that are pre-configured to use <a data-href="/wiki/Stream_Isolation#By_Settings" href="../Stream_Isolation.html" title="Stream Isolation">socks proxy settings</a> via application configuration files. To disable this, the Whonix system default must be removed from the application's settings.
</p><p>TODO: document and expand.
</p>
<div style="background: #F8F8F8; border: 2px; padding: 5px; margin: 10px; border-style: solid; border-color: black; width: 100%">
<p>Remove proxy settings for <a data-href="/wiki/Tor_Browser#Tor_Browser_Downloader_by_Whonix" href="../Tor_Browser.html" title="Tor Browser">Tor Browser Downloader by Whonix</a>.
</p><p>Open <i><span style="background-color:#FBFBFB">/etc/torbrowser.d/50_user.conf</span></i> in an editor with root rights.
</p>
<div style="background: #F8F8F8; border: 2px; padding: 5px; margin: 10px; border-style: solid; border-color: black; width: 100%">
<p><u>If you are using a graphical Whonix or <a data-href="/wiki/Qubes" href="../Qubes.html" title="Qubes">Qubes-Whonix</a></u>, run.
</p><div class="codeContainer">
<div class="selectBtnDiv">
<div class="smallText"><a class="selectLink" href="#" onclick="SelectText(this.parentNode.parentNode.parentNode.children[2].children[0]); return false;">[select code]</a></div>
</div>
<div class="preDiv">
<pre>kdesudo kwrite /etc/torbrowser.d/50_user.conf</pre>
</div>
<div class="textareaDiv">
<textarea class="codeBoxArea" readonly="readonly" rows="1">kdesudo kwrite /etc/torbrowser.d/50_user.conf</textarea>
</div>
</div>
<p><u>If you are using a terminal-only Whonix</u>, run.
</p><div class="codeContainer">
<div class="selectBtnDiv">
<div class="smallText"><a class="selectLink" href="#" onclick="SelectText(this.parentNode.parentNode.parentNode.children[2].children[0]); return false;">[select code]</a></div>
</div>
<div class="preDiv">
<pre>sudo nano /etc/torbrowser.d/50_user.conf</pre>
</div>
<div class="textareaDiv">
<textarea class="codeBoxArea" readonly="readonly" rows="1">sudo nano /etc/torbrowser.d/50_user.conf</textarea>
</div>
</div>
</div>
<p>Paste. <sup class="reference" id="cite_ref-9"><a href="#cite_note-9">[9]</a></sup> <sup class="reference" id="cite_ref-10"><a href="#cite_note-10">[10]</a></sup>
</p><p></p><div class="codeContainer">
<div class="selectBtnDiv">
<div class="smallText"><a class="selectLink" href="#" onclick="SelectText(this.parentNode.parentNode.parentNode.children[2].children[0]); return false;">[select code]</a></div>
</div>
<div class="preDiv">
<pre>TB_NO_TOR_CON_CHECK=1
CURL_PROXY="--fail"</pre>
</div>
<div class="textareaDiv">
<textarea class="codeBoxArea" readonly="readonly" rows="1">TB_NO_TOR_CON_CHECK=1
CURL_PROXY="--fail"</textarea>
</div>
</div>
<p>Save.
</p>
</div>
<p>For some applications, this is impossible:
</p>
<ul><li><a data-href="/wiki/Sdwdate" href="../Sdwdate.html" title="Sdwdate">sdwdate</a></li>
<li>onionshare</li>
<li>Ricochet IM</li></ul>
<p><br/>
These applications can only talk to Tor <a data-href="/wiki/Onion_Services" href="../Onion_Services.html" title="Onion Services">Onion Services</a> directly and cannot be configured to use the system default. You can only deactivate sdwdate and/or not use Ricochet IM.
</p>
</div>
<h2><span class="mw-headline" id="uwt_wrapped_application_notes">uwt wrapped application notes</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Tunnels/Connecting_to_Tor_before_a_proxy&amp;action=edit&amp;section=8" href="https://www.whonix.org/w/index.php?title=Tunnels/Connecting_to_Tor_before_a_proxy&amp;action=edit&amp;section=8.html" title="Edit section: uwt wrapped application notes">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Whonix ships a list of applications pre-configured for using uwt wrappers by default. If the application you want to tunnel through the extra tunnel-link is on that list, it would conflict with your custom proxy settings. In that case, you need to disable that uwt wrapper first.
</p>
<div style="background: #F8F8F8; border: 2px; padding: 5px; margin: 10px; border-style: solid; border-color: black; width: 100%">
<p>On the <a data-href="/wiki/Stream_Isolation" href="../Stream_Isolation.html" title="Stream Isolation">Stream Isolation</a> page, there is a list of applications that are pre-configured to use <a data-href="/wiki/Stream_Isolation#By_uwt_wrapper" href="../Stream_Isolation.html" title="Stream Isolation">uwt wrappers</a>. Follow the instructions below in order to disable this.
</p>
<div style="background: #F8F8F8; border: 2px; padding: 5px; margin: 10px; border-style: solid; border-color: black; width: 100%">
<p>The following instructions permanently deactivate all uwt wrappers and remove stream isolation for <a data-href="/wiki/Stream_Isolation#By_uwt_wrapper" href="../Stream_Isolation.html" title="Stream Isolation">uwt wrapped applications</a> system-wide. Consequently, all uwt wrapped applications revert to the default system networking configuration.
</p><p>If you want more granular control of uwt wrapper deactivation, see <a data-href="/wiki/Stream_Isolation#Deactivate_uwt_Stream_Isolation_Wrapper" href="../Stream_Isolation.html" title="Stream Isolation">Stream_Isolation#Deactivate_uwt_Stream_Isolation_Wrapper</a>.
</p>
<div style="background: #F8F8F8; border: 2px; padding: 5px; margin: 10px; border-style: solid; border-color: black; width: 100%">
<p>Open <i><span style="background-color:#FBFBFB">/etc/uwt.d/50_user.conf</span></i> in an editor with root rights.
</p>
<div style="background: #F8F8F8; border: 2px; padding: 5px; margin: 10px; border-style: solid; border-color: black; width: 100%">
<p><u>If you are using a graphical Whonix or <a data-href="/wiki/Qubes" href="../Qubes.html" title="Qubes">Qubes-Whonix</a></u>, run.
</p><div class="codeContainer">
<div class="selectBtnDiv">
<div class="smallText"><a class="selectLink" href="#" onclick="SelectText(this.parentNode.parentNode.parentNode.children[2].children[0]); return false;">[select code]</a></div>
</div>
<div class="preDiv">
<pre>kdesudo kwrite /etc/uwt.d/50_user.conf</pre>
</div>
<div class="textareaDiv">
<textarea class="codeBoxArea" readonly="readonly" rows="1">kdesudo kwrite /etc/uwt.d/50_user.conf</textarea>
</div>
</div>
<p><u>If you are using a terminal-only Whonix</u>, run.
</p><div class="codeContainer">
<div class="selectBtnDiv">
<div class="smallText"><a class="selectLink" href="#" onclick="SelectText(this.parentNode.parentNode.parentNode.children[2].children[0]); return false;">[select code]</a></div>
</div>
<div class="preDiv">
<pre>sudo nano /etc/uwt.d/50_user.conf</pre>
</div>
<div class="textareaDiv">
<textarea class="codeBoxArea" readonly="readonly" rows="1">sudo nano /etc/uwt.d/50_user.conf</textarea>
</div>
</div>
</div>
<p>Add.
</p><p></p><div class="codeContainer">
<div class="selectBtnDiv">
<div class="smallText"><a class="selectLink" href="#" onclick="SelectText(this.parentNode.parentNode.parentNode.children[2].children[0]); return false;">[select code]</a></div>
</div>
<div class="preDiv">
<pre>uwtwrapper_global="0"</pre>
</div>
<div class="textareaDiv">
<textarea class="codeBoxArea" readonly="readonly" rows="1">uwtwrapper_global="0"</textarea>
</div>
</div>
<p>Save and exit.
</p>
</div>
</div>
</div>
<hr/>
<h1><span class="mw-headline" id="Proxyfier_Method">Proxyfier Method</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Tunnels/Connecting_to_Tor_before_a_proxy&amp;action=edit&amp;section=9" href="https://www.whonix.org/w/index.php?title=Tunnels/Connecting_to_Tor_before_a_proxy&amp;action=edit&amp;section=9.html" title="Edit section: Proxyfier Method">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<h2><span class="mw-headline" id="General">General</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Tunnels/Connecting_to_Tor_before_a_proxy&amp;action=edit&amp;section=10" href="https://www.whonix.org/w/index.php?title=Tunnels/Connecting_to_Tor_before_a_proxy&amp;action=edit&amp;section=10.html" title="Edit section: General">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>After understanding Whonix's default stream isolation configuration, there is no difference from using a Proxyfier in an ordinary way, other than that it is running inside Whonix-Workstation. There is a <a data-href="/wiki/Stream_Isolation#List" href="../Stream_Isolation.html" title="Stream Isolation">list</a> of applications that come pre-configured with Whonix for <a data-href="/wiki/Stream_Isolation" href="../Stream_Isolation.html" title="Stream Isolation">Stream Isolation</a>. If you plan on changing the proxy settings of any of those, you must read the notes below.
</p><p>If the Proxifier is leak free or in worst case leaks through Tor alone (thanks to Whonix), is another question and not in Whonix's power, see <a class="external text" data-href="https://trac.torproject.org/projects/tor/wiki/doc/TorifyHOWTO" href="https://trac.torproject.org/projects/tor/wiki/doc/TorifyHOWTO" rel="noreferrer noopener" target="_blank">TorifyHOWTO</a>.
</p>
<table class="metadata plainlinks ambox ambox-notice" style="">
<tbody><tr><td class="mbox-image"><div style="width: 52px;"><a class="image" data-href="/w/index.php?title=File:Ambox_warning_pn.svg.png&amp;filetimestamp=20130717200816&amp;" href="https://www.whonix.org/w/index.php?title=File:Ambox_warning_pn.svg.png&amp;filetimestamp=20130717200816&amp;"><img alt="Ambox warning pn.svg.png" data-src="/w/images/thumb/f/f7/Ambox_warning_pn.svg.png/40px-Ambox_warning_pn.svg.png" data-srcset="/w/images/thumb/f/f7/Ambox_warning_pn.svg.png/60px-Ambox_warning_pn.svg.png 1.5x, /w/images/thumb/f/f7/Ambox_warning_pn.svg.png/80px-Ambox_warning_pn.svg.png 2x" height="35" src="data:image/png;base64,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" width="40"/></a></div></td><td class="mbox-text" style=""><span class="mbox-text-span">Apply the following steps to avoid unexpected results such as broken connectivity and/or traffic bypassing the tunnel-link and only going through Tor. 
<p><br/>
</p>
<a class="mw-redirect" data-href="/wiki/Qubes-Whonix" href="../Qubes-Whonix.html" title="Qubes-Whonix">Qubes-Whonix</a> exception: There is one tunnel configuration where Qubes-Whonix users are better placed. When a separate tunnel-link VM is used between anon-whonix and sys-whonix (<code>anon-whonix</code> -&gt; <code>Tunnel-link</code> -&gt; <code>sys-whonix</code>), these connections simply fail without the following modifications.<span class="hide-when-compact"> </span><span class="hide-when-compact"> </span></span></td></tr></tbody></table>
<h2><span class="mw-headline" id="Tor_Browser_Notes_2">Tor Browser Notes</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Tunnels/Connecting_to_Tor_before_a_proxy&amp;action=edit&amp;section=11" href="https://www.whonix.org/w/index.php?title=Tunnels/Connecting_to_Tor_before_a_proxy&amp;action=edit&amp;section=11.html" title="Edit section: Tor Browser Notes">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<table class="metadata plainlinks ambox ambox-notice" style="">
<tbody><tr><td class="mbox-image"><div style="width: 52px;"><a class="image" data-href="/w/index.php?title=File:Ambox_warning_pn.svg.png&amp;filetimestamp=20130717200816&amp;" href="https://www.whonix.org/w/index.php?title=File:Ambox_warning_pn.svg.png&amp;filetimestamp=20130717200816&amp;"><img alt="Ambox warning pn.svg.png" data-src="/w/images/thumb/f/f7/Ambox_warning_pn.svg.png/40px-Ambox_warning_pn.svg.png" data-srcset="/w/images/thumb/f/f7/Ambox_warning_pn.svg.png/60px-Ambox_warning_pn.svg.png 1.5x, /w/images/thumb/f/f7/Ambox_warning_pn.svg.png/80px-Ambox_warning_pn.svg.png 2x" height="35" src="data:image/png;base64,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" width="40"/></a></div></td><td class="mbox-text" style=""><span class="mbox-text-span">There is currently no tested, known to work solution for using <a data-href="/wiki/Tor_Browser" href="../Tor_Browser.html" title="Tor Browser">Tor Browser</a> with the <a href="#Proxyfier_Method">#Proxyfier Method</a>. This is not a Whonix issue but rather an issue with socksifier software and Tor Browser. This would also happen if Whonix was not involved. (For a basic architectural explanation, see <a data-href="/wiki/Support#Free_Support_Principle" href="../Support.html" title="Support">Free Support Principle</a>.) Figuring this out is up to you. Please <a data-href="/wiki/Contribute" href="../Contribute.html" title="Contribute">contribute</a>. Alternatively try <a href="#Proxy_Settings_Method">#Proxy Settings Method</a>.<span class="hide-when-compact"> </span><span class="hide-when-compact"> </span></span></td></tr></tbody></table>
<div style="background: #F8F8F8; border: 2px; padding: 5px; margin: 10px; border-style: solid; border-color: black; width: 100%">
<p><b>Introduction</b><br/>
</p><p>This configuration causes Tor Browser to no longer use proxy settings. With no proxy, Tor Browser uses the (VM) system's default networking. This is identical to any other application inside the Whonix-Workstation that has not been explicitly configured to use Tor via socks proxy settings or a socksifier. This setting is also called transparent torification. <sup class="reference" id="cite_ref-11"><a href="#cite_note-11">[11]</a></sup>
</p><p>Note: This action will break both the <a data-href="/wiki/Stream_Isolation" href="../Stream_Isolation.html" title="Stream Isolation">Stream Isolation</a> for Tor Browser and <a class="external text" data-href="https://trac.torproject.org/projects/tor/ticket/3455" href="https://trac.torproject.org/projects/tor/ticket/3455" rel="noreferrer noopener" target="_blank">Tor Browser's tab isolation by socks user name</a>. This worsens the <a data-href="/wiki/Fingerprint#web_fingerprint" href="../Fingerprint.html" title="Fingerprint">web fingerprint</a> and causes the user to be <a data-href="/wiki/DoNot#Do_not_confuse_Anonymity_with_Pseudonymity." href="../DoNot.html" title="DoNot">pseudonymous, rather than anonymous</a>. To mitigate these risks, consider using <a data-href="/wiki/Advanced_Security_Guide#More_than_one_Tor_Browser_in_Whonix" href="../Advanced_Security_Guide.html" title="Advanced Security Guide">More than one Tor Browser in Whonix</a>, or better yet, <a data-href="/wiki/Multiple_Whonix-Workstations" href="../Multiple_Whonix-Workstations.html" title="Multiple Whonix-Workstations">Multiple Whonix-Workstations</a>.
</p><p>If these settings are changed, expect Tor Button to show a red sign and state "Tor Disabled" if a mouse is hovered over it.
</p><p>To enable transparent torification (no proxy setting), set the <code>TOR_TRANSPROXY=1</code> environment variable. There are several methods, but the <a href="#.2Fetc.2Fenvironment_Method">#/etc/environment Method</a> is the simplest one.
</p>
<div class="toccolours mw-collapsible mw-collapsed" style="width:800px">
<p>For other methods with finer granulated settings, please press on Expand on the right.
</p>
<div class="mw-collapsible-content">
<p>&lt;span id="<br/>od"&gt;
<b>Command Line Method</b><br/>
</p><p>Navigate to the Tor Browser folder.
</p><p></p><div class="codeContainer">
<div class="selectBtnDiv">
<div class="smallText"><a class="selectLink" href="#" onclick="SelectText(this.parentNode.parentNode.parentNode.children[2].children[0]); return false;">[select code]</a></div>
</div>
<div class="preDiv">
<pre>cd ~/tor-browser_en-US</pre>
</div>
<div class="textareaDiv">
<textarea class="codeBoxArea" readonly="readonly" rows="1">cd ~/tor-browser_en-US</textarea>
</div>
</div>
<p>Every time Tor Browser is started, run the following command to set the <code>TOR_TRANSPROXY=1</code> environment variable.
</p><p></p><div class="codeContainer">
<div class="selectBtnDiv">
<div class="smallText"><a class="selectLink" href="#" onclick="SelectText(this.parentNode.parentNode.parentNode.children[2].children[0]); return false;">[select code]</a></div>
</div>
<div class="preDiv">
<pre>TOR_TRANSPROXY=1 ./start-tor-browser.desktop</pre>
</div>
<div class="textareaDiv">
<textarea class="codeBoxArea" readonly="readonly" rows="1">TOR_TRANSPROXY=1 ./start-tor-browser.desktop</textarea>
</div>
</div>
<p><span id="start-tor-browser_Method"></span>
<b>start-tor-browser Method</b><br/>
</p><p>This only applies to a single instance of the Tor Browser folder that is configured. This method may not persist when Tor Browser is updated.
</p><p>Find and open <span style="border:1px dotted #005cb9">start-tor-browser</span> in the Tor Browser folder in an editor.
</p><p>This is most likely in <span style="border:1px dotted #005cb9">~/tor-browser_en-US/Browser/start-tor-browser</span> below <span style="border:1px dotted #005cb9">#!/usr/bin/env bash</span>.
</p><p>Set.
</p><p></p><div class="codeContainer">
<div class="selectBtnDiv">
<div class="smallText"><a class="selectLink" href="#" onclick="SelectText(this.parentNode.parentNode.parentNode.children[2].children[0]); return false;">[select code]</a></div>
</div>
<div class="preDiv">
<pre>export TOR_TRANSPROXY=1</pre>
</div>
<div class="textareaDiv">
<textarea class="codeBoxArea" readonly="readonly" rows="1">export TOR_TRANSPROXY=1</textarea>
</div>
</div>
</div>
</div>
<p><span id=".2Fetc.2Fenvironment_Method"></span>
<b>/etc/environment Method</b><br/>
</p><p>This will apply to the whole environment, including any possible custom locations of Tor Browser installation folders. <sup class="reference" id="cite_ref-12"><a href="#cite_note-12">[12]</a></sup>
</p><p>Open <i><span style="background-color:#FBFBFB">/etc/environment</span></i> in an editor with root rights.
</p>
<div style="background: #F8F8F8; border: 2px; padding: 5px; margin: 10px; border-style: solid; border-color: black; width: 100%">
<p><u>If you are using a graphical Whonix or <a data-href="/wiki/Qubes" href="../Qubes.html" title="Qubes">Qubes-Whonix</a></u>, run.
</p><div class="codeContainer">
<div class="selectBtnDiv">
<div class="smallText"><a class="selectLink" href="#" onclick="SelectText(this.parentNode.parentNode.parentNode.children[2].children[0]); return false;">[select code]</a></div>
</div>
<div class="preDiv">
<pre>kdesudo kwrite /etc/environment</pre>
</div>
<div class="textareaDiv">
<textarea class="codeBoxArea" readonly="readonly" rows="1">kdesudo kwrite /etc/environment</textarea>
</div>
</div>
<p><u>If you are using a terminal-only Whonix</u>, run.
</p><div class="codeContainer">
<div class="selectBtnDiv">
<div class="smallText"><a class="selectLink" href="#" onclick="SelectText(this.parentNode.parentNode.parentNode.children[2].children[0]); return false;">[select code]</a></div>
</div>
<div class="preDiv">
<pre>sudo nano /etc/environment</pre>
</div>
<div class="textareaDiv">
<textarea class="codeBoxArea" readonly="readonly" rows="1">sudo nano /etc/environment</textarea>
</div>
</div>
</div>
<p>Add the following line.
</p><p></p><div class="codeContainer">
<div class="selectBtnDiv">
<div class="smallText"><a class="selectLink" href="#" onclick="SelectText(this.parentNode.parentNode.parentNode.children[2].children[0]); return false;">[select code]</a></div>
</div>
<div class="preDiv">
<pre>TOR_TRANSPROXY=1</pre>
</div>
<div class="textareaDiv">
<textarea class="codeBoxArea" readonly="readonly" rows="1">TOR_TRANSPROXY=1</textarea>
</div>
</div>
<p>Save and reboot.
</p><p><b>Undo</b><br/>
</p><p>Reverting this change is undocumented. Simply unsetting that environment variable will not work due to Tor Browser limitations. The easiest way to undo this setting is to install a fresh instance of Tor Browser (please contribute to these instructions)!
</p><p><span id="Forget_about_Tor_Button.27s_Open_Network_Settings"></span>
<b>Ignore Tor Button's Open Network Settings</b><br/>
</p><p>Whonix has disabled the <code>Open Network Settings...</code> menu option in Tor Button. Read the footnote for further information. <sup class="reference" id="cite_ref-13"><a href="#cite_note-13">[13]</a></sup>
</p>
</div>
<h2><span class="mw-headline" id="Misc_Application_Notes_2">Misc Application Notes</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Tunnels/Connecting_to_Tor_before_a_proxy&amp;action=edit&amp;section=12" href="https://www.whonix.org/w/index.php?title=Tunnels/Connecting_to_Tor_before_a_proxy&amp;action=edit&amp;section=12.html" title="Edit section: Misc Application Notes">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<div style="background: #F8F8F8; border: 2px; padding: 5px; margin: 10px; border-style: solid; border-color: black; width: 100%">
<p>On the <a data-href="/wiki/Stream_Isolation" href="../Stream_Isolation.html" title="Stream Isolation">Stream Isolation</a> page, there is a list of applications that are pre-configured to use <a data-href="/wiki/Stream_Isolation#By_Settings" href="../Stream_Isolation.html" title="Stream Isolation">socks proxy settings</a> via application configuration files. To disable this, the Whonix system default must be removed from the application's settings.
</p><p>TODO: document and expand.
</p>
<div style="background: #F8F8F8; border: 2px; padding: 5px; margin: 10px; border-style: solid; border-color: black; width: 100%">
<p>Remove proxy settings for <a data-href="/wiki/Tor_Browser#Tor_Browser_Downloader_by_Whonix" href="../Tor_Browser.html" title="Tor Browser">Tor Browser Downloader by Whonix</a>.
</p><p>Open <i><span style="background-color:#FBFBFB">/etc/torbrowser.d/50_user.conf</span></i> in an editor with root rights.
</p>
<div style="background: #F8F8F8; border: 2px; padding: 5px; margin: 10px; border-style: solid; border-color: black; width: 100%">
<p><u>If you are using a graphical Whonix or <a data-href="/wiki/Qubes" href="../Qubes.html" title="Qubes">Qubes-Whonix</a></u>, run.
</p><div class="codeContainer">
<div class="selectBtnDiv">
<div class="smallText"><a class="selectLink" href="#" onclick="SelectText(this.parentNode.parentNode.parentNode.children[2].children[0]); return false;">[select code]</a></div>
</div>
<div class="preDiv">
<pre>kdesudo kwrite /etc/torbrowser.d/50_user.conf</pre>
</div>
<div class="textareaDiv">
<textarea class="codeBoxArea" readonly="readonly" rows="1">kdesudo kwrite /etc/torbrowser.d/50_user.conf</textarea>
</div>
</div>
<p><u>If you are using a terminal-only Whonix</u>, run.
</p><div class="codeContainer">
<div class="selectBtnDiv">
<div class="smallText"><a class="selectLink" href="#" onclick="SelectText(this.parentNode.parentNode.parentNode.children[2].children[0]); return false;">[select code]</a></div>
</div>
<div class="preDiv">
<pre>sudo nano /etc/torbrowser.d/50_user.conf</pre>
</div>
<div class="textareaDiv">
<textarea class="codeBoxArea" readonly="readonly" rows="1">sudo nano /etc/torbrowser.d/50_user.conf</textarea>
</div>
</div>
</div>
<p>Paste. <sup class="reference" id="cite_ref-14"><a href="#cite_note-14">[14]</a></sup> <sup class="reference" id="cite_ref-15"><a href="#cite_note-15">[15]</a></sup>
</p><p></p><div class="codeContainer">
<div class="selectBtnDiv">
<div class="smallText"><a class="selectLink" href="#" onclick="SelectText(this.parentNode.parentNode.parentNode.children[2].children[0]); return false;">[select code]</a></div>
</div>
<div class="preDiv">
<pre>TB_NO_TOR_CON_CHECK=1
CURL_PROXY="--fail"</pre>
</div>
<div class="textareaDiv">
<textarea class="codeBoxArea" readonly="readonly" rows="1">TB_NO_TOR_CON_CHECK=1
CURL_PROXY="--fail"</textarea>
</div>
</div>
<p>Save.
</p>
</div>
<p>For some applications, this is impossible:
</p>
<ul><li><a data-href="/wiki/Sdwdate" href="../Sdwdate.html" title="Sdwdate">sdwdate</a></li>
<li>onionshare</li>
<li>Ricochet IM</li></ul>
<p><br/>
These applications can only talk to Tor <a data-href="/wiki/Onion_Services" href="../Onion_Services.html" title="Onion Services">Onion Services</a> directly and cannot be configured to use the system default. You can only deactivate sdwdate and/or not use Ricochet IM.
</p>
</div>
<h2><span class="mw-headline" id="uwt_wrapped_application_notes_2">uwt wrapped application notes</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Tunnels/Connecting_to_Tor_before_a_proxy&amp;action=edit&amp;section=13" href="https://www.whonix.org/w/index.php?title=Tunnels/Connecting_to_Tor_before_a_proxy&amp;action=edit&amp;section=13.html" title="Edit section: uwt wrapped application notes">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Whonix ships a list of applications pre-configured for using uwt wrappers by default. If the application you want to tunnel through the extra tunnel-link is on that list, it would conflict with your custom proxy settings. In that case, you need to disable that uwt wrapper first.
</p>
<div style="background: #F8F8F8; border: 2px; padding: 5px; margin: 10px; border-style: solid; border-color: black; width: 100%">
<p>On the <a data-href="/wiki/Stream_Isolation" href="../Stream_Isolation.html" title="Stream Isolation">Stream Isolation</a> page, there is a list of applications that are pre-configured to use <a data-href="/wiki/Stream_Isolation#By_uwt_wrapper" href="../Stream_Isolation.html" title="Stream Isolation">uwt wrappers</a>. Follow the instructions below in order to disable this.
</p>
<div style="background: #F8F8F8; border: 2px; padding: 5px; margin: 10px; border-style: solid; border-color: black; width: 100%">
<p>The following instructions permanently deactivate all uwt wrappers and remove stream isolation for <a data-href="/wiki/Stream_Isolation#By_uwt_wrapper" href="../Stream_Isolation.html" title="Stream Isolation">uwt wrapped applications</a> system-wide. Consequently, all uwt wrapped applications revert to the default system networking configuration.
</p><p>If you want more granular control of uwt wrapper deactivation, see <a data-href="/wiki/Stream_Isolation#Deactivate_uwt_Stream_Isolation_Wrapper" href="../Stream_Isolation.html" title="Stream Isolation">Stream_Isolation#Deactivate_uwt_Stream_Isolation_Wrapper</a>.
</p>
<div style="background: #F8F8F8; border: 2px; padding: 5px; margin: 10px; border-style: solid; border-color: black; width: 100%">
<p>Open <i><span style="background-color:#FBFBFB">/etc/uwt.d/50_user.conf</span></i> in an editor with root rights.
</p>
<div style="background: #F8F8F8; border: 2px; padding: 5px; margin: 10px; border-style: solid; border-color: black; width: 100%">
<p><u>If you are using a graphical Whonix or <a data-href="/wiki/Qubes" href="../Qubes.html" title="Qubes">Qubes-Whonix</a></u>, run.
</p><div class="codeContainer">
<div class="selectBtnDiv">
<div class="smallText"><a class="selectLink" href="#" onclick="SelectText(this.parentNode.parentNode.parentNode.children[2].children[0]); return false;">[select code]</a></div>
</div>
<div class="preDiv">
<pre>kdesudo kwrite /etc/uwt.d/50_user.conf</pre>
</div>
<div class="textareaDiv">
<textarea class="codeBoxArea" readonly="readonly" rows="1">kdesudo kwrite /etc/uwt.d/50_user.conf</textarea>
</div>
</div>
<p><u>If you are using a terminal-only Whonix</u>, run.
</p><div class="codeContainer">
<div class="selectBtnDiv">
<div class="smallText"><a class="selectLink" href="#" onclick="SelectText(this.parentNode.parentNode.parentNode.children[2].children[0]); return false;">[select code]</a></div>
</div>
<div class="preDiv">
<pre>sudo nano /etc/uwt.d/50_user.conf</pre>
</div>
<div class="textareaDiv">
<textarea class="codeBoxArea" readonly="readonly" rows="1">sudo nano /etc/uwt.d/50_user.conf</textarea>
</div>
</div>
</div>
<p>Add.
</p><p></p><div class="codeContainer">
<div class="selectBtnDiv">
<div class="smallText"><a class="selectLink" href="#" onclick="SelectText(this.parentNode.parentNode.parentNode.children[2].children[0]); return false;">[select code]</a></div>
</div>
<div class="preDiv">
<pre>uwtwrapper_global="0"</pre>
</div>
<div class="textareaDiv">
<textarea class="codeBoxArea" readonly="readonly" rows="1">uwtwrapper_global="0"</textarea>
</div>
</div>
<p>Save and exit.
</p>
</div>
</div>
</div>
<h2><span class="mw-headline" id="uwt">uwt</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Tunnels/Connecting_to_Tor_before_a_proxy&amp;action=edit&amp;section=14" href="https://www.whonix.org/w/index.php?title=Tunnels/Connecting_to_Tor_before_a_proxy&amp;action=edit&amp;section=14.html" title="Edit section: uwt">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<h3><span class="mw-headline" id="Introduction_3">Introduction</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Tunnels/Connecting_to_Tor_before_a_proxy&amp;action=edit&amp;section=15" href="https://www.whonix.org/w/index.php?title=Tunnels/Connecting_to_Tor_before_a_proxy&amp;action=edit&amp;section=15.html" title="Edit section: Introduction">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>uwt uses <i><span style="background-color:#FBFBFB">torsocks</span></i>. While the name <i>tor</i>socks implies it is Tor specific, it is not. You can point it to any socks proxy.
</p>
<h3><span class="mw-headline" id="uwt_wrapped_application_example">uwt wrapped application example</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Tunnels/Connecting_to_Tor_before_a_proxy&amp;action=edit&amp;section=16" href="https://www.whonix.org/w/index.php?title=Tunnels/Connecting_to_Tor_before_a_proxy&amp;action=edit&amp;section=16.html" title="Edit section: uwt wrapped application example">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p><code>
uwt -t 5 -i 10.152.152.10 -p 9153 /usr/bin/wget.anondist-orig -c <a class="external free" data-href="https://check.torproject.org" href="https://check.torproject.org" rel="noreferrer noopener" target="_blank">https://check.torproject.org</a>
</code>
</p>
<h3><span class="mw-headline" id="regular_application_example">regular application example</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Tunnels/Connecting_to_Tor_before_a_proxy&amp;action=edit&amp;section=17" href="https://www.whonix.org/w/index.php?title=Tunnels/Connecting_to_Tor_before_a_proxy&amp;action=edit&amp;section=17.html" title="Edit section: regular application example">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Requires <a data-href="/wiki/Stream_Isolation#Deactivate_uwt_Stream_Isolation_Wrapper" href="../Stream_Isolation.html" title="Stream Isolation">deactivated</a> wget uwt wrapper!
</p><p><code>
uwt -t 5 -i 10.152.152.10 -p 9156 /usr/bin/wget -c <a class="external free" data-href="https://check.torproject.org" href="https://check.torproject.org" rel="noreferrer noopener" target="_blank">https://check.torproject.org</a>
</code>
</p><p><sup class="reference" id="cite_ref-16"><a href="#cite_note-16">[16]</a></sup> <sup class="reference" id="cite_ref-17"><a href="#cite_note-17">[17]</a></sup> <sup class="reference" id="cite_ref-18"><a href="#cite_note-18">[18]</a></sup>
</p>
<h3><span class="mw-headline" id="Tor_Browser_Example">Tor Browser Example</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Tunnels/Connecting_to_Tor_before_a_proxy&amp;action=edit&amp;section=18" href="https://www.whonix.org/w/index.php?title=Tunnels/Connecting_to_Tor_before_a_proxy&amp;action=edit&amp;section=18.html" title="Edit section: Tor Browser Example">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>(Untested! Please leave feedback if it worked for you!)
</p><p>First, you must remove Tor Browser proxy settings before you can combine it with a proxifier.
</p>
<div style="background: #F8F8F8; border: 2px; padding: 5px; margin: 10px; border-style: solid; border-color: black; width: 100%">
<p><b>Introduction</b><br/>
</p><p>This configuration causes Tor Browser to no longer use proxy settings. With no proxy, Tor Browser uses the (VM) system's default networking. This is identical to any other application inside the Whonix-Workstation that has not been explicitly configured to use Tor via socks proxy settings or a socksifier. This setting is also called transparent torification. <sup class="reference" id="cite_ref-19"><a href="#cite_note-19">[19]</a></sup>
</p><p>Note: This action will break both the <a data-href="/wiki/Stream_Isolation" href="../Stream_Isolation.html" title="Stream Isolation">Stream Isolation</a> for Tor Browser and <a class="external text" data-href="https://trac.torproject.org/projects/tor/ticket/3455" href="https://trac.torproject.org/projects/tor/ticket/3455" rel="noreferrer noopener" target="_blank">Tor Browser's tab isolation by socks user name</a>. This worsens the <a data-href="/wiki/Fingerprint#web_fingerprint" href="../Fingerprint.html" title="Fingerprint">web fingerprint</a> and causes the user to be <a data-href="/wiki/DoNot#Do_not_confuse_Anonymity_with_Pseudonymity." href="../DoNot.html" title="DoNot">pseudonymous, rather than anonymous</a>. To mitigate these risks, consider using <a data-href="/wiki/Advanced_Security_Guide#More_than_one_Tor_Browser_in_Whonix" href="../Advanced_Security_Guide.html" title="Advanced Security Guide">More than one Tor Browser in Whonix</a>, or better yet, <a data-href="/wiki/Multiple_Whonix-Workstations" href="../Multiple_Whonix-Workstations.html" title="Multiple Whonix-Workstations">Multiple Whonix-Workstations</a>.
</p><p>If these settings are changed, expect Tor Button to show a red sign and state "Tor Disabled" if a mouse is hovered over it.
</p><p>To enable transparent torification (no proxy setting), set the <code>TOR_TRANSPROXY=1</code> environment variable. There are several methods, but the <a href="#.2Fetc.2Fenvironment_Method">#/etc/environment Method</a> is the simplest one.
</p>
<div class="toccolours mw-collapsible mw-collapsed" style="width:800px">
<p>For other methods with finer granulated settings, please press on Expand on the right.
</p>
<div class="mw-collapsible-content">
<p>&lt;span id="<br/>od"&gt;
<b>Command Line Method</b><br/>
</p><p>Navigate to the Tor Browser folder.
</p><p></p><div class="codeContainer">
<div class="selectBtnDiv">
<div class="smallText"><a class="selectLink" href="#" onclick="SelectText(this.parentNode.parentNode.parentNode.children[2].children[0]); return false;">[select code]</a></div>
</div>
<div class="preDiv">
<pre>cd ~/tor-browser_en-US</pre>
</div>
<div class="textareaDiv">
<textarea class="codeBoxArea" readonly="readonly" rows="1">cd ~/tor-browser_en-US</textarea>
</div>
</div>
<p>Every time Tor Browser is started, run the following command to set the <code>TOR_TRANSPROXY=1</code> environment variable.
</p><p></p><div class="codeContainer">
<div class="selectBtnDiv">
<div class="smallText"><a class="selectLink" href="#" onclick="SelectText(this.parentNode.parentNode.parentNode.children[2].children[0]); return false;">[select code]</a></div>
</div>
<div class="preDiv">
<pre>TOR_TRANSPROXY=1 ./start-tor-browser.desktop</pre>
</div>
<div class="textareaDiv">
<textarea class="codeBoxArea" readonly="readonly" rows="1">TOR_TRANSPROXY=1 ./start-tor-browser.desktop</textarea>
</div>
</div>
<p><span id="start-tor-browser_Method"></span>
<b>start-tor-browser Method</b><br/>
</p><p>This only applies to a single instance of the Tor Browser folder that is configured. This method may not persist when Tor Browser is updated.
</p><p>Find and open <span style="border:1px dotted #005cb9">start-tor-browser</span> in the Tor Browser folder in an editor.
</p><p>This is most likely in <span style="border:1px dotted #005cb9">~/tor-browser_en-US/Browser/start-tor-browser</span> below <span style="border:1px dotted #005cb9">#!/usr/bin/env bash</span>.
</p><p>Set.
</p><p></p><div class="codeContainer">
<div class="selectBtnDiv">
<div class="smallText"><a class="selectLink" href="#" onclick="SelectText(this.parentNode.parentNode.parentNode.children[2].children[0]); return false;">[select code]</a></div>
</div>
<div class="preDiv">
<pre>export TOR_TRANSPROXY=1</pre>
</div>
<div class="textareaDiv">
<textarea class="codeBoxArea" readonly="readonly" rows="1">export TOR_TRANSPROXY=1</textarea>
</div>
</div>
</div>
</div>
<p><span id=".2Fetc.2Fenvironment_Method"></span>
<b>/etc/environment Method</b><br/>
</p><p>This will apply to the whole environment, including any possible custom locations of Tor Browser installation folders. <sup class="reference" id="cite_ref-20"><a href="#cite_note-20">[20]</a></sup>
</p><p>Open <i><span style="background-color:#FBFBFB">/etc/environment</span></i> in an editor with root rights.
</p>
<div style="background: #F8F8F8; border: 2px; padding: 5px; margin: 10px; border-style: solid; border-color: black; width: 100%">
<p><u>If you are using a graphical Whonix or <a data-href="/wiki/Qubes" href="../Qubes.html" title="Qubes">Qubes-Whonix</a></u>, run.
</p><div class="codeContainer">
<div class="selectBtnDiv">
<div class="smallText"><a class="selectLink" href="#" onclick="SelectText(this.parentNode.parentNode.parentNode.children[2].children[0]); return false;">[select code]</a></div>
</div>
<div class="preDiv">
<pre>kdesudo kwrite /etc/environment</pre>
</div>
<div class="textareaDiv">
<textarea class="codeBoxArea" readonly="readonly" rows="1">kdesudo kwrite /etc/environment</textarea>
</div>
</div>
<p><u>If you are using a terminal-only Whonix</u>, run.
</p><div class="codeContainer">
<div class="selectBtnDiv">
<div class="smallText"><a class="selectLink" href="#" onclick="SelectText(this.parentNode.parentNode.parentNode.children[2].children[0]); return false;">[select code]</a></div>
</div>
<div class="preDiv">
<pre>sudo nano /etc/environment</pre>
</div>
<div class="textareaDiv">
<textarea class="codeBoxArea" readonly="readonly" rows="1">sudo nano /etc/environment</textarea>
</div>
</div>
</div>
<p>Add the following line.
</p><p></p><div class="codeContainer">
<div class="selectBtnDiv">
<div class="smallText"><a class="selectLink" href="#" onclick="SelectText(this.parentNode.parentNode.parentNode.children[2].children[0]); return false;">[select code]</a></div>
</div>
<div class="preDiv">
<pre>TOR_TRANSPROXY=1</pre>
</div>
<div class="textareaDiv">
<textarea class="codeBoxArea" readonly="readonly" rows="1">TOR_TRANSPROXY=1</textarea>
</div>
</div>
<p>Save and reboot.
</p><p><b>Undo</b><br/>
</p><p>Reverting this change is undocumented. Simply unsetting that environment variable will not work due to Tor Browser limitations. The easiest way to undo this setting is to install a fresh instance of Tor Browser (please contribute to these instructions)!
</p><p><span id="Forget_about_Tor_Button.27s_Open_Network_Settings"></span>
<b>Ignore Tor Button's Open Network Settings</b><br/>
</p><p>Whonix has disabled the <code>Open Network Settings...</code> menu option in Tor Button. Read the footnote for further information. <sup class="reference" id="cite_ref-21"><a href="#cite_note-21">[21]</a></sup>
</p>
</div>
<p>Then try this command. (Untested! Please leave feedback if it worked for you!)
</p><p><code>
uwt -t 5 -i 10.152.152.10 -p 9153 ~/tor-browser_en-US/App/Firefox/firefox --profile ~/tor-browser_en-US/Data/profile
</code>
</p><p><sup class="reference" id="cite_ref-22"><a href="#cite_note-22">[22]</a></sup>
</p>
<h2><span class="mw-headline" id="proxychains">proxychains</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Tunnels/Connecting_to_Tor_before_a_proxy&amp;action=edit&amp;section=19" href="https://www.whonix.org/w/index.php?title=Tunnels/Connecting_to_Tor_before_a_proxy&amp;action=edit&amp;section=19.html" title="Edit section: proxychains">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<h3><span class="mw-headline" id="Warnings">Warnings</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Tunnels/Connecting_to_Tor_before_a_proxy&amp;action=edit&amp;section=20" href="https://www.whonix.org/w/index.php?title=Tunnels/Connecting_to_Tor_before_a_proxy&amp;action=edit&amp;section=20.html" title="Edit section: Warnings">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<ul><li>We don't know how well proxychains works. For example <code>torsocks has a IPv6 leak bug</code><sup class="reference" id="cite_ref-23"><a href="#cite_note-23">[23]</a></sup>. We don't know if proxychains forces everything through the proxies. Whonix only ensures, should their be leaks, they go only through Tor.</li>
<li>There are at least three different versions of proxychains. The old/original/unmaintained version on sourceforge.net and two forks on github. We don't know about that status of any of them and haven't heard of anyone looking if they do really work as expected. The two authors argue with each other and we weren't motivated to understand the conflict and to determine which version is better. However, any leaks not going through the proxy(chain) will go through Tor.</li></ul>
<h3><span class="mw-headline" id="Setup">Setup</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Tunnels/Connecting_to_Tor_before_a_proxy&amp;action=edit&amp;section=21" href="https://www.whonix.org/w/index.php?title=Tunnels/Connecting_to_Tor_before_a_proxy&amp;action=edit&amp;section=21.html" title="Edit section: Setup">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Install proxychains.
</p><p><code>
sudo apt-get install proxychains
</code>
</p><p>Open proxychains configuration file.
</p><p>Open <i><span style="background-color:#FBFBFB">/etc/proxychains.conf</span></i> in an editor with root rights.
</p>
<div style="background: #F8F8F8; border: 2px; padding: 5px; margin: 10px; border-style: solid; border-color: black; width: 100%">
<p><u>If you are using a graphical Whonix or <a data-href="/wiki/Qubes" href="../Qubes.html" title="Qubes">Qubes-Whonix</a></u>, run.
</p><div class="codeContainer">
<div class="selectBtnDiv">
<div class="smallText"><a class="selectLink" href="#" onclick="SelectText(this.parentNode.parentNode.parentNode.children[2].children[0]); return false;">[select code]</a></div>
</div>
<div class="preDiv">
<pre>kdesudo kwrite /etc/proxychains.conf</pre>
</div>
<div class="textareaDiv">
<textarea class="codeBoxArea" readonly="readonly" rows="1">kdesudo kwrite /etc/proxychains.conf</textarea>
</div>
</div>
<p><u>If you are using a terminal-only Whonix</u>, run.
</p><div class="codeContainer">
<div class="selectBtnDiv">
<div class="smallText"><a class="selectLink" href="#" onclick="SelectText(this.parentNode.parentNode.parentNode.children[2].children[0]); return false;">[select code]</a></div>
</div>
<div class="preDiv">
<pre>sudo nano /etc/proxychains.conf</pre>
</div>
<div class="textareaDiv">
<textarea class="codeBoxArea" readonly="readonly" rows="1">sudo nano /etc/proxychains.conf</textarea>
</div>
</div>
</div>
<p>Go to the bottom of the settings file. Comment out "<i><span style="background-color:#FBFBFB">socks4 127.0.0.1 9050</span></i>" and add for example "<i><span style="background-color:#FBFBFB">socks5 10.152.152.10 9152</span></i>" (for Tor stream isolation) or "<i><span style="background-color:#FBFBFB">socks5 ip port</span></i>" with an IP and port of your choice to set the proxy settings.
</p>
<pre>[ProxyList]
## add proxy here ...
## meanwhile
## defaults set to "tor"
#socks4 127.0.0.1 9050
socks5 10.152.152.10 9152
# socks5 x.x.x.x xxxx
</pre>
<p><sup class="reference" id="cite_ref-24"><a href="#cite_note-24">[24]</a></sup>
</p><p>Save the configuration file. Test afterwards.
</p>
<h3><span class="mw-headline" id="example_uwt_wrapped_application">example uwt wrapped application</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Tunnels/Connecting_to_Tor_before_a_proxy&amp;action=edit&amp;section=22" href="https://www.whonix.org/w/index.php?title=Tunnels/Connecting_to_Tor_before_a_proxy&amp;action=edit&amp;section=22.html" title="Edit section: example uwt wrapped application">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p><code>
proxychains /usr/bin/wget.anondist-orig <a class="external free" data-href="https://check.torproject.org" href="https://check.torproject.org" rel="noreferrer noopener" target="_blank">https://check.torproject.org</a>
</code>
</p><p><sup class="reference" id="cite_ref-25"><a href="#cite_note-25">[25]</a></sup>
</p>
<h3><span class="mw-headline" id="example_regular_application">example regular application</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Tunnels/Connecting_to_Tor_before_a_proxy&amp;action=edit&amp;section=23" href="https://www.whonix.org/w/index.php?title=Tunnels/Connecting_to_Tor_before_a_proxy&amp;action=edit&amp;section=23.html" title="Edit section: example regular application">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Requires <a data-href="/wiki/Stream_Isolation#Deactivate_uwt_Stream_Isolation_Wrapper" href="../Stream_Isolation.html" title="Stream Isolation">deactivated</a> wget uwt wrapper!
</p><p><code>
proxychains /usr/bin/wget <a class="external free" data-href="https://check.torproject.org" href="https://check.torproject.org" rel="noreferrer noopener" target="_blank">https://check.torproject.org</a>
</code>
</p>
<h3><span class="mw-headline" id="Tor_Browser_example_2">Tor Browser example</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Tunnels/Connecting_to_Tor_before_a_proxy&amp;action=edit&amp;section=24" href="https://www.whonix.org/w/index.php?title=Tunnels/Connecting_to_Tor_before_a_proxy&amp;action=edit&amp;section=24.html" title="Edit section: Tor Browser example">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>The combination of proxychains and Tor Browser does currently not work. Someone needs to <a data-href="/wiki/Contribute" href="../Contribute.html" title="Contribute">Contribute</a> by figuring this out. Otherwise this will not be possible for a very long time. <a class="external text" data-href="https://forums.whonix.org/t/proxychains-tor-help-needed" href="https://forums.whonix.org/t/proxychains-tor-help-needed" rel="noreferrer noopener" target="_blank">See forum discussion</a>.
</p><p>First, you must remove Tor Browser proxy settings before you can combine it with a proxifier.
</p>
<div style="background: #F8F8F8; border: 2px; padding: 5px; margin: 10px; border-style: solid; border-color: black; width: 100%">
<p><b>Introduction</b><br/>
</p><p>This configuration causes Tor Browser to no longer use proxy settings. With no proxy, Tor Browser uses the (VM) system's default networking. This is identical to any other application inside the Whonix-Workstation that has not been explicitly configured to use Tor via socks proxy settings or a socksifier. This setting is also called transparent torification. <sup class="reference" id="cite_ref-26"><a href="#cite_note-26">[26]</a></sup>
</p><p>Note: This action will break both the <a data-href="/wiki/Stream_Isolation" href="../Stream_Isolation.html" title="Stream Isolation">Stream Isolation</a> for Tor Browser and <a class="external text" data-href="https://trac.torproject.org/projects/tor/ticket/3455" href="https://trac.torproject.org/projects/tor/ticket/3455" rel="noreferrer noopener" target="_blank">Tor Browser's tab isolation by socks user name</a>. This worsens the <a data-href="/wiki/Fingerprint#web_fingerprint" href="../Fingerprint.html" title="Fingerprint">web fingerprint</a> and causes the user to be <a data-href="/wiki/DoNot#Do_not_confuse_Anonymity_with_Pseudonymity." href="../DoNot.html" title="DoNot">pseudonymous, rather than anonymous</a>. To mitigate these risks, consider using <a data-href="/wiki/Advanced_Security_Guide#More_than_one_Tor_Browser_in_Whonix" href="../Advanced_Security_Guide.html" title="Advanced Security Guide">More than one Tor Browser in Whonix</a>, or better yet, <a data-href="/wiki/Multiple_Whonix-Workstations" href="../Multiple_Whonix-Workstations.html" title="Multiple Whonix-Workstations">Multiple Whonix-Workstations</a>.
</p><p>If these settings are changed, expect Tor Button to show a red sign and state "Tor Disabled" if a mouse is hovered over it.
</p><p>To enable transparent torification (no proxy setting), set the <code>TOR_TRANSPROXY=1</code> environment variable. There are several methods, but the <a href="#.2Fetc.2Fenvironment_Method">#/etc/environment Method</a> is the simplest one.
</p>
<div class="toccolours mw-collapsible mw-collapsed" style="width:800px">
<p>For other methods with finer granulated settings, please press on Expand on the right.
</p>
<div class="mw-collapsible-content">
<p>&lt;span id="<br/>od"&gt;
<b>Command Line Method</b><br/>
</p><p>Navigate to the Tor Browser folder.
</p><p></p><div class="codeContainer">
<div class="selectBtnDiv">
<div class="smallText"><a class="selectLink" href="#" onclick="SelectText(this.parentNode.parentNode.parentNode.children[2].children[0]); return false;">[select code]</a></div>
</div>
<div class="preDiv">
<pre>cd ~/tor-browser_en-US</pre>
</div>
<div class="textareaDiv">
<textarea class="codeBoxArea" readonly="readonly" rows="1">cd ~/tor-browser_en-US</textarea>
</div>
</div>
<p>Every time Tor Browser is started, run the following command to set the <code>TOR_TRANSPROXY=1</code> environment variable.
</p><p></p><div class="codeContainer">
<div class="selectBtnDiv">
<div class="smallText"><a class="selectLink" href="#" onclick="SelectText(this.parentNode.parentNode.parentNode.children[2].children[0]); return false;">[select code]</a></div>
</div>
<div class="preDiv">
<pre>TOR_TRANSPROXY=1 ./start-tor-browser.desktop</pre>
</div>
<div class="textareaDiv">
<textarea class="codeBoxArea" readonly="readonly" rows="1">TOR_TRANSPROXY=1 ./start-tor-browser.desktop</textarea>
</div>
</div>
<p><span id="start-tor-browser_Method"></span>
<b>start-tor-browser Method</b><br/>
</p><p>This only applies to a single instance of the Tor Browser folder that is configured. This method may not persist when Tor Browser is updated.
</p><p>Find and open <span style="border:1px dotted #005cb9">start-tor-browser</span> in the Tor Browser folder in an editor.
</p><p>This is most likely in <span style="border:1px dotted #005cb9">~/tor-browser_en-US/Browser/start-tor-browser</span> below <span style="border:1px dotted #005cb9">#!/usr/bin/env bash</span>.
</p><p>Set.
</p><p></p><div class="codeContainer">
<div class="selectBtnDiv">
<div class="smallText"><a class="selectLink" href="#" onclick="SelectText(this.parentNode.parentNode.parentNode.children[2].children[0]); return false;">[select code]</a></div>
</div>
<div class="preDiv">
<pre>export TOR_TRANSPROXY=1</pre>
</div>
<div class="textareaDiv">
<textarea class="codeBoxArea" readonly="readonly" rows="1">export TOR_TRANSPROXY=1</textarea>
</div>
</div>
</div>
</div>
<p><span id=".2Fetc.2Fenvironment_Method"></span>
<b>/etc/environment Method</b><br/>
</p><p>This will apply to the whole environment, including any possible custom locations of Tor Browser installation folders. <sup class="reference" id="cite_ref-27"><a href="#cite_note-27">[27]</a></sup>
</p><p>Open <i><span style="background-color:#FBFBFB">/etc/environment</span></i> in an editor with root rights.
</p>
<div style="background: #F8F8F8; border: 2px; padding: 5px; margin: 10px; border-style: solid; border-color: black; width: 100%">
<p><u>If you are using a graphical Whonix or <a data-href="/wiki/Qubes" href="../Qubes.html" title="Qubes">Qubes-Whonix</a></u>, run.
</p><div class="codeContainer">
<div class="selectBtnDiv">
<div class="smallText"><a class="selectLink" href="#" onclick="SelectText(this.parentNode.parentNode.parentNode.children[2].children[0]); return false;">[select code]</a></div>
</div>
<div class="preDiv">
<pre>kdesudo kwrite /etc/environment</pre>
</div>
<div class="textareaDiv">
<textarea class="codeBoxArea" readonly="readonly" rows="1">kdesudo kwrite /etc/environment</textarea>
</div>
</div>
<p><u>If you are using a terminal-only Whonix</u>, run.
</p><div class="codeContainer">
<div class="selectBtnDiv">
<div class="smallText"><a class="selectLink" href="#" onclick="SelectText(this.parentNode.parentNode.parentNode.children[2].children[0]); return false;">[select code]</a></div>
</div>
<div class="preDiv">
<pre>sudo nano /etc/environment</pre>
</div>
<div class="textareaDiv">
<textarea class="codeBoxArea" readonly="readonly" rows="1">sudo nano /etc/environment</textarea>
</div>
</div>
</div>
<p>Add the following line.
</p><p></p><div class="codeContainer">
<div class="selectBtnDiv">
<div class="smallText"><a class="selectLink" href="#" onclick="SelectText(this.parentNode.parentNode.parentNode.children[2].children[0]); return false;">[select code]</a></div>
</div>
<div class="preDiv">
<pre>TOR_TRANSPROXY=1</pre>
</div>
<div class="textareaDiv">
<textarea class="codeBoxArea" readonly="readonly" rows="1">TOR_TRANSPROXY=1</textarea>
</div>
</div>
<p>Save and reboot.
</p><p><b>Undo</b><br/>
</p><p>Reverting this change is undocumented. Simply unsetting that environment variable will not work due to Tor Browser limitations. The easiest way to undo this setting is to install a fresh instance of Tor Browser (please contribute to these instructions)!
</p><p><span id="Forget_about_Tor_Button.27s_Open_Network_Settings"></span>
<b>Ignore Tor Button's Open Network Settings</b><br/>
</p><p>Whonix has disabled the <code>Open Network Settings...</code> menu option in Tor Button. Read the footnote for further information. <sup class="reference" id="cite_ref-28"><a href="#cite_note-28">[28]</a></sup>
</p>
</div>
<p>Then try this command.
</p><p><code>
proxychains ~/tor-browser_en-US/start-tor-browser
</code>
</p><p>Might be also interesting:
</p>
<ul><li><a data-href="/wiki/Advanced_Security_Guide#More_than_one_Tor_Browser_in_Whonix" href="../Advanced_Security_Guide.html" title="Advanced Security Guide">Advanced Security Guide#More than one Tor Browser in Whonix</a></li></ul>
<hr/>
<h1><span class="mw-headline" id="Transparent_Proxying_Method">Transparent Proxying  Method</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Tunnels/Connecting_to_Tor_before_a_proxy&amp;action=edit&amp;section=25" href="https://www.whonix.org/w/index.php?title=Tunnels/Connecting_to_Tor_before_a_proxy&amp;action=edit&amp;section=25.html" title="Edit section: Transparent Proxying Method">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<h2><span class="mw-headline" id="Introduction_4">Introduction</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Tunnels/Connecting_to_Tor_before_a_proxy&amp;action=edit&amp;section=26" href="https://www.whonix.org/w/index.php?title=Tunnels/Connecting_to_Tor_before_a_proxy&amp;action=edit&amp;section=26.html" title="Edit section: Introduction">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p><b>Advanced users only!</b>
</p><p>To make clear, what this is about. Whonix-Gateway is already serving as a Transparent Proxy <sup class="reference" id="cite_ref-29"><a href="#cite_note-29">[29]</a></sup>, which means, that all applications not explicitly configured <sup class="reference" id="cite_ref-30"><a href="#cite_note-30">[30]</a></sup> to use a SocksPort, can connect through Tor without any settings. This section is about configuring Whonix-Workstation also to act as a Transparent Proxy <sup class="reference" id="cite_ref-31"><a href="#cite_note-31">[31]</a></sup>. Use case: a user wants to ensure all traffic goes through Tor (by using Whonix-Gateway) and want to additionally ensure, all traffic goes through a proxy choosen by the user after the Tor link, i.e. user -&gt; Tor -&gt; proxy -&gt; internet.
</p><p><sup class="reference" id="cite_ref-32"><a href="#cite_note-32">[32]</a></sup>
</p><p>You always have to keep in mind, which kind of data and which kind of proxy you are using. There are CGIproxies, http(s) proxies and socks4/4a/5 proxies.
</p><p>In case you redirect the network layer directly with iptables, you need a TransPort. Unfortunately very few applications, do offer a TransPort. For example, Tor supports a TransPort. In most other cases, you need to translate the different kinds of data.
</p><p>Due to the nature of Transparent Proxying, we need to redirect with iptables and end up with a "Trans data stream". Because most proxies are either http or socks we need to translate this. Below we discuss a few tools which help here, not all are required, depending on what you want to do.
</p><p>Required reading:
</p>
<ul><li><a data-href="/wiki/Comparison_Of_Tor_with_CGI_Proxies,_Proxy_Chains,_and_VPN_Services" href="../Comparison_Of_Tor_with_CGI_Proxies,_Proxy_Chains,_and_VPN_Services.html" title="Comparison Of Tor with CGI Proxies, Proxy Chains, and VPN Services">Comparison Of Tor with CGI Proxies, Proxy Chains, and VPN Services</a></li>
<li><a class="external text" data-href="https://trac.torproject.org/projects/tor/wiki/doc/TorPlusVPN" href="https://trac.torproject.org/projects/tor/wiki/doc/TorPlusVPN" rel="noreferrer noopener" target="_blank">Tor Plus VPN or proxy</a></li></ul>
<h2><span class="mw-headline" id="Tools">Tools</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Tunnels/Connecting_to_Tor_before_a_proxy&amp;action=edit&amp;section=27" href="https://www.whonix.org/w/index.php?title=Tunnels/Connecting_to_Tor_before_a_proxy&amp;action=edit&amp;section=27.html" title="Edit section: Tools">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Tor is a socks proxy and also has a TransPort. Unfortunately, Tor can not be directly used as a http proxy. You must also keep in mind, that Tor does not support UDP, although it offers a DnsPort.
</p><p><a class="external text" data-href="http://darkk.net.ru/redsocks/" href="http://darkk.net.ru/redsocks/" rel="noreferrer noopener" target="_blank">redsocks</a> can also accept "Trans data streams" and can forward them to http<b>s</b>, socks4 and socks5 proxies. If you were to use a http proxy (no https, without connect-method, see <a data-href="/wiki/Comparison_Of_Tor_with_CGI_Proxies,_Proxy_Chains,_and_VPN_Services" href="../Comparison_Of_Tor_with_CGI_Proxies,_Proxy_Chains,_and_VPN_Services.html" title="Comparison Of Tor with CGI Proxies, Proxy Chains, and VPN Services">proxy article</a>), you could access only http sites, no https sites. Rather redsocks can convert UDP DNS queries to TCP DNS queries.
</p>
<h2><span class="mw-headline" id="DNS_resolution">DNS resolution</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Tunnels/Connecting_to_Tor_before_a_proxy&amp;action=edit&amp;section=28" href="https://www.whonix.org/w/index.php?title=Tunnels/Connecting_to_Tor_before_a_proxy&amp;action=edit&amp;section=28.html" title="Edit section: DNS resolution">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>The complication (and also advantage/feature) with transparent proxying is, that the internet application (browser, etc.) is not aware of the proxy. Therefore the internet application will attempt to do the DNS resolution itself using the system, not using the proxy. The DNS requests also must be considered. Since Tor does not support UDP, we have to transmit DNS queries via TCP.
</p><p>It is impossible to resolve DNS directly on the proxy, when using the proxy as a transparent proxy, see <a data-href="/wiki/Dev/Inspiration#Transparent_Proxying_Method" href="../Dev/Inspiration.html" title="Dev/Inspiration">Transparent Proxying Method</a> for explanation. You need an extra DNS server, which answers over TCP.
</p><p>You have several options to resolve DNS.
</p><p>Either leave the setup as it is, Tor's DnsPort and therefore the Tor exit relays will still do the DNS requests. (See DNS rule #1.) This is probably not what you want, since you wanted to cloak your identity with an additional proxy after Tor.
</p><p>Alternatively you can use a public DNS resolver. The instructions for <a data-href="/wiki/Secondary_DNS_Resolver#DNSCrypt_by_OpenDNS" href="../Secondary_DNS_Resolver.html" title="Secondary DNS Resolver">Secondary DNS Resolver#DNSCrypt by OpenDNS</a> should work out of the box (tested). (See DNS rule #2.) 
</p><p>All DNS resolvers <sup class="reference" id="cite_ref-33"><a href="#cite_note-33">[33]</a></sup> should work, as long TCP is supported and as long you are querying a TCP enabled DNS server. <sup class="reference" id="cite_ref-34"><a href="#cite_note-34">[34]</a></sup> <sup class="reference" id="cite_ref-35"><a href="#cite_note-35">[35]</a></sup> <sup class="reference" id="cite_ref-36"><a href="#cite_note-36">[36]</a></sup> <sup class="reference" id="cite_ref-37"><a href="#cite_note-37">[37]</a></sup>
</p><p>Read the <a data-href="/wiki/Secondary_DNS_Resolver" href="../Secondary_DNS_Resolver.html" title="Secondary DNS Resolver">DNS related warnings</a>.
</p>
<h2><span class="mw-headline" id="Prevent_Bypassing_the_Tunnel-Link">Prevent Bypassing the Tunnel-Link</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Tunnels/Connecting_to_Tor_before_a_proxy&amp;action=edit&amp;section=29" href="https://www.whonix.org/w/index.php?title=Tunnels/Connecting_to_Tor_before_a_proxy&amp;action=edit&amp;section=29.html" title="Edit section: Prevent Bypassing the Tunnel-Link">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<table class="metadata plainlinks ambox ambox-notice" style="">
<tbody><tr><td class="mbox-image"><div style="width: 52px;"><a class="image" data-href="/w/index.php?title=File:Ambox_warning_pn.svg.png&amp;filetimestamp=20130717200816&amp;" href="https://www.whonix.org/w/index.php?title=File:Ambox_warning_pn.svg.png&amp;filetimestamp=20130717200816&amp;"><img alt="Ambox warning pn.svg.png" data-src="/w/images/thumb/f/f7/Ambox_warning_pn.svg.png/40px-Ambox_warning_pn.svg.png" data-srcset="/w/images/thumb/f/f7/Ambox_warning_pn.svg.png/60px-Ambox_warning_pn.svg.png 1.5x, /w/images/thumb/f/f7/Ambox_warning_pn.svg.png/80px-Ambox_warning_pn.svg.png 2x" height="35" src="data:image/png;base64,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" width="40"/></a></div></td><td class="mbox-text" style=""><span class="mbox-text-span">Apply the following steps to avoid unexpected results such as broken connectivity and/or traffic bypassing the tunnel-link and only going through Tor. 
<p><br/>
</p>
<a class="mw-redirect" data-href="/wiki/Qubes-Whonix" href="../Qubes-Whonix.html" title="Qubes-Whonix">Qubes-Whonix</a> exception: There is one tunnel configuration where Qubes-Whonix users are better placed. When a separate tunnel-link VM is used between anon-whonix and sys-whonix (<code>anon-whonix</code> -&gt; <code>Tunnel-link</code> -&gt; <code>sys-whonix</code>), these connections simply fail without the following modifications.<span class="hide-when-compact"> </span><span class="hide-when-compact"> </span></span></td></tr></tbody></table>
<div style="background: #F8F8F8; border: 2px; padding: 5px; margin: 10px; border-style: solid; border-color: black; width: 100%">
<p><b>Introduction</b><br/>
Disabling stream isolation will prevent bypassing of the tunnel-link. By default, many pre-installed applications are configured for <a data-href="/wiki/Stream_Isolation" href="../Stream_Isolation.html" title="Stream Isolation">Stream Isolation</a> in Whonix. These specific applications are configured to use Tor SocksPorts, instead of Tor's TransPort.
</p><p>All applications which are configured to use Tor SocksPorts are not tunneled through the tunnel-link, but instead they are "only" tunneled through Tor. The reason is the following configuration does not touch local connections to <i><span style="background-color:#FBFBFB">10.152.152.10</span></i>, which is the Whonix-Gateway. Therefore, if for example you wish to tunnel Tor Browser via the route <code>User</code> -&gt; <code>Tor</code> -&gt; <code>Tunnel-link</code> -&gt; <code>Internet</code>, all proxy settings from <a data-href="/wiki/Tor_Browser" href="../Tor_Browser.html" title="Tor Browser">Tor Browser</a> need to be removed. See below for instructions.
</p><p><b>Deactivate uwt Wrappers</b><br/>
</p>
<div style="background: #F8F8F8; border: 2px; padding: 5px; margin: 10px; border-style: solid; border-color: black; width: 100%">
<p>The following instructions permanently deactivate all uwt wrappers and remove stream isolation for <a data-href="/wiki/Stream_Isolation#By_uwt_wrapper" href="../Stream_Isolation.html" title="Stream Isolation">uwt wrapped applications</a> system-wide. Consequently, all uwt wrapped applications revert to the default system networking configuration.
</p><p>If you want more granular control of uwt wrapper deactivation, see <a data-href="/wiki/Stream_Isolation#Deactivate_uwt_Stream_Isolation_Wrapper" href="../Stream_Isolation.html" title="Stream Isolation">Stream_Isolation#Deactivate_uwt_Stream_Isolation_Wrapper</a>.
</p>
<div style="background: #F8F8F8; border: 2px; padding: 5px; margin: 10px; border-style: solid; border-color: black; width: 100%">
<p>Open <i><span style="background-color:#FBFBFB">/etc/uwt.d/50_user.conf</span></i> in an editor with root rights.
</p>
<div style="background: #F8F8F8; border: 2px; padding: 5px; margin: 10px; border-style: solid; border-color: black; width: 100%">
<p><u>If you are using a graphical Whonix or <a data-href="/wiki/Qubes" href="../Qubes.html" title="Qubes">Qubes-Whonix</a></u>, run.
</p><div class="codeContainer">
<div class="selectBtnDiv">
<div class="smallText"><a class="selectLink" href="#" onclick="SelectText(this.parentNode.parentNode.parentNode.children[2].children[0]); return false;">[select code]</a></div>
</div>
<div class="preDiv">
<pre>kdesudo kwrite /etc/uwt.d/50_user.conf</pre>
</div>
<div class="textareaDiv">
<textarea class="codeBoxArea" readonly="readonly" rows="1">kdesudo kwrite /etc/uwt.d/50_user.conf</textarea>
</div>
</div>
<p><u>If you are using a terminal-only Whonix</u>, run.
</p><div class="codeContainer">
<div class="selectBtnDiv">
<div class="smallText"><a class="selectLink" href="#" onclick="SelectText(this.parentNode.parentNode.parentNode.children[2].children[0]); return false;">[select code]</a></div>
</div>
<div class="preDiv">
<pre>sudo nano /etc/uwt.d/50_user.conf</pre>
</div>
<div class="textareaDiv">
<textarea class="codeBoxArea" readonly="readonly" rows="1">sudo nano /etc/uwt.d/50_user.conf</textarea>
</div>
</div>
</div>
<p>Add.
</p><p></p><div class="codeContainer">
<div class="selectBtnDiv">
<div class="smallText"><a class="selectLink" href="#" onclick="SelectText(this.parentNode.parentNode.parentNode.children[2].children[0]); return false;">[select code]</a></div>
</div>
<div class="preDiv">
<pre>uwtwrapper_global="0"</pre>
</div>
<div class="textareaDiv">
<textarea class="codeBoxArea" readonly="readonly" rows="1">uwtwrapper_global="0"</textarea>
</div>
</div>
<p>Save and exit.
</p>
</div>
</div>
<hr/>
<p><b>Tor Browser Remove Proxy Settings</b><br/>
</p>
<div style="background: #F8F8F8; border: 2px; padding: 5px; margin: 10px; border-style: solid; border-color: black; width: 100%">
<p><b>Introduction</b><br/>
</p><p>This configuration causes Tor Browser to no longer use proxy settings. With no proxy, Tor Browser uses the (VM) system's default networking. This is identical to any other application inside the Whonix-Workstation that has not been explicitly configured to use Tor via socks proxy settings or a socksifier. This setting is also called transparent torification. <sup class="reference" id="cite_ref-38"><a href="#cite_note-38">[38]</a></sup>
</p><p>Note: This action will break both the <a data-href="/wiki/Stream_Isolation" href="../Stream_Isolation.html" title="Stream Isolation">Stream Isolation</a> for Tor Browser and <a class="external text" data-href="https://trac.torproject.org/projects/tor/ticket/3455" href="https://trac.torproject.org/projects/tor/ticket/3455" rel="noreferrer noopener" target="_blank">Tor Browser's tab isolation by socks user name</a>. This worsens the <a data-href="/wiki/Fingerprint#web_fingerprint" href="../Fingerprint.html" title="Fingerprint">web fingerprint</a> and causes the user to be <a data-href="/wiki/DoNot#Do_not_confuse_Anonymity_with_Pseudonymity." href="../DoNot.html" title="DoNot">pseudonymous, rather than anonymous</a>. To mitigate these risks, consider using <a data-href="/wiki/Advanced_Security_Guide#More_than_one_Tor_Browser_in_Whonix" href="../Advanced_Security_Guide.html" title="Advanced Security Guide">More than one Tor Browser in Whonix</a>, or better yet, <a data-href="/wiki/Multiple_Whonix-Workstations" href="../Multiple_Whonix-Workstations.html" title="Multiple Whonix-Workstations">Multiple Whonix-Workstations</a>.
</p><p>If these settings are changed, expect Tor Button to show a red sign and state "Tor Disabled" if a mouse is hovered over it.
</p><p>To enable transparent torification (no proxy setting), set the <code>TOR_TRANSPROXY=1</code> environment variable. There are several methods, but the <a href="#.2Fetc.2Fenvironment_Method">#/etc/environment Method</a> is the simplest one.
</p>
<div class="toccolours mw-collapsible mw-collapsed" style="width:800px">
<p>For other methods with finer granulated settings, please press on Expand on the right.
</p>
<div class="mw-collapsible-content">
<p>&lt;span id="<br/>od"&gt;
<b>Command Line Method</b><br/>
</p><p>Navigate to the Tor Browser folder.
</p><p></p><div class="codeContainer">
<div class="selectBtnDiv">
<div class="smallText"><a class="selectLink" href="#" onclick="SelectText(this.parentNode.parentNode.parentNode.children[2].children[0]); return false;">[select code]</a></div>
</div>
<div class="preDiv">
<pre>cd ~/tor-browser_en-US</pre>
</div>
<div class="textareaDiv">
<textarea class="codeBoxArea" readonly="readonly" rows="1">cd ~/tor-browser_en-US</textarea>
</div>
</div>
<p>Every time Tor Browser is started, run the following command to set the <code>TOR_TRANSPROXY=1</code> environment variable.
</p><p></p><div class="codeContainer">
<div class="selectBtnDiv">
<div class="smallText"><a class="selectLink" href="#" onclick="SelectText(this.parentNode.parentNode.parentNode.children[2].children[0]); return false;">[select code]</a></div>
</div>
<div class="preDiv">
<pre>TOR_TRANSPROXY=1 ./start-tor-browser.desktop</pre>
</div>
<div class="textareaDiv">
<textarea class="codeBoxArea" readonly="readonly" rows="1">TOR_TRANSPROXY=1 ./start-tor-browser.desktop</textarea>
</div>
</div>
<p><span id="start-tor-browser_Method"></span>
<b>start-tor-browser Method</b><br/>
</p><p>This only applies to a single instance of the Tor Browser folder that is configured. This method may not persist when Tor Browser is updated.
</p><p>Find and open <span style="border:1px dotted #005cb9">start-tor-browser</span> in the Tor Browser folder in an editor.
</p><p>This is most likely in <span style="border:1px dotted #005cb9">~/tor-browser_en-US/Browser/start-tor-browser</span> below <span style="border:1px dotted #005cb9">#!/usr/bin/env bash</span>.
</p><p>Set.
</p><p></p><div class="codeContainer">
<div class="selectBtnDiv">
<div class="smallText"><a class="selectLink" href="#" onclick="SelectText(this.parentNode.parentNode.parentNode.children[2].children[0]); return false;">[select code]</a></div>
</div>
<div class="preDiv">
<pre>export TOR_TRANSPROXY=1</pre>
</div>
<div class="textareaDiv">
<textarea class="codeBoxArea" readonly="readonly" rows="1">export TOR_TRANSPROXY=1</textarea>
</div>
</div>
</div>
</div>
<p><span id=".2Fetc.2Fenvironment_Method"></span>
<b>/etc/environment Method</b><br/>
</p><p>This will apply to the whole environment, including any possible custom locations of Tor Browser installation folders. <sup class="reference" id="cite_ref-39"><a href="#cite_note-39">[39]</a></sup>
</p><p>Open <i><span style="background-color:#FBFBFB">/etc/environment</span></i> in an editor with root rights.
</p>
<div style="background: #F8F8F8; border: 2px; padding: 5px; margin: 10px; border-style: solid; border-color: black; width: 100%">
<p><u>If you are using a graphical Whonix or <a data-href="/wiki/Qubes" href="../Qubes.html" title="Qubes">Qubes-Whonix</a></u>, run.
</p><div class="codeContainer">
<div class="selectBtnDiv">
<div class="smallText"><a class="selectLink" href="#" onclick="SelectText(this.parentNode.parentNode.parentNode.children[2].children[0]); return false;">[select code]</a></div>
</div>
<div class="preDiv">
<pre>kdesudo kwrite /etc/environment</pre>
</div>
<div class="textareaDiv">
<textarea class="codeBoxArea" readonly="readonly" rows="1">kdesudo kwrite /etc/environment</textarea>
</div>
</div>
<p><u>If you are using a terminal-only Whonix</u>, run.
</p><div class="codeContainer">
<div class="selectBtnDiv">
<div class="smallText"><a class="selectLink" href="#" onclick="SelectText(this.parentNode.parentNode.parentNode.children[2].children[0]); return false;">[select code]</a></div>
</div>
<div class="preDiv">
<pre>sudo nano /etc/environment</pre>
</div>
<div class="textareaDiv">
<textarea class="codeBoxArea" readonly="readonly" rows="1">sudo nano /etc/environment</textarea>
</div>
</div>
</div>
<p>Add the following line.
</p><p></p><div class="codeContainer">
<div class="selectBtnDiv">
<div class="smallText"><a class="selectLink" href="#" onclick="SelectText(this.parentNode.parentNode.parentNode.children[2].children[0]); return false;">[select code]</a></div>
</div>
<div class="preDiv">
<pre>TOR_TRANSPROXY=1</pre>
</div>
<div class="textareaDiv">
<textarea class="codeBoxArea" readonly="readonly" rows="1">TOR_TRANSPROXY=1</textarea>
</div>
</div>
<p>Save and reboot.
</p><p><b>Undo</b><br/>
</p><p>Reverting this change is undocumented. Simply unsetting that environment variable will not work due to Tor Browser limitations. The easiest way to undo this setting is to install a fresh instance of Tor Browser (please contribute to these instructions)!
</p><p><span id="Forget_about_Tor_Button.27s_Open_Network_Settings"></span>
<b>Ignore Tor Button's Open Network Settings</b><br/>
</p><p>Whonix has disabled the <code>Open Network Settings...</code> menu option in Tor Button. Read the footnote for further information. <sup class="reference" id="cite_ref-40"><a href="#cite_note-40">[40]</a></sup>
</p>
</div>
<hr/>
<p><b>Deactivate Miscellaneous Proxy Settings</b><br/>
</p>
<div style="background: #F8F8F8; border: 2px; padding: 5px; margin: 10px; border-style: solid; border-color: black; width: 100%">
<p>On the <a data-href="/wiki/Stream_Isolation" href="../Stream_Isolation.html" title="Stream Isolation">Stream Isolation</a> page, there is a list of applications that are pre-configured to use <a data-href="/wiki/Stream_Isolation#By_Settings" href="../Stream_Isolation.html" title="Stream Isolation">socks proxy settings</a> via application configuration files. To disable this, the Whonix system default must be removed from the application's settings.
</p><p>TODO: document and expand.
</p>
<div style="background: #F8F8F8; border: 2px; padding: 5px; margin: 10px; border-style: solid; border-color: black; width: 100%">
<p>Remove proxy settings for <a data-href="/wiki/Tor_Browser#Tor_Browser_Downloader_by_Whonix" href="../Tor_Browser.html" title="Tor Browser">Tor Browser Downloader by Whonix</a>.
</p><p>Open <i><span style="background-color:#FBFBFB">/etc/torbrowser.d/50_user.conf</span></i> in an editor with root rights.
</p>
<div style="background: #F8F8F8; border: 2px; padding: 5px; margin: 10px; border-style: solid; border-color: black; width: 100%">
<p><u>If you are using a graphical Whonix or <a data-href="/wiki/Qubes" href="../Qubes.html" title="Qubes">Qubes-Whonix</a></u>, run.
</p><div class="codeContainer">
<div class="selectBtnDiv">
<div class="smallText"><a class="selectLink" href="#" onclick="SelectText(this.parentNode.parentNode.parentNode.children[2].children[0]); return false;">[select code]</a></div>
</div>
<div class="preDiv">
<pre>kdesudo kwrite /etc/torbrowser.d/50_user.conf</pre>
</div>
<div class="textareaDiv">
<textarea class="codeBoxArea" readonly="readonly" rows="1">kdesudo kwrite /etc/torbrowser.d/50_user.conf</textarea>
</div>
</div>
<p><u>If you are using a terminal-only Whonix</u>, run.
</p><div class="codeContainer">
<div class="selectBtnDiv">
<div class="smallText"><a class="selectLink" href="#" onclick="SelectText(this.parentNode.parentNode.parentNode.children[2].children[0]); return false;">[select code]</a></div>
</div>
<div class="preDiv">
<pre>sudo nano /etc/torbrowser.d/50_user.conf</pre>
</div>
<div class="textareaDiv">
<textarea class="codeBoxArea" readonly="readonly" rows="1">sudo nano /etc/torbrowser.d/50_user.conf</textarea>
</div>
</div>
</div>
<p>Paste. <sup class="reference" id="cite_ref-41"><a href="#cite_note-41">[41]</a></sup> <sup class="reference" id="cite_ref-42"><a href="#cite_note-42">[42]</a></sup>
</p><p></p><div class="codeContainer">
<div class="selectBtnDiv">
<div class="smallText"><a class="selectLink" href="#" onclick="SelectText(this.parentNode.parentNode.parentNode.children[2].children[0]); return false;">[select code]</a></div>
</div>
<div class="preDiv">
<pre>TB_NO_TOR_CON_CHECK=1
CURL_PROXY="--fail"</pre>
</div>
<div class="textareaDiv">
<textarea class="codeBoxArea" readonly="readonly" rows="1">TB_NO_TOR_CON_CHECK=1
CURL_PROXY="--fail"</textarea>
</div>
</div>
<p>Save.
</p>
</div>
<p>For some applications, this is impossible:
</p>
<ul><li><a data-href="/wiki/Sdwdate" href="../Sdwdate.html" title="Sdwdate">sdwdate</a></li>
<li>onionshare</li>
<li>Ricochet IM</li></ul>
<p><br/>
These applications can only talk to Tor <a data-href="/wiki/Onion_Services" href="../Onion_Services.html" title="Onion Services">Onion Services</a> directly and cannot be configured to use the system default. You can only deactivate sdwdate and/or not use Ricochet IM.
</p>
</div>
</div>
<h2><span id="How_to_setup_proxy_tunnel-link_after_Tor_(User-&gt;Tor-&gt;Proxy-&gt;Internet)"></span><span class="mw-headline" id="How_to_setup_proxy_tunnel-link_after_Tor_.28User-.3ETor-.3EProxy-.3EInternet.29">How to setup proxy tunnel-link after Tor (User-&gt;Tor-&gt;Proxy-&gt;Internet)</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Tunnels/Connecting_to_Tor_before_a_proxy&amp;action=edit&amp;section=30" href="https://www.whonix.org/w/index.php?title=Tunnels/Connecting_to_Tor_before_a_proxy&amp;action=edit&amp;section=30.html" title="Edit section: How to setup proxy tunnel-link after Tor (User-&gt;Tor-&gt;Proxy-&gt;Internet)">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p><b>Unfinished!</b> <br/>
<b>Advanced users only!</b>
</p><p><b>Everything on Whonix-Workstation.</b>
</p><p>Get a working proxy and test (with any of the above methods) if it works reliable.
</p><p>Install redsocks.
</p><p><code>
sudo apt-get install redsocks
</code>
</p><p>Enable redsocks autostart.
</p><p>Open <i><span style="background-color:#FBFBFB">/etc/default/redsocks</span></i> in an editor with root rights.
</p>
<div style="background: #F8F8F8; border: 2px; padding: 5px; margin: 10px; border-style: solid; border-color: black; width: 100%">
<p><u>If you are using a graphical Whonix or <a data-href="/wiki/Qubes" href="../Qubes.html" title="Qubes">Qubes-Whonix</a></u>, run.
</p><div class="codeContainer">
<div class="selectBtnDiv">
<div class="smallText"><a class="selectLink" href="#" onclick="SelectText(this.parentNode.parentNode.parentNode.children[2].children[0]); return false;">[select code]</a></div>
</div>
<div class="preDiv">
<pre>kdesudo kwrite /etc/default/redsocks</pre>
</div>
<div class="textareaDiv">
<textarea class="codeBoxArea" readonly="readonly" rows="1">kdesudo kwrite /etc/default/redsocks</textarea>
</div>
</div>
<p><u>If you are using a terminal-only Whonix</u>, run.
</p><div class="codeContainer">
<div class="selectBtnDiv">
<div class="smallText"><a class="selectLink" href="#" onclick="SelectText(this.parentNode.parentNode.parentNode.children[2].children[0]); return false;">[select code]</a></div>
</div>
<div class="preDiv">
<pre>sudo nano /etc/default/redsocks</pre>
</div>
<div class="textareaDiv">
<textarea class="codeBoxArea" readonly="readonly" rows="1">sudo nano /etc/default/redsocks</textarea>
</div>
</div>
</div>
<p>Look for.
</p><p><code>
START=no
</code>
</p><p>And replace it with.
</p><p><code>
START=yes
</code>
</p><p>Configure redsocks by editing <span style="border:1px dotted #005cb9">/etc/redsocks.conf</span> to your needs.
</p><p>Open <i><span style="background-color:#FBFBFB">/etc/redsocks.conf</span></i> in an editor with root rights.
</p>
<div style="background: #F8F8F8; border: 2px; padding: 5px; margin: 10px; border-style: solid; border-color: black; width: 100%">
<p><u>If you are using a graphical Whonix or <a data-href="/wiki/Qubes" href="../Qubes.html" title="Qubes">Qubes-Whonix</a></u>, run.
</p><div class="codeContainer">
<div class="selectBtnDiv">
<div class="smallText"><a class="selectLink" href="#" onclick="SelectText(this.parentNode.parentNode.parentNode.children[2].children[0]); return false;">[select code]</a></div>
</div>
<div class="preDiv">
<pre>kdesudo kwrite /etc/redsocks.conf</pre>
</div>
<div class="textareaDiv">
<textarea class="codeBoxArea" readonly="readonly" rows="1">kdesudo kwrite /etc/redsocks.conf</textarea>
</div>
</div>
<p><u>If you are using a terminal-only Whonix</u>, run.
</p><div class="codeContainer">
<div class="selectBtnDiv">
<div class="smallText"><a class="selectLink" href="#" onclick="SelectText(this.parentNode.parentNode.parentNode.children[2].children[0]); return false;">[select code]</a></div>
</div>
<div class="preDiv">
<pre>sudo nano /etc/redsocks.conf</pre>
</div>
<div class="textareaDiv">
<textarea class="codeBoxArea" readonly="readonly" rows="1">sudo nano /etc/redsocks.conf</textarea>
</div>
</div>
</div>
<p>Under.
</p><p><code>
redsocks {
</code>
</p><p>You have to edit.
</p>
<pre>        ip = 127.0.0.1;
        port = 1080;
        type = socks5
</pre>
<p>To your needs.
</p><p>Start redsocks.
</p><p><code>
sudo service redsocks start
</code>
</p><p>Create a file <span style="border:1px dotted #005cb9">fw.bsh</span>.
</p><p>And use the following firewall rules.
</p>
<pre>#!/bin/bash
## These iptables rules redirect the traffic for all users,
## including root, with the exception of the user redsocks,
## through the proxy.

## TODO: these iptables rules need review.
## TODO: use iptables default policy drop.

## Choose either DNS rule #1 or DNS rule #2.

## For debugging/testing use this command in console.
## tail -f /var/log/syslog

## Flush old rules.
iptables -F
iptables -t nat -F
iptables -X

## Allow unlimited traffic on the loopback interface.
iptables -A INPUT -i lo -j ACCEPT
iptables -A OUTPUT -o lo -j ACCEPT
iptables -A OUTPUT --dst 127.0.0.1 -j ACCEPT

## Established incoming connections are accepted.
iptables -A INPUT -m state --state RELATED,ESTABLISHED -j ACCEPT

## Established outgoing connections are accepted.
iptables -A OUTPUT -m state --state RELATED,ESTABLISHED -j ACCEPT

## DNS rule #1.
## Allow DNS directly through Whonix-Gateway.
#iptables -A OUTPUT --dst 10.152.152.10 -p udp --dport 53 -j ACCEPT

## DNS rule #2.
## For DNSCrypt set /etc/resolv.conf to
## nameserver 127.0.0.1
##
## sudo dnscrypt-proxy --tcp-only --user=user
##
## DNSCrypt listening on port 53
iptables -t nat -A OUTPUT --dst 127.0.0.1 -p udp --dport 53 -j ACCEPT
iptables -t nat -A OUTPUT --dst 127.0.0.1 -p tcp --dport 53 -j ACCEPT

## redsocks must be allowed to establish direct connections.
iptables -A OUTPUT -j ACCEPT -m owner --uid-owner redsocks
iptables -t nat -A OUTPUT -j ACCEPT -m owner --uid-owner redsocks

## Redirect remaining traffic to redsocks.
iptables -t nat -A OUTPUT -p tcp -j REDIRECT --to-port 12345

## TODO: UDP rule untested.
#iptables -t nat -A OUTPUT -p udp -j REDIRECT --to-port 10053

## Log blocked traffic for debugging.
iptables -A OUTPUT -j LOG --log-level 4 --log-prefix "iptables: "

## Reject all other traffic.
iptables -A OUTPUT -j REJECT
</pre>
<p>Make the firewall script executable.
</p><p><code>
sudo chmod +x fw.bsh
</code>
</p><p>Apply the firewall rules.
</p><p><code>
sudo fw.bsh
</code>
</p>
<hr/>
<h1><span class="mw-headline" id="Footnotes">Footnotes</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Tunnels/Connecting_to_Tor_before_a_proxy&amp;action=edit&amp;section=31" href="https://www.whonix.org/w/index.php?title=Tunnels/Connecting_to_Tor_before_a_proxy&amp;action=edit&amp;section=31.html" title="Edit section: Footnotes">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<div class="reflist" style="list-style-type: decimal;">
<div class="mw-references-wrap mw-references-columns"><ol class="references">
<li id="cite_note-1"><span class="mw-cite-backlink"><a href="#cite_ref-1">↑</a></span> <span class="reference-text">Such as the Tor, <a data-href="/wiki/JonDonym" href="../JonDonym.html" title="JonDonym">JonDonym</a> or <a data-href="/wiki/I2P" href="../I2P.html" title="I2P">I2P</a> software.</span>
</li>
<li id="cite_note-2"><span class="mw-cite-backlink"><a href="#cite_ref-2">↑</a></span> <span class="reference-text">TCP or DNS</span>
</li>
<li id="cite_note-3"><span class="mw-cite-backlink"><a href="#cite_ref-3">↑</a></span> <span class="reference-text">Depends if the application has any proxy bypass bugs.</span>
</li>
<li id="cite_note-4"><span class="mw-cite-backlink"><a href="#cite_ref-4">↑</a></span> <span class="reference-text">Depends on how bug free the socksifier is.</span>
</li>
<li id="cite_note-5"><span class="mw-cite-backlink"><a href="#cite_ref-5">↑</a></span> <span class="reference-text">Because redirection happens at the iptables level, not at the application level.</span>
</li>
<li id="cite_note-6"><span class="mw-cite-backlink"><a href="#cite_ref-6">↑</a></span> <span class="reference-text">See <a href="#DNS_resolution">#DNS_resolution</a>.</span>
</li>
<li id="cite_note-7"><span class="mw-cite-backlink"><a href="#cite_ref-7">↑</a></span> <span class="reference-text">Questionable if that adds anything. See: <a data-href="/wiki/Comparison_Of_Tor_with_CGI_Proxies,_Proxy_Chains,_and_VPN_Services#Aren.27t_10_proxies_.28proxychains.29_better_than_Tor_with_only_3_hops.3F_-_proxychains_vs_Tor" href="../Comparison_Of_Tor_with_CGI_Proxies,_Proxy_Chains,_and_VPN_Services.html" title="Comparison Of Tor with CGI Proxies, Proxy Chains, and VPN Services">Aren't 10 proxies (proxychains) better than Tor with only 3 hops? - proxychains vs Tor</a></span>
</li>
<li id="cite_note-8"><span class="mw-cite-backlink"><a href="#cite_ref-8">↑</a></span> <span class="reference-text">Would require adding such a feature to redsocks.</span>
</li>
<li id="cite_note-9"><span class="mw-cite-backlink"><a href="#cite_ref-9">↑</a></span> <span class="reference-text">
<code>TB_NO_TOR_CON_CHECK=1</code> needs to be set because there is no filtered Tor ControlPort access when Whonix tunnel firewall is enabled, which would break tb-updater's Tor connectivity check.</span>
</li>
<li id="cite_note-10"><span class="mw-cite-backlink"><a href="#cite_ref-10">↑</a></span> <span class="reference-text">
By tb-updater default, if unset, variable <code>CURL_PROXY</code> will be dynamically set to a Tor SocksPort on Whonix-Gateway. For example to <code>CURL_PROXY="--proxy socks5h://user:password@10.137.6.1:9115"</code>.
<br/>
By using a curl parameter we are using anyhow, i.e. <code>CURL_PROXY="--fail"</code> we can in effect disable the environment variable even if it's technically still set. This will result in downloading by using the system's default networking.</span>
</li>
<li id="cite_note-11"><span class="mw-cite-backlink"><a href="#cite_ref-11">↑</a></span> <span class="reference-text">
This term was coined in context of a <a class="external text" data-href="https://trac.torproject.org/projects/tor/wiki/doc/TransparentProxy" href="https://trac.torproject.org/projects/tor/wiki/doc/TransparentProxy" rel="noreferrer noopener" target="_blank">Tor Transparent Proxy</a>. It acts as a simple gateway that routes all connections through Tor, but does not provide <a data-href="/wiki/Stream_Isolation" href="../Stream_Isolation.html" title="Stream Isolation">Stream Isolation</a>.</span>
</li>
<li id="cite_note-12"><span class="mw-cite-backlink"><a href="#cite_ref-12">↑</a></span> <span class="reference-text">Unless this environment variable is manually unset before starting Tor Browser.</span>
</li>
<li id="cite_note-13"><span class="mw-cite-backlink"><a href="#cite_ref-13">↑</a></span> <span class="reference-text">The regular Tor Browser Bundle from The Tor Project (without Whonix) allows networking settings to changed inside Tor via the <code>Open Network Settings</code> menu option. It has the same effect as editing Tor's config file torrc. In Whonix, the environment variable <code>export TOR_NO_DISPLAY_NETWORK_SETTINGS=1</code> has been <a class="external text" data-href="https://github.com/Whonix/anon-ws-disable-stacked-tor/blob/master/usr/lib/anon-ws-disable-stacked-tor/torbrowser.sh" href="https://github.com/Whonix/anon-ws-disable-stacked-tor/blob/master/usr/lib/anon-ws-disable-stacked-tor/torbrowser.sh" rel="noreferrer noopener" target="_blank">set</a> to disable the <code>TorButton</code> -&gt; <code>Open Network Settings...</code> menu item. It is not useful and confusing to have in the Whonix-Workstation because:
<ul><li>In Whonix, there is only limited access to Tor's control port (see <a class="mw-redirect" data-href="/wiki/Dev/CPFP" href="../Dev/CPFP.html" title="Dev/CPFP">Dev/CPFP</a> for more information).</li>
<li>For security reasons, Tor must be manually configured in <i>/usr/local/etc/torrc.d/50_user.conf</i> on the Whonix-Gateway, and not from the Whonix-Workstation (see <a data-href="/wiki/Features#VPN_.2F_Tunnel_support" href="../Features.html" title="Features">VPN/Tunnel support</a> for more information). </li></ul>
</span></li>
<li id="cite_note-14"><span class="mw-cite-backlink"><a href="#cite_ref-14">↑</a></span> <span class="reference-text">
<code>TB_NO_TOR_CON_CHECK=1</code> needs to be set because there is no filtered Tor ControlPort access when Whonix tunnel firewall is enabled, which would break tb-updater's Tor connectivity check.</span>
</li>
<li id="cite_note-15"><span class="mw-cite-backlink"><a href="#cite_ref-15">↑</a></span> <span class="reference-text">
By tb-updater default, if unset, variable <code>CURL_PROXY</code> will be dynamically set to a Tor SocksPort on Whonix-Gateway. For example to <code>CURL_PROXY="--proxy socks5h://user:password@10.137.6.1:9115"</code>.
<br/>
By using a curl parameter we are using anyhow, i.e. <code>CURL_PROXY="--fail"</code> we can in effect disable the environment variable even if it's technically still set. This will result in downloading by using the system's default networking.</span>
</li>
<li id="cite_note-16"><span class="mw-cite-backlink"><a href="#cite_ref-16">↑</a></span> <span class="reference-text">Using .anondist-orig, i.e. /usr/bin/wget.anondist-orig will circumvent the wget uwt wrapper.</span>
</li>
<li id="cite_note-17"><span class="mw-cite-backlink"><a href="#cite_ref-17">↑</a></span> <span class="reference-text">

For testing, you could compare the IP shown by the above command with the next one. If you didn't disable the wget uwt wrapper, the following command will most likely fetch another IP, because still using Stream Isolation.

Using Tor's TransPort.<br/>
(/usr/bin/wget.anondist-orig original non-uwt-wrapped version)

<code>
wget.anondist-orig <a class="external free" data-href="https://check.torproject.org" href="https://check.torproject.org" rel="noreferrer noopener" target="_blank">https://check.torproject.org</a>
</code></span>
</li>
<li id="cite_note-18"><span class="mw-cite-backlink"><a href="#cite_ref-18">↑</a></span> <span class="reference-text">For further explanation only...

If you <a data-href="/wiki/Stream_Isolation#Deactivate_uwt_Stream_Isolation_Wrapper" href="../Stream_Isolation.html" title="Stream Isolation">disabled</a> wget's uwt wrapper, to use Tor's TransPort, you could use the following command.

<code>
wget <a class="external free" data-href="https://check.torproject.org" href="https://check.torproject.org" rel="noreferrer noopener" target="_blank">https://check.torproject.org</a>
</code></span>
</li>
<li id="cite_note-19"><span class="mw-cite-backlink"><a href="#cite_ref-19">↑</a></span> <span class="reference-text">
This term was coined in context of a <a class="external text" data-href="https://trac.torproject.org/projects/tor/wiki/doc/TransparentProxy" href="https://trac.torproject.org/projects/tor/wiki/doc/TransparentProxy" rel="noreferrer noopener" target="_blank">Tor Transparent Proxy</a>. It acts as a simple gateway that routes all connections through Tor, but does not provide <a data-href="/wiki/Stream_Isolation" href="../Stream_Isolation.html" title="Stream Isolation">Stream Isolation</a>.</span>
</li>
<li id="cite_note-20"><span class="mw-cite-backlink"><a href="#cite_ref-20">↑</a></span> <span class="reference-text">Unless this environment variable is manually unset before starting Tor Browser.</span>
</li>
<li id="cite_note-21"><span class="mw-cite-backlink"><a href="#cite_ref-21">↑</a></span> <span class="reference-text">The regular Tor Browser Bundle from The Tor Project (without Whonix) allows networking settings to changed inside Tor via the <code>Open Network Settings</code> menu option. It has the same effect as editing Tor's config file torrc. In Whonix, the environment variable <code>export TOR_NO_DISPLAY_NETWORK_SETTINGS=1</code> has been <a class="external text" data-href="https://github.com/Whonix/anon-ws-disable-stacked-tor/blob/master/usr/lib/anon-ws-disable-stacked-tor/torbrowser.sh" href="https://github.com/Whonix/anon-ws-disable-stacked-tor/blob/master/usr/lib/anon-ws-disable-stacked-tor/torbrowser.sh" rel="noreferrer noopener" target="_blank">set</a> to disable the <code>TorButton</code> -&gt; <code>Open Network Settings...</code> menu item. It is not useful and confusing to have in the Whonix-Workstation because:
<ul><li>In Whonix, there is only limited access to Tor's control port (see <a class="mw-redirect" data-href="/wiki/Dev/CPFP" href="../Dev/CPFP.html" title="Dev/CPFP">Dev/CPFP</a> for more information).</li>
<li>For security reasons, Tor must be manually configured in <i>/usr/local/etc/torrc.d/50_user.conf</i> on the Whonix-Gateway, and not from the Whonix-Workstation (see <a data-href="/wiki/Features#VPN_.2F_Tunnel_support" href="../Features.html" title="Features">VPN/Tunnel support</a> for more information). </li></ul>
</span></li>
<li id="cite_note-22"><span class="mw-cite-backlink"><a href="#cite_ref-22">↑</a></span> <span class="reference-text">Might be also interesting: <a data-href="/wiki/Advanced_Security_Guide#More_than_one_Tor_Browser_in_Whonix" href="../Advanced_Security_Guide.html" title="Advanced Security Guide">Advanced Security Guide#More than one Tor Browser in Whonix</a></span>
</li>
<li id="cite_note-23"><span class="mw-cite-backlink"><a href="#cite_ref-23">↑</a></span> <span class="reference-text"><a class="external free" data-href="https://trac.torproject.org/projects/tor/wiki/doc/torsocks#WorkaroundforIPv6leakbug" href="https://trac.torproject.org/projects/tor/wiki/doc/torsocks" rel="noreferrer noopener" target="_blank">https://trac.torproject.org/projects/tor/wiki/doc/torsocks#WorkaroundforIPv6leakbug</a></span>
</li>
<li id="cite_note-24"><span class="mw-cite-backlink"><a href="#cite_ref-24">↑</a></span> <span class="reference-text">Advanced. Recommendation: Why not use Tor stream isolation for the proxychains connection?

<pre>[ProxyList]
## add proxy here ...
## meanwhile
## defaults set to "tor"
#socks4 127.0.0.1 9050
socks5 10.152.152.10 9152
socks5 x.x.x.x xxxx
</pre></span>
</li>
<li id="cite_note-25"><span class="mw-cite-backlink"><a href="#cite_ref-25">↑</a></span> <span class="reference-text">
For testing, you could compare the IP shown by the above command with the next one. If you didn't disable the wget uwt wrapper, the following command will most likely fetch another IP, because still using Stream Isolation. Using Tor's TransPort.

(/usr/bin/wget.anondist-orig original non-uwt-wrapped version)

<code>
wget.anondist-orig <a class="external free" data-href="https://check.torproject.org" href="https://check.torproject.org" rel="noreferrer noopener" target="_blank">https://check.torproject.org</a>
</code></span>
</li>
<li id="cite_note-26"><span class="mw-cite-backlink"><a href="#cite_ref-26">↑</a></span> <span class="reference-text">
This term was coined in context of a <a class="external text" data-href="https://trac.torproject.org/projects/tor/wiki/doc/TransparentProxy" href="https://trac.torproject.org/projects/tor/wiki/doc/TransparentProxy" rel="noreferrer noopener" target="_blank">Tor Transparent Proxy</a>. It acts as a simple gateway that routes all connections through Tor, but does not provide <a data-href="/wiki/Stream_Isolation" href="../Stream_Isolation.html" title="Stream Isolation">Stream Isolation</a>.</span>
</li>
<li id="cite_note-27"><span class="mw-cite-backlink"><a href="#cite_ref-27">↑</a></span> <span class="reference-text">Unless this environment variable is manually unset before starting Tor Browser.</span>
</li>
<li id="cite_note-28"><span class="mw-cite-backlink"><a href="#cite_ref-28">↑</a></span> <span class="reference-text">The regular Tor Browser Bundle from The Tor Project (without Whonix) allows networking settings to changed inside Tor via the <code>Open Network Settings</code> menu option. It has the same effect as editing Tor's config file torrc. In Whonix, the environment variable <code>export TOR_NO_DISPLAY_NETWORK_SETTINGS=1</code> has been <a class="external text" data-href="https://github.com/Whonix/anon-ws-disable-stacked-tor/blob/master/usr/lib/anon-ws-disable-stacked-tor/torbrowser.sh" href="https://github.com/Whonix/anon-ws-disable-stacked-tor/blob/master/usr/lib/anon-ws-disable-stacked-tor/torbrowser.sh" rel="noreferrer noopener" target="_blank">set</a> to disable the <code>TorButton</code> -&gt; <code>Open Network Settings...</code> menu item. It is not useful and confusing to have in the Whonix-Workstation because:
<ul><li>In Whonix, there is only limited access to Tor's control port (see <a class="mw-redirect" data-href="/wiki/Dev/CPFP" href="../Dev/CPFP.html" title="Dev/CPFP">Dev/CPFP</a> for more information).</li>
<li>For security reasons, Tor must be manually configured in <i>/usr/local/etc/torrc.d/50_user.conf</i> on the Whonix-Gateway, and not from the Whonix-Workstation (see <a data-href="/wiki/Features#VPN_.2F_Tunnel_support" href="../Features.html" title="Features">VPN/Tunnel support</a> for more information). </li></ul>
</span></li>
<li id="cite_note-29"><span class="mw-cite-backlink"><a href="#cite_ref-29">↑</a></span> <span class="reference-text">anonymizing middlebox</span>
</li>
<li id="cite_note-30"><span class="mw-cite-backlink"><a href="#cite_ref-30">↑</a></span> <span class="reference-text">by uwt socksifier or proxy settings</span>
</li>
<li id="cite_note-31"><span class="mw-cite-backlink"><a href="#cite_ref-31">↑</a></span> <span class="reference-text">local redirection</span>
</li>
<li id="cite_note-32"><span class="mw-cite-backlink"><a href="#cite_ref-32">↑</a></span> <span class="reference-text"><a class="external text" data-href="https://trac.torproject.org/projects/tor/wiki/doc/TorBOX/OptionalConfigurations?version=129#TransparentProxying" href="https://trac.torproject.org/projects/tor/wiki/doc/TorBOX/OptionalConfigurations?version=129" rel="noreferrer noopener" target="_blank">torproject.org wiki version 129</a> contains an old example using privoxy, JonDo and httpsdnsd. The new example uses redsocks and is simpler.</span>
</li>
<li id="cite_note-33"><span class="mw-cite-backlink"><a href="#cite_ref-33">↑</a></span> <span class="reference-text"><a class="external free" data-href="https://en.wikipedia.org/wiki/Comparison_of_DNS_server_software" href="https://en.wikipedia.org/wiki/Comparison_of_DNS_server_software" rel="noreferrer noopener" target="_blank">https://en.wikipedia.org/wiki/Comparison_of_DNS_server_software</a></span>
</li>
<li id="cite_note-34"><span class="mw-cite-backlink"><a href="#cite_ref-34">↑</a></span> <span class="reference-text">You can't simply add another public DNS resolver (i.e. OpenDNS or Google) to /etc/resolv.conf in Whonix-Workstation (i.e. Tor -&gt; public DNS resolver), it would have no effect, as explained under <a data-href="/wiki/Install_Software#Whonix-Workstation_is_firewalled" href="../Install_Software.html" title="Install Software">Whonix-Workstation is firewalled</a>.</span>
</li>
<li id="cite_note-35"><span class="mw-cite-backlink"><a href="#cite_ref-35">↑</a></span> <span class="reference-text">Also <a data-href="/wiki/Secondary_DNS_Resolver#httpsdnsd_by_JonDos" href="../Secondary_DNS_Resolver.html" title="Secondary DNS Resolver">Secondary DNS Resolver#httpsdnsd by JonDos</a> might work, but you'd need to make some changes (use httpsdnsd as a system wide, Whonix-Workstation wide, DNS resolver, not just for a specific user account).</span>
</li>
<li id="cite_note-36"><span class="mw-cite-backlink"><a href="#cite_ref-36">↑</a></span> <span class="reference-text">DNSCrypt and httpsdnsd add the advantage, that neither the proxy nor the Tor exit relay can sniff or manipulate your DNS requests, since they are encrypted and authenticated.</span>
</li>
<li id="cite_note-37"><span class="mw-cite-backlink"><a href="#cite_ref-37">↑</a></span> <span class="reference-text">Or perhaps also <a class="external text" data-href="http://www.mulliner.org/collin/ttdnsd.php" href="http://www.mulliner.org/collin/ttdnsd.php" rel="noreferrer noopener" target="_blank">ttdnsd</a> with Google could work.</span>
</li>
<li id="cite_note-38"><span class="mw-cite-backlink"><a href="#cite_ref-38">↑</a></span> <span class="reference-text">
This term was coined in context of a <a class="external text" data-href="https://trac.torproject.org/projects/tor/wiki/doc/TransparentProxy" href="https://trac.torproject.org/projects/tor/wiki/doc/TransparentProxy" rel="noreferrer noopener" target="_blank">Tor Transparent Proxy</a>. It acts as a simple gateway that routes all connections through Tor, but does not provide <a data-href="/wiki/Stream_Isolation" href="../Stream_Isolation.html" title="Stream Isolation">Stream Isolation</a>.</span>
</li>
<li id="cite_note-39"><span class="mw-cite-backlink"><a href="#cite_ref-39">↑</a></span> <span class="reference-text">Unless this environment variable is manually unset before starting Tor Browser.</span>
</li>
<li id="cite_note-40"><span class="mw-cite-backlink"><a href="#cite_ref-40">↑</a></span> <span class="reference-text">The regular Tor Browser Bundle from The Tor Project (without Whonix) allows networking settings to changed inside Tor via the <code>Open Network Settings</code> menu option. It has the same effect as editing Tor's config file torrc. In Whonix, the environment variable <code>export TOR_NO_DISPLAY_NETWORK_SETTINGS=1</code> has been <a class="external text" data-href="https://github.com/Whonix/anon-ws-disable-stacked-tor/blob/master/usr/lib/anon-ws-disable-stacked-tor/torbrowser.sh" href="https://github.com/Whonix/anon-ws-disable-stacked-tor/blob/master/usr/lib/anon-ws-disable-stacked-tor/torbrowser.sh" rel="noreferrer noopener" target="_blank">set</a> to disable the <code>TorButton</code> -&gt; <code>Open Network Settings...</code> menu item. It is not useful and confusing to have in the Whonix-Workstation because:
<ul><li>In Whonix, there is only limited access to Tor's control port (see <a class="mw-redirect" data-href="/wiki/Dev/CPFP" href="../Dev/CPFP.html" title="Dev/CPFP">Dev/CPFP</a> for more information).</li>
<li>For security reasons, Tor must be manually configured in <i>/usr/local/etc/torrc.d/50_user.conf</i> on the Whonix-Gateway, and not from the Whonix-Workstation (see <a data-href="/wiki/Features#VPN_.2F_Tunnel_support" href="../Features.html" title="Features">VPN/Tunnel support</a> for more information). </li></ul>
</span></li>
<li id="cite_note-41"><span class="mw-cite-backlink"><a href="#cite_ref-41">↑</a></span> <span class="reference-text">
<code>TB_NO_TOR_CON_CHECK=1</code> needs to be set because there is no filtered Tor ControlPort access when Whonix tunnel firewall is enabled, which would break tb-updater's Tor connectivity check.</span>
</li>
<li id="cite_note-42"><span class="mw-cite-backlink"><a href="#cite_ref-42">↑</a></span> <span class="reference-text">
By tb-updater default, if unset, variable <code>CURL_PROXY</code> will be dynamically set to a Tor SocksPort on Whonix-Gateway. For example to <code>CURL_PROXY="--proxy socks5h://user:password@10.137.6.1:9115"</code>.
<br/>
By using a curl parameter we are using anyhow, i.e. <code>CURL_PROXY="--fail"</code> we can in effect disable the environment variable even if it's technically still set. This will result in downloading by using the system's default networking.</span>
</li>
</ol></div></div>
<hr/>
<div style="padding-bottom:1px; padding-top:6px; border:thin solid black; background:#EEEEEE; text-align:center;"><u>Random News:</u>
<p>Did you know that Whonix could provide protection against <a class="external text" data-href="https://en.wikipedia.org/wiki/Backdoor_(computing)" href="https://en.wikipedia.org/wiki/Backdoor_(computing)" rel="noreferrer noopener" target="_blank">backdoors</a>? See <a class="external text" data-href="../Verifiable_Builds" href="../Verifiable_Builds" rel="noreferrer noopener" target="_blank">Verifiable Builds</a>. Help is wanted and welcomed.
</p>
</div>
<hr/><p><font size="-1"><a class="external text" data-href="../Tunnels/Connecting_to_Tor_before_a_proxy" href="../Tunnels/Connecting_to_Tor_before_a_proxy" rel="noreferrer noopener" target="_blank">https</a> | (<a data-href="/wiki/Forcing_.onion_on_Whonix.org" href="../Forcing_.onion_on_Whonix.org.html" title="Forcing .onion on Whonix.org">forcing</a>) <a class="external text" data-href="http://dds6qkxpwdeubwucdiaord2xgbbeyds25rbsgr73tbfpqpt4a6vjwsyd.onion/wiki/Tunnels/Connecting_to_Tor_before_a_proxy" href="http://dds6qkxpwdeubwucdiaord2xgbbeyds25rbsgr73tbfpqpt4a6vjwsyd.onion/wiki/Tunnels/Connecting_to_Tor_before_a_proxy" rel="noreferrer noopener" target="_blank">onion</a><br/>
</font></p><font size="-1"></font><p><font size="-1">Share: <a data-href="https://twitter.com/intent/tweet?url=../Tunnels/Connecting_to_Tor_before_a_proxy&amp;text=&amp;via=Whonix" href="https://twitter.com/intent/tweet?url=../Tunnels/Connecting_to_Tor_before_a_proxy&amp;text=&amp;via=Whonix">Twitter</a>
|
<a data-href="https://facebook.com/sharer.php?u=../Tunnels/Connecting_to_Tor_before_a_proxy" href="https://facebook.com/sharer.php?u=../Tunnels/Connecting_to_Tor_before_a_proxy">Facebook</a></font>
</p><p><font size="-1">This is a wiki. Want to improve this page? Help is welcome and volunteer contributions are happily considered! See <a class="external text" data-href="https://github.com/Whonix/Whonix/blob/master/CONTRIBUTING.md" href="https://github.com/Whonix/Whonix/blob/master/CONTRIBUTING.md" rel="noreferrer noopener" target="_blank">Conditions for Contributions to Whonix</a>, then <a data-href="/w/index.php?title=Tunnels/Connecting_to_Tor_before_a_proxy&amp;action=edit" href="https://www.whonix.org/w/index.php?title=Tunnels/Connecting_to_Tor_before_a_proxy&amp;action=edit">Edit</a>! IP addresses are scrubbed, but editing over Tor is recommended. Edits are held for moderation.</font>
</p><p><font size="-1">Whonix is a <a class="external text" data-href="http://www.openinventionnetwork.com/licensees.php" href="http://www.openinventionnetwork.com/licensees.php" rel="noreferrer noopener" target="_blank">licensee</a> of the Open Invention Network. Unless otherwise noted, the content of this page is <a data-href="/wiki/Whonix:Copyrights" href="../Whonix:Copyrights.html" title="Whonix:Copyrights">copyrighted</a> and licensed under the same Libre Software <a class="external text" data-href="https://github.com/Whonix/Whonix/blob/master/debian/copyright" href="https://github.com/Whonix/Whonix/blob/master/debian/copyright" rel="noreferrer noopener" target="_blank">license</a> as Whonix itself. (<a data-href="/wiki/Why_Whonix_is_Free_Software" href="../Why_Whonix_is_Free_Software.html" title="Why Whonix is Free Software">Why?</a>)</font>
</p>
<!-- 
NewPP limit report
Cached time: 20180830233926
Cache expiry: 0
Dynamic content: true
CPU time usage: 0.452 seconds
Real time usage: 0.508 seconds
Preprocessor visited node count: 3834/1000000
Preprocessor generated node count: 6904/1000000
Post‐expand include size: 123233/2097152 bytes
Template argument size: 50500/2097152 bytes
Highest expansion depth: 19/40
Expensive parser function count: 0/100
Unstrip recursion depth: 1/20
Unstrip post‐expand size: 23874/5000000 bytes
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00%  373.799      1 -total
 97.87%  365.834     29 Template:Box
 38.11%  142.462     45 Template:CodeSelect
 29.99%  112.092      4 Template:Tor_Browser_Remove_Proxy_Settings
 23.33%   87.223     12 Template:Open_with_root_rights
 21.62%   80.804      6 Template:Mbox
 18.70%   69.900      6 Template:Ambox
 14.78%   55.259      1 Template:Prevent_Bypassing_the_Tunnel-Link
 12.29%   45.934      3 Template:Deactivate_Misc_Proxy_Settings
 11.19%   41.811      1 Template:Disable_Stream_Isolation_Easy
-->
</div></div><div class="printfooter">
Retrieved from "<a data-href="https://www.whonix.org/w/index.php?title=Tunnels/Connecting_to_Tor_before_a_proxy&amp;oldid=35147" dir="ltr" href="https://www.whonix.org/w/index.php?title=Tunnels/Connecting_to_Tor_before_a_proxy&amp;oldid=35147">https://www.whonix.org/w/index.php?title=Tunnels/Connecting_to_Tor_before_a_proxy&amp;oldid=35147</a>"</div>
<div class="clear_both"></div>
</div>
<div class="group"><div class="catlinks" data-mw="interface" id="catlinks"><div class="mw-normal-catlinks" id="mw-normal-catlinks"><a data-href="/wiki/Special:Categories" href="../Special:Categories.html" title="Special:Categories">Category</a>: <ul><li><a data-href="/wiki/Category:Documentation" href="../Category:Documentation.html" title="Category:Documentation">Documentation</a></li></ul></div></div></div>
</div>
</div>
</div>
<footer class="row">
<div id="footer">
<div class="small-12 large-centered columns text-center" id="footer-left">
<ul id="footer-left">
<li id="footer-lastmod"> This page was last edited on 1 August 2018, at 07:08.</li>
<li id="footer-Priority_Support"><a data-href="/wiki/Priority_Support" href="../Priority_Support.html" title="Priority Support">Priority Support</a></li>
<li id="footer-Investors"><a data-href="/wiki/Investors" href="../Investors.html" title="Investors">Investors</a></li>
<li id="footer-Professional_Support"><a data-href="/wiki/Professional_Support" href="../Professional_Support.html" title="Professional Support">Professional Support</a></li>
</ul>
</div>
<div class="large-12 small-12 columns" id="footer-right-icons">
<ul id="poweredby">
</ul>
</div>
</div>
</footer>
</div>

</body>
<!-- Cached/compressed 20180830233926 -->
</html>
