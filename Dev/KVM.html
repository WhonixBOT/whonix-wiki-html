<!DOCTYPE html>
<html class="client-nojs" dir="ltr" lang="en"><!-- 
 single html processed by https://github.com/zTrix/webpage2html
 title: Dev/KVM - Whonix
 url: ../Dev/KVM
 date: Sat Dec  8 07:47:07 2018
-->
<head>
<meta charset="utf-8"/>
<title>Dev/KVM - Whonix</title>
<link rel="stylesheet" type="text/css" href="../style.css">




<meta content="" name="ResourceLoaderDynamicStyles"/>

<meta content="MediaWiki 1.31.1" name="generator"/>
<meta content="" name="google-site-verification"/>
<meta content="Development Notes for adding KVM support to Whonix." name="description"/>
<meta content="Development Notes for adding KVM support to Whonix." name="twitter:description"/>
<meta content="https://www.whonix.org/w/images/4/47/Whonix_Facebook_Social_Share.png" name="image"/>
<meta content="https://www.whonix.org/w/images/4/47/Whonix_Facebook_Social_Share.png" name="twitter:image:src"/>
<meta content="summary_large_image" name="twitter:card"/>
<meta content="@Whonix" name="twitter:site"/>
<meta content="Whonix" name="twitter:domain"/>
<meta content="@Whonix" name="twitter:creator"/>
<meta content="width=device-width, user-scalable=yes, initial-scale=1.0" name="viewport"/>
<link data-href="/w/index.php?title=Dev/KVM&amp;action=edit" href="https://www.whonix.org/w/index.php?title=Dev/KVM&amp;action=edit" rel="alternate.html" title="Edit" type="application/x-wiki"/>
<link data-href="/w/index.php?title=Dev/KVM&amp;action=edit" href="https://www.whonix.org/w/index.php?title=Dev/KVM&amp;action=edit" rel="edit.html" title="Edit"/>
<link data-href="/favicon.ico" href="data:image/x-icon;base64,AAABAAEAEBAAAAEAIABoBAAAFgAAACgAAAAQAAAAIAAAAAEAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOPj4wC5q6j/xba0/8W2tP+3qab/4+PiBQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALyurP/Ku7n/yru5/8q7uf/Ku7n/yru5/8q7uf+6rKr/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALyurP/Ku7n/yru5/8CohP/VnhL/1Z4S/8CohP/Ku7n/yru5/7mrqf8AAAAAAAAAAAAAAAAAAAAAAAAAAI6Mi//Ku7n/yru5/8GRHP/iqhL/////////////////wJEd/8q7uf/Ku7n/xsXE/wAAAAAAAAAAAAAAAAAAAAC5q6n/yru5/8q7uf/hqRH//////0bcy/9G3Mv//////+GpEf/Ku7n/yru5/7qsqv8AAAAAAAAAAAAAAAAAAAAAxLW0/8q7uf/Ku7n/4qoS/////////////////0bcy//iqhL/yru5/8q7uf/Gt7T/AAAAAAAAAAAAAAAAAAAAAMKzsP/Ku7n/yru5/96lFf//////RtzL/0bcy///////3qUV/8q7uf/Ku7n/wrWy/wAAAAAAAAAAAAAAAAAAAACvo6D/yru5/8q7uf/Ku7n/4akQ//fnvP/57tD/4akQ/8q7uf/Ku7n/yru5/7Gkov8AAAAAAAAAAAAAAAAAAAAAAAAAAMq7uf/Ku7n/yru5/8q7uf/hqRD/4akQ/8q7uf/Ku7n/yru5/8q7uf8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACOjIv/yru5/8q7uf/Ku7n/yru5/8q7uf/Ku7n/yru5/8q7uf+Mioj/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAISDgf/Iurj/yru5/8q7uf/Ku7n/yru5/8i5uP+EgoH/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAC6rKr/q56c/wAAAACOjIv/joyL/wAAAACom5r/taim/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAuqyp/66hnv8AAAAAAAAAAAAAAAAAAAAAqp2b/7SnpP8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKmcm/+9r6z/AAAAAAAAAAAAAAAAAAAAALmrqf+jl5b/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwLOw/6uenP8AAAAAAAAAAKqenP+/sq//AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACtoJ7/vK2r/72vrP+sn57/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/D8AAPAPAADgBwAAwAMAAMADAADAAwAAwAMAAMADAADgBwAA4AcAAPAPAADyTwAA888AAPPPAAD5nwAA/D8AAA==" rel="shortcut icon"/>
<link data-href="/w/opensearch_desc.php" href="https://www.whonix.org/w/opensearch_desc.php" rel="search.html" title="Whonix (en)" type="application/opensearchdescription+xml"/>
<link data-href="https://www.whonix.org/w/api.php?action=rsd" href="https://www.whonix.org/w/api.php?action=rsd" rel="EditURI" type="application/rsd+xml"/>
<link data-href="/w/index.php?title=Special:RecentChanges&amp;feed=atom" href="https://www.whonix.org/w/index.php?title=Special:RecentChanges&amp;feed=atom" rel="alternate.html" title="Whonix Atom feed" type="application/atom+xml"/>
<meta content="article" property="og:type"/>
<meta content="Whonix" property="og:site_name"/>
<meta content="Dev/KVM" property="og:title"/>
<meta content="../Dev/KVM" property="og:url"/>
<meta content="Development Notes for adding KVM support to Whonix." property="og:description"/>
<meta content="https://www.whonix.org/w/images/4/47/Whonix_Facebook_Social_Share.png" property="og:image"/>

<meta content="" property="fb:app_id"/>
<meta content="" property="fb:admins"/>
<meta content="https://www.facebook.com/Whonix" property="article:author"/>
<meta content="https://www.facebook.com/Whonix" property="article:publisher"/>
<meta content="IE=edge" http-equiv="X-UA-Compatible"/>
<!--[if lt IE 9]><script src="/w/load.php?debug=false&amp;lang=en&amp;modules=html5shiv&amp;only=scripts&amp;skin=foreground&amp;sync=1"></script><![endif]-->
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Dev_KVM rootpage-Dev skin-foreground action-view"><div id="navwrapper"><!-- START FOREGROUNDTEMPLATE -->

</div>
<div id="page-content">
<div class="row">
<div class="large-12 columns">
<!-- Output page indicators -->
<div class="mw-indicators mw-body-content">
</div>
<!-- If user is logged in output echo location -->
<!--[if lt IE 9]>
				<div id="siteNotice" class="sitenotice panel radius">Whonix may not look as expected in this version of Internet Explorer. We recommend you upgrade to a newer version of Internet Explorer or switch to a browser like Firefox or Chrome.</div>
				<![endif]-->
<div class="sitenotice" id="siteNotice"><div dir="ltr" id="localNotice" lang="en"><div class="mw-parser-output"><p><style type="text/css">

#banner {
 position: relative;
 overflow: hidden;
 margin-bottom: 0.5em !important;
 margin-top: 0.5em !important;
 background-color:#D03232;
 border: solid 1px #aaaaaa; 
 height:66px;
}

#banner a.cn-full-banner-click {
 display:block;
 height:100%;
 width:100%;
 cursor: pointer;
}


#banner-logo {
 position: absolute;
 top: 8px;
 left: 15px;
 background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAArCAYAAAA65tviAAANxklEQVRo3rWae3Ad1X3HP2d3r65elmz5KcvyA0u2MQYbcIyhNgNI40wcHAdKIDjM5EFC0oaB0nTS0Jl22ukj09CmnaRNJ7QpTMorpQWSQoITiRjimNi4NTa2ZVvGT0m2JEuWru5D997d8+sf5+zdvZJsnHS6M5rV2bv39/t9f+/zO1cxxdUGdJp7nYKPAXcLrAEWAnkFx4E3gVc74KcA7UAHV3a12bvlMVfBBoGNClYCswFf4CSwD9ip4JcdoC/HQ031sN3cPifwPftIAKViC0AUKPv/VmVA6SsF1AazgBcUtEmMx4TX4s++ADzdCX6o6EsCCV9oNxpfKoCL4VgD1NYkmdEwjZHRDCdSOUZBHAtQ4JyClg7IXs4S1gqdwO1WEQKoGZZHwkpfAMbsX+zKKVjRAWcuaZFQk+3QDbRooAlomlHDnffdQuPCWVTVJEELIkIhm2fw/Agdb3Wx/cCZUABfwbYOeHEqrbXBastmlg/SXFWhPr7uKhbOrqW2sgLXUSjR5Md9xtLj9A2k2LHvDKNaOAcikdAPdMBzk4CEINqgU8EdClgErFvfyub7bkGs8IhAoBGtES2gBc9RnD45wJM/fIczF9LiGpqPdMC32ywDq6C7gJc0SLXnqE/d3MJNKxopFAMkCOkZ2mhBtEZpcBB2vtfDO8cH6QfS1qWBrR3wo1BhcYt8FHhVLIgbb1jC1gc2orUxvmEQAQjXBOb/hOvwrWd38t8nBnAMycc64O+tJTYreE2DLG6oVX/8iQ8ZACEtMSDQIBICMYoTLagg4PxgipffPkEvkDJgAoEZnZAGUDawqwVGgMQcYHnjDB786laUgNaC0trcRaM1pTWWWSiM0gE/+Mk+fvruaVEmdr4osNtmH3XT0jl89o5rEMczfhIqRkIwEoHQgkIsf0EXCwz1D/GDX52iBxOIAqMYMBK61j0CL7rAEuAP/vx+KuumWUEjZsQ0KFaDaF0SQkRw/IDnfryb7QfOigdFBa6Ae9vVjXxyw9VQWRvRjLuspuRWEIKJ0RfQmTF27TvO3p5RjofCw291wtvKmj4FTGsC1t+4hLse3IwOiAlcrjWxWgqFmChUopDlb5/bwf4zwyigdW4dj915A279bBCrgDg9kUk8jDsbRZZ4APT38a87DtNb0NJvQqO3ExaoNlim4KiALAL1xUe3sODqlijgxPit6BiDmE9PLRDI0Dm+9tTPyRV8/vq+dVQ0LkIpJxKqRKfcPc3nhm75c/MsyKTZt2svO86m5ERU21pUG9wDvOgBS4E/ffIxiiRQlogWo/0yAGHsxC1S0pplHmgGDu7DVTB98TLcZFUkUJlLWR4SKUVKtGN8LN3ssS4yg4M89V4/p8EPwAPuUW3wd8CjM0FtWNnE/Y9/nmIhiOLDMii5lAiC1VqoTSItx10kGB0m33uaqmWrSxoWGw9l67LvESkj5A3oXJb0u3vR2QyegmcPDnLa18EQuAq+pdpsCVkM3Pup21nzkXa07xuBY24wyX9DjYYgofRZFDcayY+jKipj7xMJiZQDiNEUAeW4+BeHyR49SHHgHIICLTgi7OpL8+7FcX0KHOAN1Q6nBBYtAx78w200r15t0yI20JhCiNhayn14olCircBhZiq5CdaSsc/F1GjRmuJgP7ljhyj09YByI7cOTPB3j+TlF/1ZjpkY6VVtMKqgrgX48l/8LnNbW21miQnIhAAsgZta+Agg5WvibgSClJot8X2kWCB79DDZg/tCj40KZKCjVBwIg7kir/VlpdsAyag28B1wlwKPfOMxZi9tMSlXImZl2itxIEqJZaBCoSc/FxHTSihT+8X3yR0/QrbrAH4qBcWCLbQ25etY6xLoMpcdzPm81j8u3da+qt3WkBbg4b96hMY1NyK+T5BNQ7GI9ouGsOOilAuuh/ISKC8BjhMJGsZJ6Cl+ET2eQ+dyBOkU/uhFgpGLFEcuojNjBOkxdDYTKaOs9bH3QGItS9QOIZqBXMBPLhSwFrmo2swGZnEr8NnPtTGzvpIgO2aratQHSSCgTX8kQWCaR+vTSimjdN83nxV9xA/KqrYxUMyScW3HG8aSsBMa1NgaLZzOaXaMFEMgx1QbbAc2LQK2fewGFi1oQIcNYhBv5MK1BRcjOnEdarC0tt3tRH/H+nvIL/pe6F7lTWpIz1WKPakiezOaHgPkZdUOTwh8pQHUh1cv5LabW/F9P2pBAo3WGhVmMh2tdWDrimVatg50qeGMgEosYCPBDL1yt5JYrEj4LgqlwFPw7/0FugNhzPRcf6Ta4eMCLzvA6soEX/7MRvL5YlmrLjoKMuNSsVY7ZCJi3U+X/FiCqP0vuadE75i1pR/o8iY1iIFCULHNbF4Lz/QXOBltqm5TbbBAwVkBaQb1O7+9lrqaihITYkxEYj5sgcWzzCRNxvJ+6bMy4LH3YlYr21wRnxaYxHIsq3kz5XM6AlIZtvFngQVzgU3XNbPu2qYyJhN9dvJurnw9dUxMVMTkTZoBbmJSiZQDsMki4SheGSjQ5Qsp8/j7HfDpEMhGgbcc4Lqkx5c+sZZCvoiUNlGRayixwWmFDdcqiKwjsc3YxLWJLR19T8uk9UQAIQg3WUFfpsB/XShwygw+RGC+gn5l99VJgRzAHFCbr23i+ta5UUxom2qDmOaEqNpewjIywcWiLjm+jqw8lRXiV8OmtTz1zC6OBsYaCo53QOvEKcrDwLcdYJXn8IUt1+H7QVlMXFJAmZgM4rVHXzobaX1FACTQ1K5azClVwX90HqLHWANgVgcMl4DE5lm9Ao11oDY01rFpTbN1o8jfQwHD2lIW/GJS8AfVBDfQjAaaM55mSU6hqgKCGo3ruUhRcMcdvHEHsw/TVC2dT2L5Qr7z9E7eFyEwIJ7tgAemnGsJtCv4mYBcBWrb+iU01FbYGhHb8gaxAhZbhxlHTWoton19Rgf8W33AS+th0eKAh+bUcO/tH6a+ehEnuodQY/0Mv/8e+aODsF2Y0dxMdUsTz7y6n/8ZTDFuhO7vgHmXHZm2wz8LfN4BrgI+fctiqjynlE0+qCZQEAb8AskV4+STASrr4A079J1x+UarT9PmDaxddyNVlZVsa/guS5s2QDpF14FBBntS1JMnfSFPX1+BG2a4nOtqYs/eAXafHmIoEnhlB3R94Mi0zUwbl1aAWlXhsm1tc6kah5U5KlpmrQrC6Kocrb+3glmt13C8u0CtCiiOpRjuOU/63FlSmSSvL7+J/MxqChmfx5v/k2leLe54kQt9gjMODY5LrXZpUB6jvT5/9p0Mp/qD0ngWuKsDXvnAIbbNYjOBfgG3BlhdneCuVXPLKnB54Gvy84p86McuycJGcoMj+OkM3YeGkGweP1VgdCigSmBa1ueha6+hKqlZevYEH6kfYdEMl+uaPLycS5BSDPcJR44GPH80zytKqDwJc0agZoQn3oKvXvE03rpYo8BpIFENLE843LtyDo5M0RCKMNRU4OZnAsZ6k1T4PvmLmvSwIp9ymFPh0lTjQdph554MW1oqSSQ0dZWaRE4z60SOm6qEGRqCPLw7BscbwFsCugqyBeh/H0lfROkxzjHOz+jlbXz208WviGZck48V7Lx2OXBEQCpAtTqKbcsbcEVKk8fQxfJFYfvmDNs+6VAvCZqmuZB2IOtAxmGgJ2DnngzfPKv55a2gqmB6JdQloaYCqj2o8MCz/iNiDknyPmSLkC4io+Oo1Lgd1x/G53VaSXPqshaJxctKBYcEJAFqmaPYvKCWhoQzqf0eKWoOJjUXmjXzlgvzZgEZuNAD/3hSOFMJ2fnA9YZHpQczqmBaAqoroNKFhGv2a5gOn2IAOR8yRUjlYfQCFE4BDfTzHL/PKNuBEXUlJ0zt0GLnt7WANIHaNKuS5TUuxVjqVUoRCGS1kCpC1u50k47R7gsP+Lx6UEPSzGad2VBfC/UVUJuAqgRUuOCGVsEMrvIBZAMYPGuUQjNQARziNC9xPwHdVwTEJgAHOGrPTmQmqNVJh1uneyQcs0O8THFmZExo2ac43zWdh54foGtAoA4qF0PDfKithOoEVFn3KllFQ1HDuRNwpgej0jzQhzAdxZPcTZbdVwRkQvX/EbBFMCO+RcBHGxLMSSozyhFjmUkNX6DYf2+RNZshWXAZueiw5fk8qWpQLjSvhbrp1ioOePagRRR07YKBgmXWC0zHbJ8HKfIid5L7NYBMOBC6XcEbYg9dpgPXJBTtMxN4qtw6IoJyHZyqJIHn0eWNs2dBhqXL4I6Vis7DIo8fQWkXKucizU2oucvMLlAVYPebkJ0N1GE2G/OB83a9nb/kKE9R5MSvBWQCqOnA08BWAfFAzQLWV7tcX+fhKTsScx2cigSugsMX8+wfydOt4YI9J3SAcfj6gXUo6vkajeZMscaF3Djoq8zJDg5QQHBRnOUX/JBvAnuBPkD/X4CEKfo+gX9QMEuDVIFqAG6d5tFS7eB6Lj3jATuGCgwBw7EDVODnHtz9ujlkgnpWsJ4dNDKXuTag+4F6hGEUVfTyPb5OjjeAc4Tfu1z6/Q1i52+AR8WEDgnrBa71hGx09idihLi+EwbKDk0TQJF6NrOHFpYhCEUUHgHbeYJu/gVjzNErruy/CRj7A4M/EfhKnLhEIN7B/Pigp5NL/MigGTiLyx28wGru4Qjf5xgP8z5piGaA/y9ApgA2D/gSBlAS+K6Cf+qAw1dE4GngM0ArK+nm8JQ/JZhw/S9dtEONwVO5dQAAAABJRU5ErkJggg==);
 height: 50px;
 width: 100%;
 background-repeat: no-repeat;
}

#banner #black-text {
 font-size: 1.1em;
 color: white;
 padding: 0.5em 40px 0.4em 60px;
 line-height: 1.3em;
 text-align: center;
}
</style>
</p><div id="banner">
<a class="cn-full-banner-click" data-href="/wiki/Payments" href="../Payments.html" title="">
<div id="banner-logo"></div>
<div id="black-text">
Whonix requires payments to stay alive.
     </div>
</a>
</div>
</div></div></div> </div>
</div>
<div id="mw-js-message" style="display:none;"></div>
<div class="row">
<div class="large-12 columns" id="p-cactions">
<a class="button small secondary radius" data-dropdown="actions" data-options="align:left; is_hover: true; hover_timeout:700" href="#" id="actions-button"><i class="fa fa-cog"><span class="show-for-medium-up"> Actions</span></i></a>
<!--RTL -->
<ul class="f-dropdown" data-dropdown-content="" id="actions">
<li class="selected" id="ca-nstab-main"><a accesskey="c" data-href="/wiki/Dev/KVM" href="../Dev/KVM.html" title="View the content page [c]">Page</a></li><li class="new" id="ca-talk"><a accesskey="t" data-href="/w/index.php?title=Talk:Dev/KVM&amp;action=edit&amp;redlink=1" href="https://www.whonix.org/w/index.php?title=Talk:Dev/KVM&amp;action=edit&amp;redlink=1" rel="discussion.html" title="Discussion about the content page (page does not exist) [t]">Discussion</a></li><li id="ca-edit"><a accesskey="e" data-href="/w/index.php?title=Dev/KVM&amp;action=edit" href="https://www.whonix.org/w/index.php?title=Dev/KVM&amp;action=edit.html" title="Edit this page [e]">Edit</a></li><li id="ca-history"><a accesskey="h" data-href="/w/index.php?title=Dev/KVM&amp;action=history" href="https://www.whonix.org/w/index.php?title=Dev/KVM&amp;action=history.html" title="Past revisions of this page [h]">History</a></li> </ul>
<!--RTL -->
<div id="content">
<h1 class="title" id="firstHeading">Dev/KVM</h1>
<h5 class="subtitle" id="siteSub"><span class="subpages">&lt; <a class="mw-redirect" data-href="/wiki/Dev" href="../Dev.html" title="Dev">Dev</a></span></h5>
<div class="clear_both" id="contentSub"></div>
<div class="mw-bodytext" id="bodyContent">
<div class="mw-content-ltr" dir="ltr" id="mw-content-text" lang="en"><div class="mw-parser-output">
<p>
</p><p><br/>
</p>
<div class="toc" id="toc"><div class="toctitle" dir="ltr" lang="en"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Links"><span class="tocnumber">1</span> <span class="toctext">Links</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Continuous_Integration"><span class="tocnumber">2</span> <span class="toctext">Continuous Integration</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Blockers"><span class="tocnumber">3</span> <span class="toctext">Blockers</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Non-Blockers"><span class="tocnumber">4</span> <span class="toctext">Non-Blockers</span></a>
<ul>
<li class="toclevel-2 tocsection-5"><a href="#Image_Rebasing"><span class="tocnumber">4.1</span> <span class="toctext">Image Rebasing</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="#NAT_Port_Forwarding"><span class="tocnumber">4.2</span> <span class="toctext">NAT Port Forwarding</span></a></li>
<li class="toclevel-2 tocsection-7"><a href="#Virgl3D"><span class="tocnumber">4.3</span> <span class="toctext">Virgl3D</span></a></li>
<li class="toclevel-2 tocsection-8"><a href="#Audit_Output_of_virsh_domxml-to-native"><span class="tocnumber">4.4</span> <span class="toctext">Audit Output of virsh domxml-to-native</span></a></li>
<li class="toclevel-2 tocsection-9"><a href="#Kernel_Direct_Boot"><span class="tocnumber">4.5</span> <span class="toctext">Kernel Direct Boot</span></a></li>
<li class="toclevel-2 tocsection-10"><a href="#Hardware_side-channel_research"><span class="tocnumber">4.6</span> <span class="toctext">Hardware side-channel research</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-11"><a href="#In_Progress"><span class="tocnumber">5</span> <span class="toctext">In Progress</span></a></li>
<li class="toclevel-1 tocsection-12"><a href="#Done"><span class="tocnumber">6</span> <span class="toctext">Done</span></a>
<ul>
<li class="toclevel-2 tocsection-13"><a href="#clocksource"><span class="tocnumber">6.1</span> <span class="toctext">clocksource</span></a></li>
<li class="toclevel-2 tocsection-14"><a href="#Upcoming_XML_Changes_-_Stable_Next"><span class="tocnumber">6.2</span> <span class="toctext">Upcoming XML Changes - Stable Next</span></a></li>
<li class="toclevel-2 tocsection-15"><a href="#Apply_Clean-filter_traffic.3F"><span class="tocnumber">6.3</span> <span class="toctext">Apply Clean-filter traffic?</span></a></li>
<li class="toclevel-2 tocsection-16"><a href="#RNG"><span class="tocnumber">6.4</span> <span class="toctext">RNG</span></a>
<ul>
<li class="toclevel-3 tocsection-17"><a href="#Rate_limit"><span class="tocnumber">6.4.1</span> <span class="toctext">Rate limit</span></a></li>
<li class="toclevel-3 tocsection-18"><a href="#Haveged"><span class="tocnumber">6.4.2</span> <span class="toctext">Haveged</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-19"><a href="#blkiotune"><span class="tocnumber">6.5</span> <span class="toctext">blkiotune</span></a></li>
<li class="toclevel-2 tocsection-20"><a href="#Secure_Clipboard"><span class="tocnumber">6.6</span> <span class="toctext">Secure Clipboard</span></a></li>
<li class="toclevel-2 tocsection-21"><a href="#Biometric_Fingerprinting"><span class="tocnumber">6.7</span> <span class="toctext">Biometric Fingerprinting</span></a>
<ul>
<li class="toclevel-3 tocsection-22"><a href="#Mouse_Tracking"><span class="tocnumber">6.7.1</span> <span class="toctext">Mouse Tracking</span></a></li>
<li class="toclevel-3 tocsection-23"><a href="#Solutions"><span class="tocnumber">6.7.2</span> <span class="toctext">Solutions</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-24"><a href="#CPU_Masking"><span class="tocnumber">6.8</span> <span class="toctext">CPU Masking</span></a></li>
<li class="toclevel-2 tocsection-25"><a href="#Passed_to_Command_Line"><span class="tocnumber">6.9</span> <span class="toctext">Passed to Command Line</span></a></li>
<li class="toclevel-2 tocsection-26"><a href="#Haveged_test_for_KVM_.2B_virtio-rng_Result"><span class="tocnumber">6.10</span> <span class="toctext">Haveged test for KVM + virtio-rng Result</span></a></li>
<li class="toclevel-2 tocsection-27"><a href="#Two_Separate_Whonix-Gateway.27s"><span class="tocnumber">6.11</span> <span class="toctext">Two Separate Whonix-Gateway's</span></a></li>
<li class="toclevel-2 tocsection-28"><a href="#Preserve_Comments_in_libvirt_.2F_virsh_XML_Files"><span class="tocnumber">6.12</span> <span class="toctext">Preserve Comments in libvirt / virsh XML Files</span></a></li>
<li class="toclevel-2 tocsection-29"><a href="#Activate_Watchdog.3F"><span class="tocnumber">6.13</span> <span class="toctext">Activate Watchdog?</span></a></li>
<li class="toclevel-2 tocsection-30"><a href="#Add_pvspinlock_when_supported_in_more_recent_version_of_libvirt"><span class="tocnumber">6.14</span> <span class="toctext">Add pvspinlock when supported in more recent version of libvirt</span></a></li>
<li class="toclevel-2 tocsection-31"><a href="#Preconfigured_Shared_Folders"><span class="tocnumber">6.15</span> <span class="toctext">Preconfigured Shared Folders</span></a></li>
<li class="toclevel-2 tocsection-32"><a href="#Kernel_Samepage_Merging_.28KSM.29"><span class="tocnumber">6.16</span> <span class="toctext">Kernel Samepage Merging (KSM)</span></a></li>
<li class="toclevel-2 tocsection-33"><a href="#Pass_qemu_commands_via_libvirt.3F"><span class="tocnumber">6.17</span> <span class="toctext">Pass qemu commands via libvirt?</span></a></li>
<li class="toclevel-2 tocsection-34"><a href="#memory_balloon"><span class="tocnumber">6.18</span> <span class="toctext">memory balloon</span></a></li>
<li class="toclevel-2 tocsection-35"><a href="#SPICE_security_implications"><span class="tocnumber">6.19</span> <span class="toctext">SPICE security implications</span></a></li>
<li class="toclevel-2 tocsection-36"><a href="#How_to_check_if_virtio_storage_access_is_in_use_or_an_eventually_existing_fallback_driver.3F"><span class="tocnumber">6.20</span> <span class="toctext">How to check if virtio storage access is in use or an eventually existing fallback driver?</span></a>
<ul>
<li class="toclevel-3 tocsection-37"><a href="#Question"><span class="tocnumber">6.20.1</span> <span class="toctext">Question</span></a></li>
<li class="toclevel-3 tocsection-38"><a href="#Asked_on_unix.stackexchange"><span class="tocnumber">6.20.2</span> <span class="toctext">Asked on unix.stackexchange</span></a></li>
<li class="toclevel-3 tocsection-39"><a href="#lsmod_won.27t_help"><span class="tocnumber">6.20.3</span> <span class="toctext">lsmod won't help</span></a></li>
<li class="toclevel-3 tocsection-40"><a href="#modinfo_won.27t_help"><span class="tocnumber">6.20.4</span> <span class="toctext">modinfo won't help</span></a></li>
<li class="toclevel-3 tocsection-41"><a href="#ls_Test"><span class="tocnumber">6.20.5</span> <span class="toctext">ls Test</span></a></li>
<li class="toclevel-3 tocsection-42"><a href="#hwinfo_Test"><span class="tocnumber">6.20.6</span> <span class="toctext">hwinfo Test</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-43"><a href="#How_to_check_if_virtio_network_is_really_in_use_or_an_eventually_existing_fallback_driver.3F"><span class="tocnumber">6.21</span> <span class="toctext">How to check if virtio network is really in use or an eventually existing fallback driver?</span></a></li>
<li class="toclevel-2 tocsection-44"><a href="#How_to_enable_AppArmor_.2F_SELinux_for_KVM_on_Debian.3F"><span class="tocnumber">6.22</span> <span class="toctext">How to enable AppArmor / SELinux for KVM on Debian?</span></a></li>
<li class="toclevel-2 tocsection-45"><a href="#Set_cluster_size_512_-_2MB_for_better_performance.3F"><span class="tocnumber">6.23</span> <span class="toctext">Set cluster_size 512 - 2MB for better performance?</span></a></li>
<li class="toclevel-2 tocsection-46"><a href="#Exporting.2FCloning_of_virtual_machines"><span class="tocnumber">6.24</span> <span class="toctext">Exporting/Cloning of virtual machines</span></a></li>
<li class="toclevel-2 tocsection-47"><a href="#management_tools"><span class="tocnumber">6.25</span> <span class="toctext">management tools</span></a></li>
<li class="toclevel-2 tocsection-48"><a href="#Nested_Virtualization"><span class="tocnumber">6.26</span> <span class="toctext">Nested Virtualization</span></a></li>
<li class="toclevel-2 tocsection-49"><a href="#qemu_i386_support"><span class="tocnumber">6.27</span> <span class="toctext">qemu i386 support</span></a></li>
<li class="toclevel-2 tocsection-50"><a href="#Disable_Microphone_Input"><span class="tocnumber">6.28</span> <span class="toctext">Disable Microphone Input</span></a></li>
<li class="toclevel-2 tocsection-51"><a href="#Document:_how_to_leave_KVM_when_no_X_is_running.3F"><span class="tocnumber">6.29</span> <span class="toctext">Document: how to leave KVM when no X is running?</span></a></li>
<li class="toclevel-2 tocsection-52"><a href="#Audio_Retasking"><span class="tocnumber">6.30</span> <span class="toctext">Audio Retasking</span></a></li>
<li class="toclevel-2 tocsection-53"><a href="#libguestfs_import.2Fexport_feature_request"><span class="tocnumber">6.31</span> <span class="toctext">libguestfs import/export feature request</span></a></li>
<li class="toclevel-2 tocsection-54"><a href="#virt-manager_import.2Fexport_feature_request"><span class="tocnumber">6.32</span> <span class="toctext">virt-manager import/export feature request</span></a></li>
<li class="toclevel-2 tocsection-55"><a href="#virt-v2v"><span class="tocnumber">6.33</span> <span class="toctext">virt-v2v</span></a>
<ul>
<li class="toclevel-3 tocsection-56"><a href="#How_to_install_virt-v2v_on_Debian.3F"><span class="tocnumber">6.33.1</span> <span class="toctext">How to install virt-v2v on Debian?</span></a></li>
<li class="toclevel-3 tocsection-57"><a href="#Can_we_copy_and_paste_virt-v2v_in_meanwhile.3F"><span class="tocnumber">6.33.2</span> <span class="toctext">Can we copy and paste virt-v2v in meanwhile?</span></a></li>
<li class="toclevel-3 tocsection-58"><a href="#How_to_export_a_VM_using_virt-v2v.3F"><span class="tocnumber">6.33.3</span> <span class="toctext">How to export a VM using virt-v2v?</span></a></li>
<li class="toclevel-3 tocsection-59"><a href="#How_to_export_a_VM_using_virt-v2v.3F_2"><span class="tocnumber">6.33.4</span> <span class="toctext">How to export a VM using virt-v2v?</span></a></li>
<li class="toclevel-3 tocsection-60"><a href="#Closed"><span class="tocnumber">6.33.5</span> <span class="toctext">Closed</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-61"><a href="#Shared_Folder"><span class="tocnumber">6.34</span> <span class="toctext">Shared Folder</span></a></li>
<li class="toclevel-2 tocsection-62"><a href="#Script.2Fautomate_creation_and_upload_of_raw_images.3F"><span class="tocnumber">6.35</span> <span class="toctext">Script/automate creation and upload of raw images?</span></a></li>
<li class="toclevel-2 tocsection-63"><a href="#write_generic_import_script"><span class="tocnumber">6.36</span> <span class="toctext">write generic import script</span></a></li>
<li class="toclevel-2 tocsection-64"><a href="#Script.2Fautomate_creation_of_VM_description_files.3F"><span class="tocnumber">6.37</span> <span class="toctext">Script/automate creation of VM description files?</span></a></li>
<li class="toclevel-2 tocsection-65"><a href="#How_to_add_a_random_time_offset.3F"><span class="tocnumber">6.38</span> <span class="toctext">How to add a random time offset?</span></a></li>
<li class="toclevel-2 tocsection-66"><a href="#xml_does_not_validate"><span class="tocnumber">6.39</span> <span class="toctext">xml does not validate</span></a></li>
<li class="toclevel-2 tocsection-67"><a href="#Run_virt-xml-validate_during_build_process"><span class="tocnumber">6.40</span> <span class="toctext">Run virt-xml-validate during build process</span></a></li>
<li class="toclevel-2 tocsection-68"><a href="#Weaker_warning_against_KVM_in_whonixcheck"><span class="tocnumber">6.41</span> <span class="toctext">Weaker warning against KVM in whonixcheck</span></a></li>
<li class="toclevel-2 tocsection-69"><a href="#Leak_Tests.3F"><span class="tocnumber">6.42</span> <span class="toctext">Leak Tests?</span></a></li>
<li class="toclevel-2 tocsection-70"><a href="#Hardware_serials.3F"><span class="tocnumber">6.43</span> <span class="toctext">Hardware serials?</span></a></li>
<li class="toclevel-2 tocsection-71"><a href="#How_to_Edit_in_nano_with_virsh.3F"><span class="tocnumber">6.44</span> <span class="toctext">How to Edit in nano with virsh?</span></a></li>
<li class="toclevel-2 tocsection-72"><a href="#whonixcheck_KVMClock"><span class="tocnumber">6.45</span> <span class="toctext">whonixcheck KVMClock</span></a></li>
<li class="toclevel-2 tocsection-73"><a href="#Is_it_possible_to_add_64.2C_128_or_even_more_MB_to_the_virtual_graphics_card_using_the_command_line_to_boost_graphics_performance.3F"><span class="tocnumber">6.46</span> <span class="toctext">Is it possible to add 64, 128 or even more MB to the virtual graphics card using the command line to boost graphics performance?</span></a></li>
<li class="toclevel-2 tocsection-74"><a href="#KVM_Instructions_recommend_to_use_a_no_cache_policy.3F"><span class="tocnumber">6.47</span> <span class="toctext">KVM Instructions recommend to use a no cache policy?</span></a></li>
<li class="toclevel-2 tocsection-75"><a href="#Script.2Fautomate_creation_and_upload_of_qcow2_images.3F"><span class="tocnumber">6.48</span> <span class="toctext">Script/automate creation and upload of qcow2 images?</span></a></li>
<li class="toclevel-2 tocsection-76"><a href="#Verifiable_Builds_for_qcow2_images"><span class="tocnumber">6.49</span> <span class="toctext">Verifiable Builds for qcow2 images</span></a></li>
<li class="toclevel-2 tocsection-77"><a href="#metadata_preallocated_images"><span class="tocnumber">6.50</span> <span class="toctext">metadata preallocated images</span></a></li>
<li class="toclevel-2 tocsection-78"><a href="#qcow2_compression"><span class="tocnumber">6.51</span> <span class="toctext">qcow2 compression</span></a></li>
<li class="toclevel-2 tocsection-79"><a href="#How_to_disable_KVMClock.3F"><span class="tocnumber">6.52</span> <span class="toctext">How to disable KVMClock?</span></a></li>
<li class="toclevel-2 tocsection-80"><a href="#Fix_subnet_range_in_KVM_instructions"><span class="tocnumber">6.53</span> <span class="toctext">Fix subnet range in KVM instructions</span></a></li>
<li class="toclevel-2 tocsection-81"><a href="#Readme_Commands_and_Warnings"><span class="tocnumber">6.54</span> <span class="toctext">Readme Commands and Warnings</span></a></li>
<li class="toclevel-2 tocsection-82"><a href="#Leak"><span class="tocnumber">6.55</span> <span class="toctext">Leak</span></a></li>
<li class="toclevel-2 tocsection-83"><a href="#Instructions_include_how_to_set_clock_to_UTC.3F"><span class="tocnumber">6.56</span> <span class="toctext">Instructions include how to set clock to UTC?</span></a></li>
<li class="toclevel-2 tocsection-84"><a href="#How_to_use_-rtc_clock.3Dvm_.3F"><span class="tocnumber">6.57</span> <span class="toctext">How to use -rtc clock=vm ?</span></a></li>
<li class="toclevel-2 tocsection-85"><a href="#What_is_timer_pit.3F"><span class="tocnumber">6.58</span> <span class="toctext">What is timer pit?</span></a></li>
<li class="toclevel-2 tocsection-86"><a href="#virt-image"><span class="tocnumber">6.59</span> <span class="toctext">virt-image</span></a>
<ul>
<li class="toclevel-3 tocsection-87"><a href="#Users_Expected_Scenario"><span class="tocnumber">6.59.1</span> <span class="toctext">Users Expected Scenario</span></a></li>
<li class="toclevel-3 tocsection-88"><a href="#xml_creation"><span class="tocnumber">6.59.2</span> <span class="toctext">xml creation</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-89"><a href="#How_to_get_virtio_running_for_storage.3F"><span class="tocnumber">6.60</span> <span class="toctext">How to get virtio running for storage?</span></a>
<ul>
<li class="toclevel-3 tocsection-90"><a href="#Initial_Instructions"><span class="tocnumber">6.60.1</span> <span class="toctext">Initial Instructions</span></a></li>
<li class="toclevel-3 tocsection-91"><a href="#Using_LABELs"><span class="tocnumber">6.60.2</span> <span class="toctext">Using LABELs</span></a></li>
<li class="toclevel-3 tocsection-92"><a href="#Using_UUIDs"><span class="tocnumber">6.60.3</span> <span class="toctext">Using UUIDs</span></a></li>
<li class="toclevel-3 tocsection-93"><a href="#.2Fboot.2Fgrub.2Fgrub.cfg_issue"><span class="tocnumber">6.60.4</span> <span class="toctext">/boot/grub/grub.cfg issue</span></a></li>
<li class="toclevel-3 tocsection-94"><a href="#System_gets_unbootable.3F"><span class="tocnumber">6.60.5</span> <span class="toctext">System gets unbootable?</span></a></li>
<li class="toclevel-3 tocsection-95"><a href="#Virtio_Block_Latency"><span class="tocnumber">6.60.6</span> <span class="toctext">Virtio Block Latency</span></a></li>
<li class="toclevel-3 tocsection-96"><a href="#Well_what.27ya_know_It_is_a_bug.21"><span class="tocnumber">6.60.7</span> <span class="toctext">Well what'ya know It is a bug!</span></a></li>
<li class="toclevel-3 tocsection-97"><a href="#Solved"><span class="tocnumber">6.60.8</span> <span class="toctext">Solved</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-98"><a href="#Enable_virtio_by_default.3F"><span class="tocnumber">6.61</span> <span class="toctext">Enable virtio by default?</span></a></li>
<li class="toclevel-2 tocsection-99"><a href="#Boot_from_virtio_block_device.3F"><span class="tocnumber">6.62</span> <span class="toctext">Boot from virtio block device?</span></a></li>
<li class="toclevel-2 tocsection-100"><a href="#Disable_Microphone_Feature_Request"><span class="tocnumber">6.63</span> <span class="toctext">Disable Microphone Feature Request</span></a></li>
<li class="toclevel-2 tocsection-101"><a href="#Debian_Network_NAT_Issue"><span class="tocnumber">6.64</span> <span class="toctext">Debian Network NAT Issue</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-102"><a href="#Archived_Discussions"><span class="tocnumber">7</span> <span class="toctext">Archived Discussions</span></a></li>
<li class="toclevel-1 tocsection-103"><a href="#Archived_IRC_Logs"><span class="tocnumber">8</span> <span class="toctext">Archived IRC Logs</span></a></li>
<li class="toclevel-1 tocsection-104"><a href="#Footnotes"><span class="tocnumber">9</span> <span class="toctext">Footnotes</span></a></li>
</ul>
</div>
<h1><span class="mw-headline" id="Links">Links</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=1" href="https://www.whonix.org/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=1.html" title="Edit section: Links">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<ul><li><a data-href="/wiki/KVM" href="../KVM.html" title="KVM">Whonix KVM documentation</a></li>
<li><a class="external text" data-href="https://phabricator.whonix.org/project/board/16/" href="https://phabricator.whonix.org/project/board/16/" rel="noreferrer noopener" target="_blank">KVM workboard</a></li>
<li><a class="external text" data-href="https://phabricator.whonix.org/maniphest/query/qmC_a5t_IZ13/#R" href="https://phabricator.whonix.org/maniphest/query/qmC_a5t_IZ13/" rel="noreferrer noopener" target="_blank">KVM Whonix Bug Tracker</a></li>
<li><a class="external text" data-href="https://github.com/Whonix/whonix-libvirt" href="https://github.com/Whonix/whonix-libvirt" rel="noreferrer noopener" target="_blank">whonix-libvirt github</a></li></ul>
<h1><span class="mw-headline" id="Continuous_Integration">Continuous Integration</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=2" href="https://www.whonix.org/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=2.html" title="Edit section: Continuous Integration">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<ul><li><a class="external text" data-href="https://travis-ci.org/Whonix/whonix-libvirt" href="https://travis-ci.org/Whonix/whonix-libvirt" rel="noreferrer noopener" target="_blank">Travis CI</a></li>
<li><a class="external text" data-href="https://www.whonix.org/old-forum/index.php/topic,829.0.html" href="https://www.whonix.org/old-forum/index.php/topic,829.0.html" rel="noreferrer noopener" target="_blank">forum thread</a></li></ul>
<h1><span class="mw-headline" id="Blockers">Blockers</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=3" href="https://www.whonix.org/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=3.html" title="Edit section: Blockers">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<p>None.
</p>
<h1><span class="mw-headline" id="Non-Blockers">Non-Blockers</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=4" href="https://www.whonix.org/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=4.html" title="Edit section: Non-Blockers">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<h2><span class="mw-headline" id="Image_Rebasing">Image Rebasing</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=5" href="https://www.whonix.org/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=5.html" title="Edit section: Image Rebasing">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p><a class="external free" data-href="https://www.suse.com/documentation/sles11/book_kvm/data/cha_qemu_guest_inst_qemu-img.html" href="https://www.suse.com/documentation/sles11/book_kvm/data/cha_qemu_guest_inst_qemu-img.html" rel="noreferrer noopener" target="_blank">https://www.suse.com/documentation/sles11/book_kvm/data/cha_qemu_guest_inst_qemu-img.html</a>
<a class="external free" data-href="http://nairobi-embedded.org/manipulating_disk_images_with_qemu-img.html#working-with-base-and-derived-images" href="http://nairobi-embedded.org/manipulating_disk_images_with_qemu-img.html" rel="noreferrer noopener" target="_blank">http://nairobi-embedded.org/manipulating_disk_images_with_qemu-img.html#working-with-base-and-derived-images</a>
</p><p>Play with image rebasing. Advantages: disk space savings, one time update for all derived images.
</p><p>This feature can be used to create what Qubes calls "templates".
</p>
<h2><span class="mw-headline" id="NAT_Port_Forwarding">NAT Port Forwarding</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=6" href="https://www.whonix.org/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=6.html" title="Edit section: NAT Port Forwarding">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Instructions for port forwarding to GW. Useful if configuring GW as Tor relay. Relevant if
/when this is supported in Whonix
</p><p><a class="external free" data-href="http://wiki.libvirt.org/page/Networking#Forwarding_Incoming_Connections" href="http://wiki.libvirt.org/page/Networking" rel="noreferrer noopener" target="_blank">http://wiki.libvirt.org/page/Networking#Forwarding_Incoming_Connections</a>
</p>
<h2><span class="mw-headline" id="Virgl3D">Virgl3D</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=7" href="https://www.whonix.org/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=7.html" title="Edit section: Virgl3D">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Blog gives complete minimum requirements and settings needed to enable. Check Stretch package versions after freeze and determine if its supported or not. Document how to enable 3D on wiki.
</p><p><a class="external free" data-href="https://www.kraxel.org/blog/2016/09/using-virtio-gpu-with-libvirt-and-spice/" href="https://www.kraxel.org/blog/2016/09/using-virtio-gpu-with-libvirt-and-spice/" rel="noreferrer noopener" target="_blank">https://www.kraxel.org/blog/2016/09/using-virtio-gpu-with-libvirt-and-spice/</a>
</p><p><a class="external free" data-href="https://forums.whonix.org/t/canvas-fingerprints-identical-across-different-pcs-running-whonix/3310" href="https://forums.whonix.org/t/canvas-fingerprints-identical-across-different-pcs-running-whonix/3310" rel="noreferrer noopener" target="_blank">https://forums.whonix.org/t/canvas-fingerprints-identical-across-different-pcs-running-whonix/3310</a>
</p><p>"VMs with the same or related OS have the same canvas fingerprint. So Firefox in all Debian, Ubuntu etc VMs have the same fingerprint. Tor browser blocks fingerprinting, but Iceweasel doesn't. But if some bug allowed canvas fingerprinting in Whonix Tor browser, it would be the same as Firefox in another Debian-related VM."
</p><p>Asked upstream for help testing this:
</p><p><a class="external free" data-href="https://www.redhat.com/archives/libvir-list/2016-December/msg01157.html" href="https://www.redhat.com/archives/libvir-list/2016-December/msg01157.html" rel="noreferrer noopener" target="_blank">https://www.redhat.com/archives/libvir-list/2016-December/msg01157.html</a>
</p><p><br/>
Given that the 3D enabled virtio-gpu is also a virtual GPU it should show the same model for all guests and therefore I predict it will be the same as with results of virtualized graphics without this feature.
</p><p><a class="external free" data-href="https://www.redhat.com/archives/libvir-list/2017-January/msg00296.html" href="https://www.redhat.com/archives/libvir-list/2017-January/msg00296.html" rel="noreferrer noopener" target="_blank">https://www.redhat.com/archives/libvir-list/2017-January/msg00296.html</a>
</p>
<h2><span class="mw-headline" id="Audit_Output_of_virsh_domxml-to-native">Audit Output of virsh domxml-to-native</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=8" href="https://www.whonix.org/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=8.html" title="Edit section: Audit Output of virsh domxml-to-native">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<pre>virsh domxml-to-native qemu-argv ./usr/share/whonix-libvirt/xml/Whonix-Gateway_qemu.xml
</pre>
<pre>LC_ALL=C PATH=/usr/local/sbin:/usr/local/bin:/usr/bin:/usr/sbin:/sbin:/bin QEMU_AUDIO_DRV=spice /usr/bin/qemu-system-x86_64 -name Whonix-Gateway -machine ubuntu,accel=tcg,usb=off -cpu qemu64,-kvmclock,+kvm_pv_eoi,+kvm_pv_unhalt -m 512 -realtime mlock=off -smp 1,sockets=1,cores=1,threads=1 -uuid d67e18a8-ea3c-4c6d-81eb-99a6324506a6 -no-user-config -nodefaults -chardev socket,id=charmonitor,path=/var/lib/libvirt/qemu/Whonix-Gateway.monitor,server,nowait -mon chardev=charmonitor,id=monitor,mode=control -rtc base=utc,clock=vm,driftfix=slew -global kvm-pit.lost_tick_policy=discard -no-hpet -no-shutdown -global PIIX4_PM.disable_s3=1 -global PIIX4_PM.disable_s4=1 -boot strict=on -device piix3-usb-uhci,id=usb,bus=pci.0,addr=0x1.0x2 -device virtio-serial-pci,id=virtio-serial0,bus=pci.0,addr=0x6 -drive file=/var/lib/libvirt/images/Whonix-Gateway.qcow2,if=none,id=drive-virtio-disk0,format=qcow2 -device virtio-blk-pci,scsi=off,bus=pci.0,addr=0x7,drive=drive-virtio-disk0,id=virtio-disk0,bootindex=1 -netdev tap,id=hostnet0 -device virtio-net-pci,netdev=hostnet0,id=net0,mac=52:54:00:6d:37:bc,bus=pci.0,addr=0x3 -netdev tap,id=hostnet1 -device virtio-net-pci,netdev=hostnet1,id=net1,mac=52:54:00:ac:89:1e,bus=pci.0,addr=0x4 -chardev spicevmc,id=charchannel0,name=vdagent -device virtserialport,bus=virtio-serial0.0,nr=1,chardev=charchannel0,id=channel0,name=com.redhat.spice.0 -device usb-tablet,id=input0 -spice port=5901,addr=127.0.0.1,disable-ticketing,disable-copy-paste,disable-agent-file-xfer,seamless-migration=on -device qxl-vga,id=video0,ram_size=262144000,vram_size=262144000,bus=pci.0,addr=0x2 -device intel-hda,id=sound0,bus=pci.0,addr=0x5 -device hda-duplex,id=sound0-codec0,bus=sound0.0,cad=0 -device virtio-balloon-pci,id=balloon0,bus=pci.0,addr=0x8 -object rng-random,id=rng0,filename=/dev/random -device virtio-rng-pci,rng=rng0,bus=pci.0,addr=0x9 -msg timestamp=on
</pre>
<p>Same but rewritten for better readability.
</p>
<pre>LC_ALL=C \
PATH=/usr/local/sbin:/usr/local/bin:/usr/bin:/usr/sbin:/sbin:/bin \
QEMU_AUDIO_DRV=spice \
/usr/bin/qemu-system-x86_64 \
-name Whonix-Gateway \
-machine ubuntu,accel=tcg,usb=off \
-cpu qemu64,-kvmclock,+kvm_pv_eoi,+kvm_pv_unhalt \
-m 512 \
-realtime mlock=off  \
-smp 1,sockets=1,cores=1,threads=1 \
-uuid d67e18a8-ea3c-4c6d-81eb-99a6324506a6 \
-no-user-config \
-nodefaults \
-chardev socket,id=charmonitor,path=/var/lib/libvirt/qemu/Whonix-Gateway.monitor,server,nowait \
-mon chardev=charmonitor,id=monitor,mode=control \
-rtc base=utc,clock=vm,driftfix=slew \
-global kvm-pit.lost_tick_policy=discard \
-no-hpet \
-no-shutdown \
-global PIIX4_PM.disable_s3=1 \
-global PIIX4_PM.disable_s4=1 \
-boot strict=on \
-device piix3-usb-uhci,id=usb,bus=pci.0,addr=0x1.0x2 \
-device virtio-serial-pci,id=virtio-serial0,bus=pci.0,addr=0x6 \
-drive file=/var/lib/libvirt/images/Whonix-Gateway.qcow2,if=none,id=drive-virtio-disk0,format=qcow2 \
-device virtio-blk-pci,scsi=off,bus=pci.0,addr=0x7,drive=drive-virtio-disk0,id=virtio-disk0,bootindex=1 \
-netdev tap,id=hostnet0 \
-device virtio-net-pci,netdev=hostnet0,id=net0,mac=52:54:00:6d:37:bc,bus=pci.0,addr=0x3 \
-netdev tap,id=hostnet1 \
-device virtio-net-pci,netdev=hostnet1,id=net1,mac=52:54:00:ac:89:1e,bus=pci.0,addr=0x4 \
-chardev spicevmc,id=charchannel0,name=vdagent \
-device virtserialport,bus=virtio-serial0.0,nr=1,chardev=charchannel0,id=channel0,name=com.redhat.spice.0 \
-device usb-tablet,id=input0 \
-spice port=5901,addr=127.0.0.1,disable-ticketing,disable-copy-paste,disable-agent-file-xfer,seamless-migration=on \
-device qxl-vga,id=video0,ram_size=262144000,vram_size=262144000,bus=pci.0,addr=0x2 \
-device intel-hda,id=sound0,bus=pci.0,addr=0x5 \
-device hda-duplex,id=sound0-codec0,bus=sound0.0,cad=0 \
-device virtio-balloon-pci,id=balloon0,bus=pci.0,addr=0x8 \
-object rng-random,id=rng0,filename=/dev/random \
-device virtio-rng-pci,rng=rng0,bus=pci.0,addr=0x9 \
-msg timestamp=on
</pre>
<p>Does it look sense? Do we understand all of it? Is there anything we should change?
</p><p>HulaHoop: Output makes sense. Needs to be updated because of recent config changes. Some upcoming.
</p><p>See <a class="external text" data-href="https://travis-ci.org/Whonix/whonix-libvirt" href="https://travis-ci.org/Whonix/whonix-libvirt" rel="noreferrer noopener" target="_blank">CI log</a> for output of running against other xml files.
</p>
<h2><span class="mw-headline" id="Kernel_Direct_Boot">Kernel Direct Boot</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=9" href="https://www.whonix.org/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=9.html" title="Edit section: Kernel Direct Boot">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Minor importance.
</p><p>Document how to do a kernel direct boot. For passing special options for debugging options such as disabling apparmor in kernel. Interesting, because even if grub was broken for some reason, VM would still be bootable.
</p><p>HulaHoop: There is an example here: <a class="external free" data-href="https://libvirt.org/formatdomain.html#elementsOSKernel" href="https://libvirt.org/formatdomain.html" rel="noreferrer noopener" target="_blank">https://libvirt.org/formatdomain.html#elementsOSKernel</a>  feel free to change it to suit Whonix.
</p>
<h2><span class="mw-headline" id="Hardware_side-channel_research">Hardware side-channel research</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=10" href="https://www.whonix.org/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=10.html" title="Edit section: Hardware side-channel research">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Ongoing. Interesting developments worth watching out for at <a class="external free" data-href="https://gruss.cc" href="https://gruss.cc" rel="noreferrer noopener" target="_blank">https://gruss.cc</a>
</p>
<h1><span class="mw-headline" id="In_Progress">In Progress</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=11" href="https://www.whonix.org/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=11.html" title="Edit section: In Progress">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<p>None.
</p>
<h1><span class="mw-headline" id="Done">Done</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=12" href="https://www.whonix.org/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=12.html" title="Edit section: Done">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<h2><span class="mw-headline" id="clocksource">clocksource</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=13" href="https://www.whonix.org/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=13.html" title="Edit section: clocksource">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<pre>cat /sys/devices/system/clocksource/clocksource0/available_clocksource
</pre>
<pre>refined-jiffies jiffies
</pre>
<pre>cat /sys/devices/system/clocksource/clocksource0/current_clocksource
</pre>
<pre>refined-jiffies
</pre>
<p><a class="external free" data-href="https://forums.whonix.org/t/available-clocksource-current-clocksource" href="https://forums.whonix.org/t/available-clocksource-current-clocksource" rel="noreferrer noopener" target="_blank">https://forums.whonix.org/t/available-clocksource-current-clocksource</a>
</p>
<h2><span class="mw-headline" id="Upcoming_XML_Changes_-_Stable_Next">Upcoming XML Changes - Stable Next</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=14" href="https://www.whonix.org/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=14.html" title="Edit section: Upcoming XML Changes - Stable Next">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>When Stretch hits stable disable:
</p><p>smm which is not even supported by qemu yet.
</p><p>Check if switch to virtio-input devices means virtio=serial can now be removed.
</p>
<h2><span id="Apply_Clean-filter_traffic?"></span><span class="mw-headline" id="Apply_Clean-filter_traffic.3F">Apply Clean-filter traffic?</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=15" href="https://www.whonix.org/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=15.html" title="Edit section: Apply Clean-filter traffic?">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Advantages are its easy to set a new IP for a new WS. Has many rules to prevent MAC, IP, ARP spoofing. Can also protect the GW from DoS by using connection tracking and rate-limiting.
</p><p>Sounds good but I still think a completely separate internal network is the best option to ensure separartion between multi WSs. The GW should be able to withstand DoS on its own or there will be big problems. I think its safer if libvirt knows nothing about the traffic on the internal network and does not parse anything on there.
</p><p>To have a multi-WS implementation with different internal networks likely requires a big effort on the Whonix development side. Not worth it when setting a new GW is easy and costs little resources - also provides more assurance against theoretical attacks on a shared GW.
</p>
<h2><span class="mw-headline" id="RNG">RNG</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=16" href="https://www.whonix.org/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=16.html" title="Edit section: RNG">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<h3><span class="mw-headline" id="Rate_limit">Rate limit</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=17" href="https://www.whonix.org/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=17.html" title="Edit section: Rate limit">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>This is necessary to prevent malicious entropy starvation of other VMs and the host.
</p><p>Test code for /dev/random throughput<sup class="reference" id="cite_ref-1"><a href="#cite_note-1">[1]</a></sup>
</p>
<pre>dd if=/dev/random bs=1k count=1</pre>
<p>Re-reading the article it seems the choice made is OK. The limit sets the max a guest can use to be 25% of that of the host.
</p>
<pre>/dev/random provides high quality numbers but stops when entropy is poor: the Linux kernel keeps a entropy pool of 4 KB (see /proc/sys/kernel/random/poolsize); when the pool is empty, the kernel blocks causing a delay until it can provide the requested random numbers.
</pre>
<p><a class="external free" data-href="https://www.certdepot.net/rhel7-get-started-random-number-generator/" href="https://www.certdepot.net/rhel7-get-started-random-number-generator/" rel="noreferrer noopener" target="_blank">https://www.certdepot.net/rhel7-get-started-random-number-generator/</a>
</p>
<pre>Note: Just after &lt;rng model=’virtio’&gt;, you can add a line like &lt;rate bytes=’1024′ period=’1000’/&gt; to prevent a guest from consuming more than 1 KB per second of pseudo random numbers. Otherwise, one single guest could consume all the available pseudo random numbers at the expense of all the others.
</pre>
<p>Also applied for GW since some crypto requiring operations under the control of WS processes can abuse the entropy available to it if unchecked.
</p>
<h3><span class="mw-headline" id="Haveged">Haveged</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=18" href="https://www.whonix.org/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=18.html" title="Edit section: Haveged">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Cross-posted
</p>
<pre>   haveged relies on the RDTSC instruction, that apparently is useless in some virtualized environments. Also, the quality of random numbers output by HAVEGE is unclear, and the topic of many discussions.
</pre>
<p><a class="external free" data-href="https://tails.boum.org/contribute/design/random/#rngd" href="https://tails.boum.org/contribute/design/random/" rel="noreferrer noopener" target="_blank">https://tails.boum.org/contribute/design/random/#rngd</a>
</p><p>haveged is not useful on KVM 
</p><p>rdtsc or any tsc counter provides very accurate clock tick information so better to block.
</p>
<h2><span class="mw-headline" id="blkiotune">blkiotune</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=19" href="https://www.whonix.org/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=19.html" title="Edit section: blkiotune">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Its possible to limit IO throughput per VM however with disk speeds varying a lot it will be impossible to find an option that makes sense for everybody. Nonetheless still interesting to have. Documented below is a IO test and how to set limits.
</p><p><a class="external free" data-href="https://fedoraproject.org/wiki/QA:Testcase_Virtualization_IO_Throttling" href="https://fedoraproject.org/wiki/QA:Testcase_Virtualization_IO_Throttling" rel="noreferrer noopener" target="_blank">https://fedoraproject.org/wiki/QA:Testcase_Virtualization_IO_Throttling</a>
</p>
<h2><span class="mw-headline" id="Secure_Clipboard">Secure Clipboard</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=20" href="https://www.whonix.org/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=20.html" title="Edit section: Secure Clipboard">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p><a class="external free" data-href="https://bugzilla.redhat.com/show_bug.cgi?id=1320263" href="https://bugzilla.redhat.com/show_bug.cgi?id=1320263" rel="noreferrer noopener" target="_blank">https://bugzilla.redhat.com/show_bug.cgi?id=1320263</a>
</p><p><br/>
</p>
<h2><span class="mw-headline" id="Biometric_Fingerprinting">Biometric Fingerprinting</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=21" href="https://www.whonix.org/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=21.html" title="Edit section: Biometric Fingerprinting">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>This problem is related to all hypervisors and noted here to keep track. New info added not in mail list message:
</p><p>Upstream tickets:
</p><p><a class="external free" data-href="https://lists.nongnu.org/archive/html/qemu-discuss/2016-03/msg00023.html" href="https://lists.nongnu.org/archive/html/qemu-discuss/2016-03/msg00023.html" rel="noreferrer noopener" target="_blank">https://lists.nongnu.org/archive/html/qemu-discuss/2016-03/msg00023.html</a>
</p><p><a class="external free" data-href="https://secure-os.org/pipermail/desktops/2016-March/000108.html" href="https://secure-os.org/pipermail/desktops/2016-March/000108.html" rel="noreferrer noopener" target="_blank">https://secure-os.org/pipermail/desktops/2016-March/000108.html</a>
</p><p><a class="external free" data-href="https://bugzilla.redhat.com/show_bug.cgi?id=1318813" href="https://bugzilla.redhat.com/show_bug.cgi?id=1318813" rel="noreferrer noopener" target="_blank">https://bugzilla.redhat.com/show_bug.cgi?id=1318813</a>
</p><p><br/>
</p><p><a class="external free" data-href="https://marc.info/?l=linux-kernel&amp;m=145877344732456&amp;w=2" href="https://marc.info/?l=linux-kernel&amp;m=145877344732456&amp;w=2" rel="noreferrer noopener" target="_blank">https://marc.info/?l=linux-kernel&amp;m=145877344732456&amp;w=2</a>
</p><p><a class="external free" data-href="https://lists.freedesktop.org/archives/wayland-devel/2016-March/027607.html" href="https://lists.freedesktop.org/archives/wayland-devel/2016-March/027607.html" rel="noreferrer noopener" target="_blank">https://lists.freedesktop.org/archives/wayland-devel/2016-March/027607.html</a>
</p><p><a class="external free" data-href="https://lists.x.org/archives/xorg-devel/2016-March/049159.html" href="https://lists.x.org/archives/xorg-devel/2016-March/049159.html" rel="noreferrer noopener" target="_blank">https://lists.x.org/archives/xorg-devel/2016-March/049159.html</a>
</p><p><a class="external free" data-href="https://phoronix.com/scan.php?page=news_item&amp;px=Anti-Keystroke-FP-Wayland-Kern" href="https://phoronix.com/scan.php?page=news_item&amp;px=Anti-Keystroke-FP-Wayland-Kern" rel="noreferrer noopener" target="_blank">https://phoronix.com/scan.php?page=news_item&amp;px=Anti-Keystroke-FP-Wayland-Kern</a>
</p><p><a class="external free" data-href="https://mailman.stanford.edu/pipermail/liberationtech/2016-March/015947.html" href="https://mailman.stanford.edu/pipermail/liberationtech/2016-March/015947.html" rel="noreferrer noopener" target="_blank">https://mailman.stanford.edu/pipermail/liberationtech/2016-March/015947.html</a>
</p><p><a class="external free" data-href="https://mailman.boum.org/pipermail/tails-dev/2016-March/010485.html" href="https://mailman.boum.org/pipermail/tails-dev/2016-March/010485.html" rel="noreferrer noopener" target="_blank">https://mailman.boum.org/pipermail/tails-dev/2016-March/010485.html</a>
</p><p><a class="external free" data-href="https://lists.torproject.org/pipermail/tor-talk/2015-July/038624.html" href="https://lists.torproject.org/pipermail/tor-talk/2015-July/038624.html" rel="noreferrer noopener" target="_blank">https://lists.torproject.org/pipermail/tor-talk/2015-July/038624.html</a>
</p><p>Testing sites listed here:
<a class="external free" data-href="https://forums.whonix.org/t/help-wanted-kvm-users-biometrics-fingerprinting-testing/2233" href="https://forums.whonix.org/t/help-wanted-kvm-users-biometrics-fingerprinting-testing/2233" rel="noreferrer noopener" target="_blank">https://forums.whonix.org/t/help-wanted-kvm-users-biometrics-fingerprinting-testing/2233</a>
</p><p>Related code:
</p><p><a class="external free" data-href="https://cgit.freedesktop.org/spice/spice-gtk/tree/src/channel-inputs.h" href="https://cgit.freedesktop.org/spice/spice-gtk/tree/src/channel-inputs.h" rel="noreferrer noopener" target="_blank">https://cgit.freedesktop.org/spice/spice-gtk/tree/src/channel-inputs.h</a>
</p><p><a class="external free" data-href="https://cgit.freedesktop.org/spice/spice-gtk/tree/src/channel-inputs.c" href="https://cgit.freedesktop.org/spice/spice-gtk/tree/src/channel-inputs.c" rel="noreferrer noopener" target="_blank">https://cgit.freedesktop.org/spice/spice-gtk/tree/src/channel-inputs.c</a>
</p><p><a class="external free" data-href="http://git.qemu.org/?p=qemu.git;a=blob;f=hw/input/ps2.c" href="http://git.qemu.org/?p=qemu.git;a=blob;f=hw/input/ps2.c" rel="noreferrer noopener" target="_blank">http://git.qemu.org/?p=qemu.git;a=blob;f=hw/input/ps2.c</a>
</p><p><br/>
Virtualization is useful in presenting an identical environment and set of "hardware" for each user which goes a long way in creating an anonymity set of systems. That way a system attacker, advertisers and online trackers would not be able to fingeprint a user or their hardware.
</p><p>The problem: Tracking techniques have become more sophisticated with time. They advanced from simple cookies to browser/device fingerprinting (which Tor Browser focuses on defeating) to user behavior fingerprinting. The latter is about profiling how a user types on a keyboard or uses a mouse [2]. 
</p><p>Keystroke dynamics is a super creepy way to track users based on how long they press keys (dwell time) and the time between key presses (gap time). This is extremely accurate at identifying individuals because of how unique these measurements are. Advertising networks  (Google, Facebook...) that fingeprprint users on both the clearnet and Tor can deanonymize users. This technique is already actively used in the wild [6][7].
</p><p><br/>
Potential Solutions:
</p><p>Since input devices are all emulated its a great opportunity to stop this profiling technique. 
</p>
<ul><li>A security researcher designed a proof of concept plugin for Chrome browser that mitigates this. Implementing something like the PoC addon in [1] known as KeyBoardPrivacy. Some random delay in milliseconds in a 50 millisecond range for dwell and gap times for the emulated keyboards is enough to skew the values to render this attack useless while not affecting performance.</li></ul>
<p><br/>
</p>
<ul><li>The changes made to Tor Borwser to make JS timers more coarse grained but constant (250ms for keyboard events) were not enough to stop keystroke dynamics fingerprinting because a malicious script can evict the cache and allow extrapolation of true timing events within 1-5ms accuracy .[3][5] Their goal is to instead add jitter to the timers [4]. A similar solution proposed in [4] can be implemented in all QEMU-KVM timers to mitigate both attacks.</li></ul>
<p><br/>
EDIT: Second solution not the way to go. High precision timers in virtualizers have bad security implications. They enable sidechannel attacks on crypto operations running on other VMs as well as aid in biometric fingerprinting. A multi hypervisor study on timer accuracy shows most have high accuracy[8] by necessity. Increasing coarseness in the hypervisor's code can lead to guest slow downs or instability. This varies by hypervisor. CPU load does NOT affect timer accuracy [in KVM] however IO does. A stress/stress-ng daemon installed on GW that runs some varying workload may introduce a skew to timer data.
</p><p>EDIT 2:
</p><p>Even if the user's destination does not itself surreptitiously sniff their biometrics, any one observing the traffic of any interactive JS application can generate a model for your biometric statistics. [16]
</p><p><br/>
[1] <a class="external free" data-href="https://paul.reviews/behavioral-profiling-the-password-you-cant-change/" href="https://paul.reviews/behavioral-profiling-the-password-you-cant-change/" rel="noreferrer noopener" target="_blank">https://paul.reviews/behavioral-profiling-the-password-you-cant-change/</a>
</p><p>[2] <a class="external free" data-href="http://jcarlosnorte.com/security/2016/03/06/advanced-tor-browser-fingerprinting.html" href="http://jcarlosnorte.com/security/2016/03/06/advanced-tor-browser-fingerprinting.html" rel="noreferrer noopener" target="_blank">http://jcarlosnorte.com/security/2016/03/06/advanced-tor-browser-fingerprinting.html</a>
</p><p>[3] <a class="external free" data-href="https://www.lightbluetouchpaper.org/2015/07/30/double-bill-password-hashing-competition-keyboardprivacy/#comment-1288166" href="https://www.lightbluetouchpaper.org/2015/07/30/double-bill-password-hashing-competition-keyboardprivacy/" rel="noreferrer noopener" target="_blank">https://www.lightbluetouchpaper.org/2015/07/30/double-bill-password-hashing-competition-keyboardprivacy/#comment-1288166</a>
</p><p>[4] <a class="external free" data-href="https://trac.torproject.org/projects/tor/ticket/16110" href="https://trac.torproject.org/projects/tor/ticket/16110" rel="noreferrer noopener" target="_blank">https://trac.torproject.org/projects/tor/ticket/16110</a>
</p><p>[5] <a class="external free" data-href="https://trac.torproject.org/projects/tor/ticket/1517" href="https://trac.torproject.org/projects/tor/ticket/1517" rel="noreferrer noopener" target="_blank">https://trac.torproject.org/projects/tor/ticket/1517</a>
</p><p>[6] <a class="external free" data-href="http://scraping.pro/no-captcha-recaptcha-challenge/" href="http://scraping.pro/no-captcha-recaptcha-challenge/" rel="noreferrer noopener" target="_blank">http://scraping.pro/no-captcha-recaptcha-challenge/</a>
</p><p>[7] <a class="external free" data-href="https://nakedsecurity.sophos.com/2013/11/01/facebook-to-silent-track-users-cursor-movements-to-see-which-ads-we-like-best/" href="https://nakedsecurity.sophos.com/2013/11/01/facebook-to-silent-track-users-cursor-movements-to-see-which-ads-we-like-best/" rel="noreferrer noopener" target="_blank">https://nakedsecurity.sophos.com/2013/11/01/facebook-to-silent-track-users-cursor-movements-to-see-which-ads-we-like-best/</a>
</p><p>[8] Achieving High Resolution Timer Events in Virtualized Environment <a class="external free" data-href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4503740/pdf/pone.0130887.pdf" href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4503740/pdf/pone.0130887.pdf" rel="noreferrer noopener" target="_blank">https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4503740/pdf/pone.0130887.pdf</a>
</p><p>[9] <a class="external free" data-href="http://dataprotectioncenter.com/featured/keystroke-profiling/" href="http://dataprotectioncenter.com/featured/keystroke-profiling/" rel="noreferrer noopener" target="_blank">http://dataprotectioncenter.com/featured/keystroke-profiling/</a>
</p><p>[10] <a class="external free" data-href="http://arstechnica.com/security/2015/07/how-the-way-you-type-can-shatter-anonymity-even-on-tor/" href="http://arstechnica.com/security/2015/07/how-the-way-you-type-can-shatter-anonymity-even-on-tor/" rel="noreferrer noopener" target="_blank">http://arstechnica.com/security/2015/07/how-the-way-you-type-can-shatter-anonymity-even-on-tor/</a>
</p><p>[11] Spoofing key-press latencies with a generative keystroke dynamics model [DOI: 10.1109/BTAS.2015.7358795]  <a class="external free" data-href="http://ieeexplore.ieee.org/xpls/abs_all.jsp?arnumber=7358795" href="http://ieeexplore.ieee.org/xpls/abs_all.jsp?arnumber=7358795" rel="noreferrer noopener" target="_blank">http://ieeexplore.ieee.org/xpls/abs_all.jsp?arnumber=7358795</a>
</p><p>[12] "I Am Robot: (Deep) Learning to Break Semantic Image CAPTCHAs" <a class="external free" data-href="http://www.cs.columbia.edu/~polakis/papers/sivakorn_eurosp16.pdf" href="http://www.cs.columbia.edu/~polakis/papers/sivakorn_eurosp16.pdf" rel="noreferrer noopener" target="_blank">http://www.cs.columbia.edu/~polakis/papers/sivakorn_eurosp16.pdf</a>
</p><p>[13] I can be You: Questioning the use of Keystroke Dynamics as Bio
metrics <a class="external free" data-href="http://flyer.sis.smu.edu.sg/ndss13-tey.pdf" href="http://flyer.sis.smu.edu.sg/ndss13-tey.pdf" rel="noreferrer noopener" target="_blank">http://flyer.sis.smu.edu.sg/ndss13-tey.pdf</a>
</p><p>[14] How I reverse-engineered Google Docs to play back any document's keystrokes <a class="external free" data-href="https://news.ycombinator.com/item?id=8562483" href="https://news.ycombinator.com/item?id=8562483" rel="noreferrer noopener" target="_blank">https://news.ycombinator.com/item?id=8562483</a>
</p><p>[15] An Efficient User Verification System via Mouse Movements [DOI=10.1.1.220.9410]  <a class="external free" data-href="http://www.cs.wm.edu/~hnw/paper/ccs11.pdf" href="http://www.cs.wm.edu/~hnw/paper/ccs11.pdf" rel="noreferrer noopener" target="_blank">http://www.cs.wm.edu/~hnw/paper/ccs11.pdf</a>
</p><p>[16] Knowing the User’s Every Move – User Activity Tracking
for Website Usability Evaluation and Implicit Interaction <a class="external free" data-href="https://www.medien.ifi.lmu.de/pubdb/publications/pub/atterer2006www/atterer2006www.pdf" href="https://www.medien.ifi.lmu.de/pubdb/publications/pub/atterer2006www/atterer2006www.pdf" rel="noreferrer noopener" target="_blank">https://www.medien.ifi.lmu.de/pubdb/publications/pub/atterer2006www/atterer2006www.pdf</a>
</p><p>[17] Eliminating Fine Grained Timers in Xen <a class="external free" data-href="http://cseweb.ucsd.edu/~bvattikonda/docs/xentimers-ccsw11.pdf" href="http://cseweb.ucsd.edu/~bvattikonda/docs/xentimers-ccsw11.pdf" rel="noreferrer noopener" target="_blank">http://cseweb.ucsd.edu/~bvattikonda/docs/xentimers-ccsw11.pdf</a>
</p><p>[18] <a class="external free" data-href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3835878/#B13" href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3835878/" rel="noreferrer noopener" target="_blank">https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3835878/#B13</a>
[19] <a class="external free" data-href="https://www.cs.cmu.edu/~maxion/pubs/KillourhyMaxion08a.pdf" href="https://www.cs.cmu.edu/~maxion/pubs/KillourhyMaxion08a.pdf" rel="noreferrer noopener" target="_blank">https://www.cs.cmu.edu/~maxion/pubs/KillourhyMaxion08a.pdf</a> (The Effect of Clock Resolution
on Keystroke Dynamics) millisecond resolution is vital
</p><p>[20] <a class="external free" data-href="https://www.comp.nus.edu.sg/~tsim/documents/keystroke-dynamics-published.pdf" href="https://www.comp.nus.edu.sg/~tsim/documents/keystroke-dynamics-published.pdf" rel="noreferrer noopener" target="_blank">https://www.comp.nus.edu.sg/~tsim/documents/keystroke-dynamics-published.pdf</a> (Keystroke Dynamics in a General Setting) Compared fingerprinting users in a general setting in contrast to typing a password. Measured dynamics of typing common words. Another surprising finding is non-English users were even more susceptible to keystroke fingerprinting than English ones.
</p><p><br/>
higher level behavior fingerprinting: 
</p><p><a class="external free" data-href="https://www.researchgate.net/profile/Roman_Yampolskiy/publication/256169398_Game_Playing_Tactic_as_a_Behavioral_Biometric_for_Human_Identification/links/569c3c1d08aea1476954742c.pdf" href="https://www.researchgate.net/profile/Roman_Yampolskiy/publication/256169398_Game_Playing_Tactic_as_a_Behavioral_Biometric_for_Human_Identification/links/569c3c1d08aea1476954742c.pdf" rel="noreferrer noopener" target="_blank">https://www.researchgate.net/profile/Roman_Yampolskiy/publication/256169398_Game_Playing_Tactic_as_a_Behavioral_Biometric_for_Human_Identification/links/569c3c1d08aea1476954742c.pdf</a>
</p><p><br/>
higher level "cognitive" behavioral biometrics are application specific. That paper uses descriptive statistics for actions that are very specific to the game and don't really apply anywhere else.
</p><p><br/>
</p>
<h3><span class="mw-headline" id="Mouse_Tracking">Mouse Tracking</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=22" href="https://www.whonix.org/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=22.html" title="Edit section: Mouse Tracking">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>User re-authentication via mouse movements
<a class="external free" data-href="https://doi.org/10.1145/1029208.1029210" href="https://doi.org/10.1145/1029208.1029210" rel="noreferrer noopener" target="_blank">https://doi.org/10.1145/1029208.1029210</a>
</p><p>Relatively successful tracking active readers however mouse movements are not enough to fingerprint users. That was back in 2004.
</p><p>ON USING MOUSE MOVEMENTS AS A BIOMETRIC
<a class="external free" data-href="http://www.cs.sjsu.edu/faculty/pollett/papers/shivanipaper.pdf" href="http://www.cs.sjsu.edu/faculty/pollett/papers/shivanipaper.pdf" rel="noreferrer noopener" target="_blank">http://www.cs.sjsu.edu/faculty/pollett/papers/shivanipaper.pdf</a>
<a class="external free" data-href="http://www.cs.sjsu.edu/faculty/pollett/masters/Semesters/Spring04/Shivani/CS298Presentation.pdf" href="http://www.cs.sjsu.edu/faculty/pollett/masters/Semesters/Spring04/Shivani/CS298Presentation.pdf" rel="noreferrer noopener" target="_blank">http://www.cs.sjsu.edu/faculty/pollett/masters/Semesters/Spring04/Shivani/CS298Presentation.pdf</a>
</p><p>Needs more work to achieve high accuracy. 2004.
</p><p><br/>
</p><p>An Efficient User Verification System via Mouse Movements
<a class="external free" data-href="http://www.cs.wm.edu/~hnw/paper/ccs11.pdf" href="http://www.cs.wm.edu/~hnw/paper/ccs11.pdf" rel="noreferrer noopener" target="_blank">http://www.cs.wm.edu/~hnw/paper/ccs11.pdf</a>
</p><p><br/>
high accuracy achieved in limited situations - actice authentication during log-on. Does not clear EU false positive requirements however so they recommend it for combining with keystroke dynamics as extra confirmation:
</p><p>In the scenario of static verification, a user is required to perform a series of mouse movements and its mouse data is verified within a certain amount of time (e.g., login time). A good example of this scenario is a click-based graphical password for user login, where five clicks are estimated to be made in no more than 25 seconds.
</p><p>By contrast, in the scenario of continuous verification, a user’s mouse data is continuously collected and verified throughout the entire session. This is non-intrusive to users and meets the goal of passive monitoring. However, the frequency of user mouse actions varies significantly in different sessions. In general, the average frequency of user mouse actions will be much lower than that of the static scenario.
</p><p>Even for the same user at different times, the number of mouse events per unit time varies a lot. However, to the best of our knowledge, our work is the first to achieve high accuracy with a reasonably small number of mouse events.
</p><p>[1] <a class="external free" data-href="http://www.ijicic.org/ijicic-ksi-03.pdf" href="http://www.ijicic.org/ijicic-ksi-03.pdf" rel="noreferrer noopener" target="_blank">http://www.ijicic.org/ijicic-ksi-03.pdf</a> - User Authentication using Rhythm Click Characteristics for Non-Keyboard Devices 
</p><p>[2] <a class="external free" data-href="https://www.ibm.com/developerworks/library/os-userauth-mouse/index.html" href="https://www.ibm.com/developerworks/library/os-userauth-mouse/index.html" rel="noreferrer noopener" target="_blank">https://www.ibm.com/developerworks/library/os-userauth-mouse/index.html</a> - IBM perl guide for fingerprinting mouse click-hold times
</p><p>search terms:
</p><p>Mouse movement authentication
</p>
<h3><span class="mw-headline" id="Solutions">Solutions</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=23" href="https://www.whonix.org/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=23.html" title="Edit section: Solutions">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Researcher Vinnie Monaco has kindly volunteered to write tools that mitigate these attacks:
</p><p>anti-keystroke defense:
<a class="external free" data-href="https://github.com/vmonaco/kloak" href="https://github.com/vmonaco/kloak" rel="noreferrer noopener" target="_blank">https://github.com/vmonaco/kloak</a>
</p><p>mouse movement defense:
Upcoming
</p>
<h2><span class="mw-headline" id="CPU_Masking">CPU Masking</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=24" href="https://www.whonix.org/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=24.html" title="Edit section: CPU Masking">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>KVM cpus support a baseline of features by default. You can mask out the problematic ones and don't have to worry about the extra ones it doesn't support because it will be masked out anyhow (because it was never supported in the first place).
</p><p>The only bad instructions we should filter out are a subset of whatever instructions are listed under the virtual cpu from the output of the cpu_map.xml list
</p>
<pre>cat /usr/share/libvirt/cpu_map.xml
</pre>
<p>I figured out safe defaults and will do a pull request. NB clflush was abused to carry out the rowhammer attack so its blacklisted.aes will be passed through for crypto performance - it doesn't mess with random number generation.
</p>
<pre>&lt;cpu mode='custom' match='exact'&gt;
   &lt;model fallback='forbid'&gt;qemu64&lt;/model&gt;
   &lt;topology sockets='1' cores='2' threads='1'/&gt;
   &lt;feature policy='disable' name='tsc'/&gt;
   &lt;feature policy='disable' name='clflush'/&gt;
   &lt;feature policy='optional' name='aes'/&gt;
&lt;/cpu&gt;
</pre>
<p><br/>
</p><p><a class="external free" data-href="https://libvirt.org/formatdomain.html#elementsCPU" href="https://libvirt.org/formatdomain.html" rel="noreferrer noopener" target="_blank">https://libvirt.org/formatdomain.html#elementsCPU</a>
</p><p>Informative link about cpu flag functionality: 
<a class="external free" data-href="https://unix.stackexchange.com/questions/43539/what-do-the-flags-in-proc-cpuinfo-mean" href="https://unix.stackexchange.com/questions/43539/what-do-the-flags-in-proc-cpuinfo-mean" rel="noreferrer noopener" target="_blank">https://unix.stackexchange.com/questions/43539/what-do-the-flags-in-proc-cpuinfo-mean</a>
</p><p><a class="external free" data-href="https://www.berrange.com/posts/2010/02/15/guest-cpu-model-configuration-in-libvirt-with-qemukvm/" href="https://www.berrange.com/posts/2010/02/15/guest-cpu-model-configuration-in-libvirt-with-qemukvm/" rel="noreferrer noopener" target="_blank">https://www.berrange.com/posts/2010/02/15/guest-cpu-model-configuration-in-libvirt-with-qemukvm/</a>
</p><p>"Every hypervisor has its own policies for what a guest will see for its CPUs by default, Xen just passes through the host CPU, with QEMU/KVM the guest sees a generic model called “qemu32” or “qemu64”.  "
</p><p><br/> 
cat output:
</p>
<pre>     &lt;model name='qemu64'&gt;
      &lt;!-- These are supported only by TCG.  KVM supports them only if the
           host does.  So we leave them out:

           &lt;feature name='abm'/&gt;
           &lt;feature name='lahf_lm'/&gt;
           &lt;feature name='popcnt'/&gt;
           &lt;feature name='sse4a'/&gt;
      --&gt;
      &lt;feature name='apic'/&gt;
      &lt;feature name='clflush'/&gt;
      &lt;feature name='cmov'/&gt;
      &lt;feature name='cx16'/&gt;
      &lt;feature name='cx8'/&gt;
      &lt;feature name='de'/&gt;
      &lt;feature name='fpu'/&gt;
      &lt;feature name='fxsr'/&gt;
      &lt;feature name='lm'/&gt;
      &lt;feature name='mca'/&gt;
      &lt;feature name='mce'/&gt;
      &lt;feature name='mmx'/&gt;
      &lt;feature name='msr'/&gt;
      &lt;feature name='mtrr'/&gt;
      &lt;feature name='nx'/&gt;
      &lt;feature name='pae'/&gt;
      &lt;feature name='pat'/&gt;
      &lt;feature name='pge'/&gt;
      &lt;feature name='pni'/&gt;
      &lt;feature name='pse'/&gt;
      &lt;feature name='pse36'/&gt;
      &lt;feature name='sep'/&gt;
      &lt;feature name='sse'/&gt;
      &lt;feature name='sse2'/&gt;
      &lt;feature name='svm'/&gt;
      &lt;feature name='syscall'/&gt;
      &lt;feature name='tsc'/&gt;
    &lt;/model&gt;
</pre>
<h2><span class="mw-headline" id="Passed_to_Command_Line">Passed to Command Line</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=25" href="https://www.whonix.org/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=25.html" title="Edit section: Passed to Command Line">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Minor importance.
</p><p>Libvirt "only" runs the qemu-kvm command line utility with the correct command line parameters?
</p><p>Is there a way to make libvirt tell with what parameters libvirt is calling qemu-kvm?
</p><p>HulaHoop:
Yes its possible. Conversion of commands is supported in bot directions. See documentation here: <a class="external free" data-href="http://libvirt.org/drvqemu.html#xmlexport" href="http://libvirt.org/drvqemu.html" rel="noreferrer noopener" target="_blank">http://libvirt.org/drvqemu.html#xmlexport</a>
</p><p>Nice and useful. Added to unit_test: <br/>
<a class="external free" data-href="https://github.com/Whonix/whonix-libvirt/commit/4bcac51b264b9d78042899be005e4c06549224ab" href="https://github.com/Whonix/whonix-libvirt/commit/4bcac51b264b9d78042899be005e4c06549224ab" rel="noreferrer noopener" target="_blank">https://github.com/Whonix/whonix-libvirt/commit/4bcac51b264b9d78042899be005e4c06549224ab</a>
</p>
<h2><span id="Haveged_test_for_KVM_+_virtio-rng_Result"></span><span class="mw-headline" id="Haveged_test_for_KVM_.2B_virtio-rng_Result">Haveged test for KVM + virtio-rng Result</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=26" href="https://www.whonix.org/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=26.html" title="Edit section: Haveged test for KVM + virtio-rng Result">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>NB Patrick has conducted the tests without virtio-rng and they worked too.
</p><p>Reults with virtio-rng:
</p>
<pre>0 failed individual tests with THRESHOLD 0.001000 on 514 individual tests
PASS: nist/test.sh
==================
All 2 tests passed
==================
make[2]: Leaving directory `/home/user/haveged-1.4'
make[1]: Leaving directory `/home/user/haveged-1.4'
</pre>
<h2><span id="Two_Separate_Whonix-Gateway's"></span><span class="mw-headline" id="Two_Separate_Whonix-Gateway.27s">Two Separate Whonix-Gateway's</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=27" href="https://www.whonix.org/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=27.html" title="Edit section: Two Separate Whonix-Gateway's">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p><a class="external free" data-href="https://www.whonix.org/old-forum/index.php/topic,397.msg2973.html#new" href="https://www.whonix.org/old-forum/index.php/topic,397.msg2973.html" rel="noreferrer noopener" target="_blank">https://www.whonix.org/old-forum/index.php/topic,397.msg2973.html#new</a>
Possible and documented.
</p>
<h2><span id="Preserve_Comments_in_libvirt_/_virsh_XML_Files"></span><span class="mw-headline" id="Preserve_Comments_in_libvirt_.2F_virsh_XML_Files">Preserve Comments in libvirt / virsh XML Files</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=28" href="https://www.whonix.org/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=28.html" title="Edit section: Preserve Comments in libvirt / virsh XML Files">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Asked on stackexchange: <br/>
<a class="external free" data-href="http://unix.stackexchange.com/questions/148163/is-it-possible-to-use-comments-in-virsh-libvirt-xml-files" href="http://unix.stackexchange.com/questions/148163/is-it-possible-to-use-comments-in-virsh-libvirt-xml-files" rel="noreferrer noopener" target="_blank">http://unix.stackexchange.com/questions/148163/is-it-possible-to-use-comments-in-virsh-libvirt-xml-files</a>
</p><p>Asked on libvirt mailinglist and here is their response:
<a class="external free" data-href="https://www.redhat.com/archives/libvir-list/2014-August/msg00681.html" href="https://www.redhat.com/archives/libvir-list/2014-August/msg00681.html" rel="noreferrer noopener" target="_blank">https://www.redhat.com/archives/libvir-list/2014-August/msg00681.html</a>
</p><p>A description attribute can be used to carry human readable metadata.
</p>
<h2><span id="Activate_Watchdog?"></span><span class="mw-headline" id="Activate_Watchdog.3F">Activate Watchdog?</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=29" href="https://www.whonix.org/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=29.html" title="Edit section: Activate Watchdog?">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>libvirt can be told to ignore a guest's request for restart. The actual action would be a silent shutdown. Same for when a crash happens, libvirt would just leave the machine in its shutdown state instead of booting it again.
</p><p>This all hinges on what you think about the attack i described earlier. Should we just advise people not to do things on their host that would leak timestamps? Like browsing for instance. <s>From what I got from the wiki, this is the only thing done on a Linux host that could leak this information.</s>
</p><p>Later I learned that TCP Sequence numbers could still leak time information, but its more difficult to exploit than other methods.
</p><p>Patrick wrote: "the attack i described earlier" in unclear for other readers and I am also not so sure about it anymore.
</p><p>Patrick wrote: Not sure exactly what you want to defend here, but I guess this info might invalid its premises. The ACPI reset command is not required. An adversary could simply use kexec. It allows to reboot a machine without ACPI reset command. kexec's purpose is to save time by not going through BIOS initialization routines. Therefore KVM ignoring ACPI reset command probably won't be a big help.
</p><p>HulaHoop: Agreed. I went ahead and re-added it.
</p>
<h2><span class="mw-headline" id="Add_pvspinlock_when_supported_in_more_recent_version_of_libvirt">Add pvspinlock when supported in more recent version of libvirt</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=30" href="https://www.whonix.org/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=30.html" title="Edit section: Add pvspinlock when supported in more recent version of libvirt">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Was not accepting it because its a fresh feature with not support in the version of libvirt I run. Its been added as of libvirt 1.2 as per the  reply. <sup class="reference" id="cite_ref-2"><a href="#cite_note-2">[2]</a></sup>
</p><p>HulaHoop: Done.
</p>
<h2><span class="mw-headline" id="Preconfigured_Shared_Folders">Preconfigured Shared Folders</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=31" href="https://www.whonix.org/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=31.html" title="Edit section: Preconfigured Shared Folders">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Patrick asks: For better usability, should we add the necessary settings for shared folders by default to whonix_gateway.xml and whonix_workstation.xml?
</p><p>Patrick comments: I could then, if kvm is detected (easy using virt-what), automatically mount the shared folder in Whonix VMs. Could be implemented into the <a class="external text" data-href="https://github.com/Whonix/shared-folder-help" href="https://github.com/Whonix/shared-folder-help" rel="noreferrer noopener" target="_blank">shared-folder-help</a> package.
</p><p>Patrick asks: If we decide to do so, what would be good default paths for the host shared folder? /mnt/shared_gw and /mnt/shared_ws?
</p><p>Patrick said: HulaHoop reported, that "virsh define" will fail if the shared folder in the xml does not exist.
</p><p>See also: <a class="external free" data-href="https://github.com/Whonix/Whonix/issues/223" href="https://github.com/Whonix/Whonix/issues/223" rel="noreferrer noopener" target="_blank">https://github.com/Whonix/Whonix/issues/223</a>
</p>
<h2><span id="Kernel_Samepage_Merging_(KSM)"></span><span class="mw-headline" id="Kernel_Samepage_Merging_.28KSM.29">Kernel Samepage Merging (KSM)</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=32" href="https://www.whonix.org/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=32.html" title="Edit section: Kernel Samepage Merging (KSM)">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Any changes to the images required? Probably adding this init script: <br/>
<a class="external free" data-href="https://github.com/dnaeon/ksm-init.d-debian" href="https://github.com/dnaeon/ksm-init.d-debian" rel="noreferrer noopener" target="_blank">https://github.com/dnaeon/ksm-init.d-debian</a> (looks good and simple - trivial to package)
Any other changes required?
</p><p>Any changes to documentation or xml required to make use of it?
</p><p>While not needed to enable this functionality for Whonix directly,its useful for Debian host users. Its inclusion in Whonix will definitely help when running Nested Virtualization though so please add this.
</p><p>To make use of it, it needs to be enabled host-side following this guide<sup class="reference" id="cite_ref-3"><a href="#cite_note-3">[3]</a></sup>. It is used automatically by libvirt without further intervention, but certain parameters such as huge page sharing can be, optionally, used through the XML.<sup class="reference" id="cite_ref-4"><a href="#cite_note-4">[4]</a></sup>
</p><p>Using it on the host is as simple as starting the two services <i>ksm</i> and <i>ksmtuned</i> following the guide above.
No need to adjust the number of pages it uses anymore as newer versions automatically handle it with bigger RAM amounts as to give a bigger performance improvement compared to earlier versions that used just 2000 pages of RAM.
</p><p>How to verify that KSM is working and looking at its stats.<sup class="reference" id="cite_ref-5"><a href="#cite_note-5">[5]</a></sup>
</p><p>Notes: What appeared to be effects of KSM was actually just the Linux Guests not using all allocated RAM by default. Non Linux guests usually take over the entire assigned RAM allocated space while Linux does not.
By default KSM kicks in when there is very little free free RAM on the host. Settings must be tweaked in ksmtuned.conf to change this behavior. Experimenting in progress...
</p><p>KSM security implications?
</p>
<pre>3.
ATTACK ON MEMORY
DEDUPLICATION
Memory deduplication may be subject to a memory disclosure
attack from the attacker’s VM to the victim’s VM. The attack
guesses a process running on a victim’s VM or a file downloaded
by a browser.
Memory deduplication shares 4KB pages which have the
same contents. When data is written to a deduplicated page, the
page is re-created with a copy of its contents (Copy On Write).
This causes the write access time to be slower than normal,
because it includes the overhead to re-create the same page. An
attacker can measure access time to determine whether a page was
deduplicated by another VM. </pre><p><sup class="reference" id="cite_ref-6"><a href="#cite_note-6">[6]</a></sup>
</p><p>Enable Hugepages for guests?
Yes. I am seeing benchmarks of 40% improvement of performance for all workloads in a guest according to the literature.  <s>However using it will prevent use of memory ballooning and swapping<sup class="reference" id="cite_ref-7"><a href="#cite_note-7">[7]</a></sup> and is subject to lack of adequate sVirt protections.<sup class="reference" id="cite_ref-8"><a href="#cite_note-8">[8]</a></sup></s> Just confirmed from Dan Walsh, SELinux policy developer that this is no longer the case.
The sacrificing of one performance feature for another may not be a problem afterall. Since 2012 there has been an effort to teach KSM how to play nice with THP transparent Hugetables. <sup class="reference" id="cite_ref-9"><a href="#cite_note-9">[9]</a></sup>
</p><p>More info<sup class="reference" id="cite_ref-10"><a href="#cite_note-10">[10]</a></sup>
</p><p>Documentation:
A kind soul posted how to interpret what ksmuned.conf's parameters mean in plain English in the first post. Its worth mirroring in our documentation:
<a class="external free" data-href="http://forum.proxmox.com/threads/5041-KSM-with-2-6-35" href="http://forum.proxmox.com/threads/5041-KSM-with-2-6-35" rel="noreferrer noopener" target="_blank">http://forum.proxmox.com/threads/5041-KSM-with-2-6-35</a>
</p><p>No need to play around with the defaults. ksmtuned should handle memory overcommitment adjustments dynamically when the host is under pressure.
</p><p>More accurate instructions on starting ksm and ksmtuned services and keeping them that way at boot. They will be summarized in the documentation too:
</p><p><a class="external free" data-href="http://www-01.ibm.com/support/knowledgecenter/api/content/linuxonibm/liaat/liaatbpsharing.htm" href="http://www-01.ibm.com/support/knowledgecenter/api/content/linuxonibm/liaat/liaatbpsharing.htm" rel="noreferrer noopener" target="_blank">http://www-01.ibm.com/support/knowledgecenter/api/content/linuxonibm/liaat/liaatbpsharing.htm</a>
<a class="external free" data-href="http://www-01.ibm.com/support/knowledgecenter/api/content/linuxonibm/liaat/liaatbpksm.htm" href="http://www-01.ibm.com/support/knowledgecenter/api/content/linuxonibm/liaat/liaatbpksm.htm" rel="noreferrer noopener" target="_blank">http://www-01.ibm.com/support/knowledgecenter/api/content/linuxonibm/liaat/liaatbpksm.htm</a>
<a class="external free" data-href="http://www-01.ibm.com/support/knowledgecenter/api/content/linuxonibm/liaat/liaatbprunksm6.htm" href="http://www-01.ibm.com/support/knowledgecenter/api/content/linuxonibm/liaat/liaatbprunksm6.htm" rel="noreferrer noopener" target="_blank">http://www-01.ibm.com/support/knowledgecenter/api/content/linuxonibm/liaat/liaatbprunksm6.htm</a>
<a class="external free" data-href="http://www-01.ibm.com/support/knowledgecenter/api/content/linuxonibm/liaat/liaatbpksmmemsavings6.htm" href="http://www-01.ibm.com/support/knowledgecenter/api/content/linuxonibm/liaat/liaatbpksmmemsavings6.htm" rel="noreferrer noopener" target="_blank">http://www-01.ibm.com/support/knowledgecenter/api/content/linuxonibm/liaat/liaatbpksmmemsavings6.htm</a>
</p><p>TO DO: packaging <a class="external free" data-href="https://github.com/Whonix/Whonix/issues/39#issuecomment-53991872" href="https://github.com/Whonix/Whonix/issues/39" rel="noreferrer noopener" target="_blank">https://github.com/Whonix/Whonix/issues/39#issuecomment-53991872</a>
</p><p>TO DO: Document on KVM wikipage how users can enable this permanently.
</p><p>Documentation and risk assessment completed.
</p><p>Done.
</p>
<h2><span id="Pass_qemu_commands_via_libvirt?"></span><span class="mw-headline" id="Pass_qemu_commands_via_libvirt.3F">Pass qemu commands via libvirt?</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=33" href="https://www.whonix.org/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=33.html" title="Edit section: Pass qemu commands via libvirt?">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Not a good idea, has potential security and stability risks.
<a class="external free" data-href="https://www.redhat.com/archives/libvir-list/2014-September/msg00288.html" href="https://www.redhat.com/archives/libvir-list/2014-September/msg00288.html" rel="noreferrer noopener" target="_blank">https://www.redhat.com/archives/libvir-list/2014-September/msg00288.html</a>
</p><p>Useful in some cases such as guest debugging via qemu's gdb while retainging libvirt's security framework. Relevant documentation added.
</p>
<h2><span class="mw-headline" id="memory_balloon">memory balloon</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=34" href="https://www.whonix.org/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=34.html" title="Edit section: memory balloon">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p><a class="external free" data-href="https://rwmj.wordpress.com/2010/07/17/virtio-balloon/" href="https://rwmj.wordpress.com/2010/07/17/virtio-balloon/" rel="noreferrer noopener" target="_blank">https://rwmj.wordpress.com/2010/07/17/virtio-balloon/</a>
</p><p>Any changes to documentation, xml or images required to make use of it?
</p><p>HulaHoop: Just having the device added is enough to take advantage of it. At the moment this feature needs manual intervention to make use of it which limits its utility in the real world. However, towards the end of 2013 work is being done to have this feature automated and mainlined <sup class="reference" id="cite_ref-11"><a href="#cite_note-11">[11]</a></sup> This space will be watched for developments; as soon as its incorporated upstream and an option added in libvirt I will enable it in the configuration.
</p><p><br/>
</p><p>Memory ballooning is indeed another vector for side channel atacks on memory. Confirmed in a follow-up by side-channel attacks researcher Daniel Gruss:
</p><p>"Not Rowhammer, but there has already been a side-channel attack on memory ballooning earlier this year: <a class="external free" data-href="http://ieeexplore.ieee.org/document/7562068/" href="http://ieeexplore.ieee.org/document/7562068/" rel="noreferrer noopener" target="_blank">http://ieeexplore.ieee.org/document/7562068/</a>"
</p><p>Status: feature disabled for Whonix 14
</p><p>Warned upstream and advised them against enabling it by default:
</p><p><a class="external free" data-href="https://www.redhat.com/archives/libvir-list/2016-December/msg01156.html" href="https://www.redhat.com/archives/libvir-list/2016-December/msg01156.html" rel="noreferrer noopener" target="_blank">https://www.redhat.com/archives/libvir-list/2016-December/msg01156.html</a>
</p>
<h2><span class="mw-headline" id="SPICE_security_implications">SPICE security implications</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=35" href="https://www.whonix.org/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=35.html" title="Edit section: SPICE security implications">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p><a class="external free" data-href="http://lists.freedesktop.org/archives/spice-devel/2013-December/015810.html" href="http://lists.freedesktop.org/archives/spice-devel/2013-December/015810.html" rel="noreferrer noopener" target="_blank">http://lists.freedesktop.org/archives/spice-devel/2013-December/015810.html</a>
</p><p><a class="external free" data-href="http://lists.freedesktop.org/archives/spice-devel/2014-January/015815.html" href="http://lists.freedesktop.org/archives/spice-devel/2014-January/015815.html" rel="noreferrer noopener" target="_blank">http://lists.freedesktop.org/archives/spice-devel/2014-January/015815.html</a>
</p><p>Protections applying to QEMU apply here too. 
</p>
<h2><span id="How_to_check_if_virtio_storage_access_is_in_use_or_an_eventually_existing_fallback_driver?"></span><span class="mw-headline" id="How_to_check_if_virtio_storage_access_is_in_use_or_an_eventually_existing_fallback_driver.3F">How to check if virtio storage access is in use or an eventually existing fallback driver?</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=36" href="https://www.whonix.org/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=36.html" title="Edit section: How to check if virtio storage access is in use or an eventually existing fallback driver?">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<h3><span class="mw-headline" id="Question">Question</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=37" href="https://www.whonix.org/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=37.html" title="Edit section: Question">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>How to check if virtio storage access <b>virtio_blk</b> really is in use or an eventually existing fallback driver?
</p><p><a class="external free" data-href="http://www.linux-kvm.org/page/Boot_from_virtio_block_device" href="http://www.linux-kvm.org/page/Boot_from_virtio_block_device" rel="noreferrer noopener" target="_blank">http://www.linux-kvm.org/page/Boot_from_virtio_block_device</a> <br/>
<a class="external free" data-href="http://wiki.libvirt.org/page/Virtio" href="http://wiki.libvirt.org/page/Virtio" rel="noreferrer noopener" target="_blank">http://wiki.libvirt.org/page/Virtio</a>
</p>
<h3><span class="mw-headline" id="Asked_on_unix.stackexchange">Asked on unix.stackexchange</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=38" href="https://www.whonix.org/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=38.html" title="Edit section: Asked on unix.stackexchange">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p><a class="external free" data-href="http://unix.stackexchange.com/questions/148055/kvm-how-to-check-if-virtio-storage-access-is-in-use" href="http://unix.stackexchange.com/questions/148055/kvm-how-to-check-if-virtio-storage-access-is-in-use" rel="noreferrer noopener" target="_blank">http://unix.stackexchange.com/questions/148055/kvm-how-to-check-if-virtio-storage-access-is-in-use</a>
</p>
<h3><span id="lsmod_won't_help"></span><span class="mw-headline" id="lsmod_won.27t_help">lsmod won't help</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=39" href="https://www.whonix.org/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=39.html" title="Edit section: lsmod won't help">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>The following.
</p>
<pre>lsmod | grep virtio
</pre>
<p>Only shows, that the virtio kernel module is loaded. It is not hard to load arbitrary kernel modules for hardware that you don't have installed ("sudo modprobe virtio-blk"). The question remains, is this kernel module actually in use or an eventually existing fallback driver?
</p>
<h3><span id="modinfo_won't_help"></span><span class="mw-headline" id="modinfo_won.27t_help">modinfo won't help</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=40" href="https://www.whonix.org/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=40.html" title="Edit section: modinfo won't help">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<pre>modinfo virtio-blk
</pre>
<p>Won't help, because it only shows general information it would also show on VBox systems (after running "sudo modprobe virtio-blk").
</p>
<h3><span class="mw-headline" id="ls_Test">ls Test</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=41" href="https://www.whonix.org/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=41.html" title="Edit section: ls Test">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>/dev/sda and /dev/sda1 should not exist.
</p>
<pre>ls -la /dev/sda
</pre>
<pre>ls -la /dev/sda1
</pre>
<p>/dev/vda and /dev/vda1 should exist.
</p>
<pre>ls -la /dev/vda
</pre>
<pre>ls -la /dev/vda1
</pre>
<h3><span class="mw-headline" id="hwinfo_Test">hwinfo Test</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=42" href="https://www.whonix.org/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=42.html" title="Edit section: hwinfo Test">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>See which driver is loaded for each particular device.
</p>
<pre>hwinfo --short
</pre>
<h2><span id="How_to_check_if_virtio_network_is_really_in_use_or_an_eventually_existing_fallback_driver?"></span><span class="mw-headline" id="How_to_check_if_virtio_network_is_really_in_use_or_an_eventually_existing_fallback_driver.3F">How to check if virtio network is really in use or an eventually existing fallback driver?</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=43" href="https://www.whonix.org/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=43.html" title="Edit section: How to check if virtio network is really in use or an eventually existing fallback driver?">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>How to check, that <b>virtio_pci</b> is really being used and not some fallback driver?
</p><p>/sys/devices/virtio-pci/0/net/eth0/statistics/rx_bytes seems not to exist on Debian Wheezy.
</p>
<h2><span id="How_to_enable_AppArmor_/_SELinux_for_KVM_on_Debian?"></span><span class="mw-headline" id="How_to_enable_AppArmor_.2F_SELinux_for_KVM_on_Debian.3F">How to enable AppArmor / SELinux for KVM on Debian?</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=44" href="https://www.whonix.org/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=44.html" title="Edit section: How to enable AppArmor / SELinux for KVM on Debian?">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Details on how to install, configure and enable SELinux enforcing mode:
<a class="external free" data-href="https://wiki.debian.org/SELinux/Setup#Steps_to_setup_SELinux" href="https://wiki.debian.org/SELinux/Setup" rel="noreferrer noopener" target="_blank">https://wiki.debian.org/SELinux/Setup#Steps_to_setup_SELinux</a> &lt;-- This is a start, but incomplete. When following these instructions it gets difficult at the "audit2why -al" step, because it shows a ton of policy violations which are non-trivial to fix without learning a lot about SELinux.
</p><p>Why Bother?
SELinux is more robust than Apparmor because its label based vs file-path based. But his comes at the expense of being difficult to write policies. However the plans I have for it in mind, it won't matter since we won't be writing SELinux profiles, but leveraging the one already present in sVirt as a protection layer around application sandboxes.
</p><p>HulaHoop: This is probably a result of not having done a relabel of your filesystem after enabling SELinux. This aspect can be handled by a script from the link below. I'll need to test this at some point. Any files created before SELinux was prsent creates conflicts with policy when it is enforced. A relabel must also run if you want to isolate software that has a policy but was introduced after SELinux was enabled. Example KVM if we decide to ship it for nested purposes in the future.
</p><p><a class="external free" data-href="http://debian-handbook.info/browse/stable/sect.selinux.html" href="http://debian-handbook.info/browse/stable/sect.selinux.html" rel="noreferrer noopener" target="_blank">http://debian-handbook.info/browse/stable/sect.selinux.html</a>
Best guide has everything in one place:
<a class="external free" data-href="https://www.wzdftpd.net/docs/selinux/using_debian_selinux.html" href="https://www.wzdftpd.net/docs/selinux/using_debian_selinux.html" rel="noreferrer noopener" target="_blank">https://www.wzdftpd.net/docs/selinux/using_debian_selinux.html</a>
</p><p>Another guiede to test with:
<a class="external free" data-href="http://blog.danielcosta.pt/?p=440" href="http://blog.danielcosta.pt/?p=440" rel="noreferrer noopener" target="_blank">http://blog.danielcosta.pt/?p=440</a>
</p><p>Note: Both MAC systems cannot be run simultaneously run. This is not supported by LSM and may also be a source of conflicts.
</p><p><br/>
For Debian hosts, AppArmor makes more sense.
</p><p><a class="external free" data-href="http://libvirt.org/drvqemu.html#securitysvirtaa" href="http://libvirt.org/drvqemu.html" rel="noreferrer noopener" target="_blank">http://libvirt.org/drvqemu.html#securitysvirtaa</a>
</p><p>AppArmor profiles for Ubuntu could be ported to Debian:
<a class="external free" data-href="http://bazaar.launchpad.net/~ubuntu-branches/ubuntu/utopic/libvirt/utopic/files/head:/debian/apparmor/" href="http://bazaar.launchpad.net/~ubuntu-branches/ubuntu/utopic/libvirt/utopic/files/head:/debian/apparmor/" rel="noreferrer noopener" target="_blank">http://bazaar.launchpad.net/~ubuntu-branches/ubuntu/utopic/libvirt/utopic/files/head:/debian/apparmor/</a>
</p><p>DONE. DOCUMENTED.
</p>
<h2><span id="Set_cluster_size_512_-_2MB_for_better_performance?"></span><span class="mw-headline" id="Set_cluster_size_512_-_2MB_for_better_performance.3F">Set cluster_size 512 - 2MB for better performance?</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=45" href="https://www.whonix.org/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=45.html" title="Edit section: Set cluster size 512 - 2MB for better performance?">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>HulaHoop1 wrote: The qcow2 defaults seem fine to me, however the one parameter of interest we should play with is image's : 'cluster_size' 512 - 2MB the larger the size the better performance but the size is bigger. I think we should try the largest and see if the image size stays reasonable.
</p><p>Patrick wrote:
</p><p>When using (Whonix 7.7.8.0):
</p>
<pre>     qemu-img \
        convert \
           -p \
           -O qcow2 \
           -o preallocation=metadata \
           "$WHONIX_BINARY/$VMNAME.img" \
           "$WHONIX_BINARY/$VMNAME-$whonix_build_whonix_version_new.qcow2"
</pre>
<p>du -h --apparent-size file.img <br/>
100 GB
</p><p>du -h file.img <br/>
2,5 GB
</p><p>When using (Whonix 7.7.8.0):
</p>
<pre>     qemu-img \
        convert \
           -p \
           -O qcow2 \
           -o cluster_size=2M \
           -o preallocation=metadata \
           "$WHONIX_BINARY/$VMNAME.img" \
           "$WHONIX_BINARY/$VMNAME-$whonix_build_whonix_version_new.qcow2"
</pre>
<p>du -h --apparent-size file.img <br/>
2,9 GB
</p><p>du -h file.img <br/>
2,9 GB
</p><p>File size grew a bit. Not too much. We could use this.
</p><p>It remains to be tested, if the images work well using these settings. (The apparent size should be shown as 100 GB, but is only 2,9 GB. Needs testing if 100 GB can be used after the image is in use.)
</p><p>"qemu-img info file.img" however, shows 2,9 GB actual size and 100 GB virtual size.
</p><p>git tag 7.8.0.1 and above will be using the "-o cluster_size=2M" option.
</p><p>HulaHoop said: I am yet to document this in the KVM page lets do this at the end. Is there any tangible speed gains?
</p>
<h2><span id="Exporting/Cloning_of_virtual_machines"></span><span class="mw-headline" id="Exporting.2FCloning_of_virtual_machines">Exporting/Cloning of virtual machines</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=46" href="https://www.whonix.org/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=46.html" title="Edit section: Exporting/Cloning of virtual machines">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Important links:
</p>
<ul><li><a class="external free" data-href="http://libvirt.org/sources/virshcmdref/html-single/" href="http://libvirt.org/sources/virshcmdref/html-single/" rel="noreferrer noopener" target="_blank">http://libvirt.org/sources/virshcmdref/html-single/</a></li>
<li><a class="external free" data-href="https://unix.stackexchange.com/questions/8351/how-to-create-a-dupe-of-a-kvm-libvirt-virt-manager-vm" href="https://unix.stackexchange.com/questions/8351/how-to-create-a-dupe-of-a-kvm-libvirt-virt-manager-vm" rel="noreferrer noopener" target="_blank">https://unix.stackexchange.com/questions/8351/how-to-create-a-dupe-of-a-kvm-libvirt-virt-manager-vm</a></li>
<li><a class="external free" data-href="http://linux.die.net/man/1/virt-clone" href="http://linux.die.net/man/1/virt-clone" rel="noreferrer noopener" target="_blank">http://linux.die.net/man/1/virt-clone</a></li></ul>
<p>Archived thread SE
</p>
<blockquote>
<p>I'm a bit lost with virt-manager / libvirt / KVM.
</p><p>I've got a working KVM VM (Windows XP) which works nicely.
</p><p>The VM is backed by a 4GB file or so (a .img).
</p><p>Now I want to do something very simple: I want to duplicate my VM.
</p><p>I thought "OK, no problem, let's copy the 4GB file and copy the XML" file.
</p><p>But then the libvirt FAQ states in all uppercase: "you SHOULD NOT CARE WHERE THE XML IS STORED"
</p><p><a class="external free" data-href="http://wiki.libvirt.org/page/FAQ" href="http://wiki.libvirt.org/page/FAQ" rel="noreferrer noopener" target="_blank">http://wiki.libvirt.org/page/FAQ</a>
</p><p>OK fine, I shouldn't care. But then how do I duplicate my VM?
</p><p>I want to create a new VM that is a copy of that VM.
</p>
</blockquote>
<blockquote>
<p>The most convenient is simply:
</p>
<pre>virt-clone --connect=qemu://example.com/system -o this-vm -n that-vm --auto-clone
</pre>
<p>Which will make a copy of this-vm, named that-vm, and takes care of duplicating storage devices. Nothing new here except detail.
</p><p>More to the point, What the FAQ is saying is that the XML domain descriptions are not directly editable, you need to go through libvirt. To complete the steps taken by the virt-clone command, you could:
</p><p>You cannot "clone" a running vm, stop it.  suspend and destroy are also valid options for less graceful cloning
</p>
<pre>virsh shutdown this.vm
</pre>
<p>copy the storage.
</p>
<pre>cp /var/lib/libvirt/images/{this-vm,that-vm}.img
</pre>
<p>dump the xml for the original
</p>
<pre>virsh dumpxml this-vm &gt; /tmp/that-vm.xml
</pre>
<p>hardware addresses need to be removed, libvirt will assign new addresses automatically
</p>
<pre>sed -i /uuid/d /tmp/that-vm.xml
sed -i '/mac address/d' /tmp/that-vm.xml
</pre>
<p>and actually rename the vm: (this also updates the storage path)
</p>
<pre>sed -i s/this-vm/that-vm /tmp/that-vm.xml
</pre>
<p>finally, create the new vm
</p>
<pre>virsh define /tmp/that-vm.xml
virsh start this-vm
virsh start that-vm
</pre>
</blockquote>
<pre># dump the xml for the virtual isolated network
virsh net-dumpxml whonix &gt; /tmp/whonix.xml

# hardware addresses need to be removed, libvirt will assign
# new addresses automatically
sed -i /uuid/d /tmp/whonix.xml
sed -i '/mac address/d' /whonix.xml
</pre>
<h2><span class="mw-headline" id="management_tools">management tools</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=47" href="https://www.whonix.org/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=47.html" title="Edit section: management tools">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>There are a lot <a class="external text" data-href="http://www.linux-kvm.org/page/Management_Tools" href="http://www.linux-kvm.org/page/Management_Tools" rel="noreferrer noopener" target="_blank">management tools</a>. Are any of these useful for Whonix's use case?
</p>
<h2><span class="mw-headline" id="Nested_Virtualization">Nested Virtualization</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=48" href="https://www.whonix.org/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=48.html" title="Edit section: Nested Virtualization">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>As a minor point, documenting how to use KVM with nested virtualization would be nice.
</p><p>Forum thread: <br/>
<a class="external free" data-href="https://forums.whonix.org/t/nested-virtulization-needs-64-bit-whonx-guest" href="https://forums.whonix.org/t/nested-virtulization-needs-64-bit-whonx-guest" rel="noreferrer noopener" target="_blank">https://forums.whonix.org/t/nested-virtulization-needs-64-bit-whonx-guest</a>
</p><p>This is only possible using a 64 bit kernel. Install a 64 bit kernel. Don't get confused by the package name. Works with <b>AMD</b> and <b>Intel</b>.
</p>
<pre>sudo apt-get update
sudo apt-get install linux-image-amd64
</pre>
<h2><span class="mw-headline" id="qemu_i386_support">qemu i386 support</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=49" href="https://www.whonix.org/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=49.html" title="Edit section: qemu i386 support">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Why are our qemu xml files currently called ${VMNAME}_qemu-x86-x64.xml. Are they dependent on x86-x64? Should they work on i386 systems as well? Maybe just &lt;pae/&gt; must be removed? Can you test please?
</p><p>Any QEMU architecture works on any host supported by QEMU.i386 tested and working but pointless when x86-64 works on i386 hosts too.
</p><p><br/>
</p>
<h2><span class="mw-headline" id="Disable_Microphone_Input">Disable Microphone Input</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=50" href="https://www.whonix.org/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=50.html" title="Edit section: Disable Microphone Input">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Figure out how to disable Microphone input to Guests. While a nice feature for VOIP, is a very dangerous setting to have by default as its unexpected.
</p><p><a class="external free" data-href="https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/6/html/Virtualization_Administration_Guide/section-libvirt-dom-xml-sound-devices.html" href="https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/6/html/Virtualization_Administration_Guide/section-libvirt-dom-xml-sound-devices.html" rel="noreferrer noopener" target="_blank">https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/6/html/Virtualization_Administration_Guide/section-libvirt-dom-xml-sound-devices.html</a>
</p><p><a class="external free" data-href="http://libvirt.org/formatdomain.html" href="http://libvirt.org/formatdomain.html" rel="noreferrer noopener" target="_blank">http://libvirt.org/formatdomain.html</a>
</p><p><b>Somewhat Solved:</b>
After speaking with Cole Robinson, libvirt developer, its clear that this is a feature provided by SPICE rather than something having to do with the sound card. I found that all sound cards have this after testing yesterday. When I changed Spice to VNC this no longer happens. Before you say that we shouldn't use spice, its important to note that audio does not function without it at all.
</p><p>I've asked on the mailinglists if there is some xml attribute to disable the feature. From what I've seen in the documentation this is not possible. However it can be accomplished through the Host's audio popup menu in the taskbar. The devices show up with the name "virt-manager: record" and can be set to mute as with any other device on the host.
</p><p><a class="external free" data-href="http://libvirt.org/formatdomain.html#elementsGraphics" href="http://libvirt.org/formatdomain.html" rel="noreferrer noopener" target="_blank">http://libvirt.org/formatdomain.html#elementsGraphics</a>
</p><p>Other spice channel functionality provided:
</p>
<pre>Valid channel names include main, display, inputs, cursor, playback, record (all since 0.8.6); smartcard (since 0.8.8); and usbredir (since 0.9.12). </pre>
<p>Mailinglist reply:
<a class="external free" data-href="https://www.redhat.com/archives/virt-tools-list/2014-August/msg00002.html" href="https://www.redhat.com/archives/virt-tools-list/2014-August/msg00002.html" rel="noreferrer noopener" target="_blank">https://www.redhat.com/archives/virt-tools-list/2014-August/msg00002.html</a> 
Currently not supported through libvirt but planned. Not a problem, we can just document how to disable its easy and gui based. For those running from commandlines, they should just revert to a non SPICE adapter and they'll be fine. They are not missing much because they are not using the workstation as a desktop.
</p><p>Bugzilla Ticket:
<a class="external free" data-href="https://bugzilla.redhat.com/show_bug.cgi?id=1126641" href="https://bugzilla.redhat.com/show_bug.cgi?id=1126641" rel="noreferrer noopener" target="_blank">https://bugzilla.redhat.com/show_bug.cgi?id=1126641</a>
</p>
<h2><span id="Document:_how_to_leave_KVM_when_no_X_is_running?"></span><span class="mw-headline" id="Document:_how_to_leave_KVM_when_no_X_is_running.3F">Document: how to leave KVM when no X is running?</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=51" href="https://www.whonix.org/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=51.html" title="Edit section: Document: how to leave KVM when no X is running?">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Situation... User is in terminal in a VM... No X is running ("sudo service kdm stop"). User wants to switch back to the host... How to do this?
</p><p>The emulated tablet device handles this by not allowing the mouse to be captured by the guest.
Its still possible though:
</p><p>serverfault.com/questions/457603/any-way-to-release-focus-on-a-kvm-guest-in-virt-manager-without-havin-g-to-click
</p>
<pre>press Ctrl_L &amp; Alt_L</pre>
<p><br/>
</p>
<h2><span class="mw-headline" id="Audio_Retasking">Audio Retasking</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=52" href="https://www.whonix.org/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=52.html" title="Edit section: Audio Retasking">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>SPEAKE(a)R: Turn Speakers to Microphones for Fun
and Profit
<a class="external free" data-href="https://arxiv.org/ftp/arxiv/papers/1611/1611.07350.pdf" href="https://arxiv.org/ftp/arxiv/papers/1611/1611.07350.pdf" rel="noreferrer noopener" target="_blank">https://arxiv.org/ftp/arxiv/papers/1611/1611.07350.pdf</a>
</p><p><br/>
conclusion:
</p><p>While virtual sound devices might be retaskable with software too the malware still cannot access the soundcard settings of the host to retask it too given that the hypervisor is not broken.
</p><p>Replies from the QEMU devs. They confirm my conclusion that no risk posed to host. Also virtual soundcards optionally have half-duplex modes that make audio input impossible.
</p><p><a class="external free" data-href="https://lists.nongnu.org/archive/html/qemu-devel/2016-11/msg04754.html2" href="https://lists.nongnu.org/archive/html/qemu-devel/2016-11/msg04754.html2" rel="noreferrer noopener" target="_blank">https://lists.nongnu.org/archive/html/qemu-devel/2016-11/msg04754.html2</a>
Replies:
<a class="external free" data-href="https://lists.nongnu.org/archive/html/qemu-devel/2016-11/msg04899.html2" href="https://lists.nongnu.org/archive/html/qemu-devel/2016-11/msg04899.html2" rel="noreferrer noopener" target="_blank">https://lists.nongnu.org/archive/html/qemu-devel/2016-11/msg04899.html2</a>
<a class="external free" data-href="https://lists.nongnu.org/archive/html/qemu-devel/2016-11/msg04906.html2" href="https://lists.nongnu.org/archive/html/qemu-devel/2016-11/msg04906.html2" rel="noreferrer noopener" target="_blank">https://lists.nongnu.org/archive/html/qemu-devel/2016-11/msg04906.html2</a>
<a class="external free" data-href="https://lists.nongnu.org/archive/html/qemu-devel/2016-11/msg04904.html2" href="https://lists.nongnu.org/archive/html/qemu-devel/2016-11/msg04904.html2" rel="noreferrer noopener" target="_blank">https://lists.nongnu.org/archive/html/qemu-devel/2016-11/msg04904.html2</a>
</p><p><br/>
</p>
<h2><span id="libguestfs_import/export_feature_request"></span><span class="mw-headline" id="libguestfs_import.2Fexport_feature_request">libguestfs import/export feature request</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=53" href="https://www.whonix.org/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=53.html" title="Edit section: libguestfs import/export feature request">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Let's together write a feature request for an import/export feature for libguestfs, similar to VirtualBox's import/export feature. Then post in <a class="external text" data-href="https://bugzilla.redhat.com/buglist.cgi?component=libguestfs&amp;product=Virtualization%20Tools" href="https://bugzilla.redhat.com/buglist.cgi?component=libguestfs&amp;product=Virtualization%20Tools" rel="noreferrer noopener" target="_blank">libguestfs's bug tracker</a>.
</p><p>Irrelevant see virt-manager feature instead.
</p>
<h2><span id="virt-manager_import/export_feature_request"></span><span class="mw-headline" id="virt-manager_import.2Fexport_feature_request">virt-manager import/export feature request</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=54" href="https://www.whonix.org/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=54.html" title="Edit section: virt-manager import/export feature request">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Let's together write a feature request for an import/export feature for virt-manager, similar to VirtualBox's import/export feature. Then post in <a class="external text" data-href="https://bugzilla.redhat.com/buglist.cgi?product=Virtualization%20Tools&amp;classification=Community&amp;component=virt-manager&amp;bug_status=NEW&amp;bug_status=ASSIGNED" href="https://bugzilla.redhat.com/buglist.cgi?product=Virtualization%20Tools&amp;classification=Community&amp;component=virt-manager&amp;bug_status=NEW&amp;bug_status=ASSIGNED" rel="noreferrer noopener" target="_blank">virt-manager's bug tracker</a>.
</p><p>Update on import/export Support:
</p><p>Gnome Boxes, another simplified GUI for libvirt will have an OVF import feature added. Note that OVF is not the vmware vmdk specfic format OVA. In this sense making it a true standard.
</p><p>Its in the works and the Gnome contributor behind it has posted that he plans to make it into a stand-alone library so it could be used by other projects. Meaning it could be easily included in virt-manager too.
</p><p>His post:
<a class="external free" data-href="http://zee-nix.blogspot.com/2014/05/berlin-dx-hackfest-boxes-rain-and.html" href="http://zee-nix.blogspot.com/2014/05/berlin-dx-hackfest-boxes-rain-and.html" rel="noreferrer noopener" target="_blank">http://zee-nix.blogspot.com/2014/05/berlin-dx-hackfest-boxes-rain-and.html</a>
</p><p>Initial commit:
<a class="external free" data-href="https://gitorious.org/govf" href="https://gitorious.org/govf" rel="noreferrer noopener" target="_blank">https://gitorious.org/govf</a>
</p><p><br/>
Update 2016:
</p><p>Past efforts have come to a stop. Opened new discussion:
<a class="external free" data-href="https://www.redhat.com/archives/libvir-list/2016-March/msg00165.html" href="https://www.redhat.com/archives/libvir-list/2016-March/msg00165.html" rel="noreferrer noopener" target="_blank">https://www.redhat.com/archives/libvir-list/2016-March/msg00165.html</a>
</p>
<h2><span class="mw-headline" id="virt-v2v">virt-v2v</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=55" href="https://www.whonix.org/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=55.html" title="Edit section: virt-v2v">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Importing KVM to KVM - Not what its for: <a class="external free" data-href="https://rwmj.wordpress.com/2015/09/18/importing-kvm-guests-to-ovirt-or-rhev/#content" href="https://rwmj.wordpress.com/2015/09/18/importing-kvm-guests-to-ovirt-or-rhev/" rel="noreferrer noopener" target="_blank">https://rwmj.wordpress.com/2015/09/18/importing-kvm-guests-to-ovirt-or-rhev/#content</a>
</p>
<h3><span id="How_to_install_virt-v2v_on_Debian?"></span><span class="mw-headline" id="How_to_install_virt-v2v_on_Debian.3F">How to install virt-v2v on Debian?</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=56" href="https://www.whonix.org/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=56.html" title="Edit section: How to install virt-v2v on Debian?">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>virt-v2v is not yet in Debian. <a class="external text" data-href="https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=743261" href="https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=743261" rel="noreferrer noopener" target="_blank">wishlist request</a>
</p>
<h3><span id="Can_we_copy_and_paste_virt-v2v_in_meanwhile?"></span><span class="mw-headline" id="Can_we_copy_and_paste_virt-v2v_in_meanwhile.3F">Can we copy and paste virt-v2v in meanwhile?</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=57" href="https://www.whonix.org/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=57.html" title="Edit section: Can we copy and paste virt-v2v in meanwhile?">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Since virt2v2 is not yet in Debian, maybe it is a single script that can replace the <a class="external text" data-href="https://github.com/Whonix/Whonix/blob/master/libvirt/whonix_libvirt_import" href="https://github.com/Whonix/Whonix/blob/master/libvirt/whonix_libvirt_import" rel="noreferrer noopener" target="_blank">whonix_libvirt_import</a> script?
</p><p>HulaHoop: It is my opinion that we shelve the automated script idea completely and use virt-v2v when its possible/available. If virt-v2v does not work out, we should instead do the following: 1) ship multiple templates according to containment systems we want to support 2) A readme file with instructions on 
[a] how to copy the sparse file properly to any location a user wants if they wish
[b] how to introduce the sparse file into priviledged dirs like /var/lib..
[c] how to import xml for machines
[d] how to autostart the isolated network
[e] how to edit xml files in the case that they want to use non-default paths
</p><p>The build process would be scripted to update the version number of the name and disk img xml fields and thats it. 
</p><p>The absence of an easy way to import a machine is too big of an issue. We cannot compensate for a shortcoming as big as this coming from upstream. It would take tremendous effort as we have seen and some people might not be happy that it doesn't do X. So I say we leave it as described above.
</p>
<h3><span id="How_to_export_a_VM_using_virt-v2v?"></span><span class="mw-headline" id="How_to_export_a_VM_using_virt-v2v.3F">How to export a VM using virt-v2v?</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=58" href="https://www.whonix.org/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=58.html" title="Edit section: How to export a VM using virt-v2v?">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>This is what probably must be done in the build script. We got qcow2 files and xml. What command must be used to export a VM?
</p>
<h3><span id="How_to_export_a_VM_using_virt-v2v?_2"></span><span class="mw-headline" id="How_to_export_a_VM_using_virt-v2v.3F_2">How to export a VM using virt-v2v?</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=59" href="https://www.whonix.org/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=59.html" title="Edit section: How to export a VM using virt-v2v?">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>This is probably what users have to do to import. What command must be used to import a VM?
</p>
<h3><span class="mw-headline" id="Closed">Closed</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=60" href="https://www.whonix.org/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=60.html" title="Edit section: Closed">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Looks like we've settled on not using virt-v2v for either importing Whonix VMs or for cloning VMs. Probably mainly because v2v is not in Debian and hence doesn't make things simpler.
</p>
<h2><span class="mw-headline" id="Shared_Folder">Shared Folder</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=61" href="https://www.whonix.org/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=61.html" title="Edit section: Shared Folder">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>We should add instructions on how to use shared folders.
<a class="external free" data-href="http://www.linux-kvm.org/page/9p_virtio" href="http://www.linux-kvm.org/page/9p_virtio" rel="noreferrer noopener" target="_blank">http://www.linux-kvm.org/page/9p_virtio</a>
</p><p>Done: <a data-href="/wiki/KVM#KVM_Shared_Folders" href="../KVM.html" title="KVM">KVM#KVM_Shared_Folders</a>
</p>
<h2><span id="Script/automate_creation_and_upload_of_raw_images?"></span><span class="mw-headline" id="Script.2Fautomate_creation_and_upload_of_raw_images.3F">Script/automate creation and upload of raw images?</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=62" href="https://www.whonix.org/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=62.html" title="Edit section: Script/automate creation and upload of raw images?">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Because raw images have better performance than raw images? <a class="external free" data-href="http://www.linux-kvm.org/page/Qcow2" href="http://www.linux-kvm.org/page/Qcow2" rel="noreferrer noopener" target="_blank">http://www.linux-kvm.org/page/Qcow2</a>
</p><p>True that performance is better, but I don't think it supports snapshots AFAIK.
For something that supports snapshots and good performance lets stick with qcow2.
</p>
<h2><span class="mw-headline" id="write_generic_import_script">write generic import script</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=63" href="https://www.whonix.org/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=63.html" title="Edit section: write generic import script">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Maybe write generic import script as per: <br/>
<a class="external free" data-href="https://www.whonix.org/old-forum/index.php/topic,159.msg2412.html#msg2412" href="https://www.whonix.org/old-forum/index.php/topic,159.msg2412.html" rel="noreferrer noopener" target="_blank">https://www.whonix.org/old-forum/index.php/topic,159.msg2412.html#msg2412</a>
</p><p>A hellish solution and way too much work. Your time is spent better elsewhere. I'll use my time to get xml import validation working.
</p>
<h2><span id="Script/automate_creation_of_VM_description_files?"></span><span class="mw-headline" id="Script.2Fautomate_creation_of_VM_description_files.3F">Script/automate creation of VM description files?</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=64" href="https://www.whonix.org/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=64.html" title="Edit section: Script/automate creation of VM description files?">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>So not following manual instructions is required anymore, but copy/paste some commands end up with the correct VM configuration.
</p><p>Once the necessary commands are documented, Patrick will be happy to automate the steps with a script.
</p><p>HulaHoop created <a class="external text" data-href="https://github.com/Whonix/Whonix/tree/master/libvirt" href="https://github.com/Whonix/Whonix/tree/master/libvirt" rel="noreferrer noopener" target="_blank">xml files</a>, because kvm xml files can not be created using libvirt as VirtualBox VM setting files can be created using vboxmanage. This is not a problem.
</p>
<h2><span id="How_to_add_a_random_time_offset?"></span><span class="mw-headline" id="How_to_add_a_random_time_offset.3F">How to add a random time offset?</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=65" href="https://www.whonix.org/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=65.html" title="Edit section: How to add a random time offset?">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Having a small random offset (similar to <a data-href="/wiki/Advanced_Security_Guide#Network_Time_Synchronization" href="../Advanced_Security_Guide.html" title="Advanced Security Guide">Advanced_Security_Guide#Network_Time_Synchronization</a>) would be a good thing.
</p><p>Patrick said: Thanks to <a class="external text" data-href="https://github.com/Whonix/bootclockrandomization" href="https://github.com/Whonix/bootclockrandomization" rel="noreferrer noopener" target="_blank">bootclockrandomization</a> this is no longer necessary.
</p>
<h2><span class="mw-headline" id="xml_does_not_validate">xml does not validate</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=66" href="https://www.whonix.org/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=66.html" title="Edit section: xml does not validate">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<pre>virsh --version
0.9.12.3
</pre>
<pre>virt-xml-validate whonix_gateway.xml
whonix_gateway.xml:24: element pm: Relax-NG validity error : Element domain has extra content: pm
whonix_gateway.xml fails to validate
</pre>
<pre>virt-xml-validate whonix_workstation.xml 
whonix_workstation.xml:24: element pm: Relax-NG validity error : Element domain has extra content: pm
whonix_workstation.xml fails to validate
</pre>
<pre>virt-xml-validate whonix_network.xml 
whonix_network.xml:1: element network: Relax-NG validity error : Invalid attribute connections for element network                                                                  
whonix_network.xml fails to validate
</pre>
<p>kvmclock had to be under rtc for it to work. The Network xml validates on my machine without changes however. Please check if it works and post back.
</p><p>The virt-xml-validate I tested with is a newer version. Try updating to a more recent one and try again, I think it may be buggy or not updated enough to interpret new schema they may have added since .9x was released.
</p><p>Patrick said: HulaHoop said this is only due to different KVM versions and won't cause issues.
</p><p>Patrick said: Leaving automatic validation out for now. Can still be done manually after editing the xml files.
</p>
<h2><span class="mw-headline" id="Run_virt-xml-validate_during_build_process">Run virt-xml-validate during build process</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=67" href="https://www.whonix.org/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=67.html" title="Edit section: Run virt-xml-validate during build process">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>We should use.
</p>
<pre>virt-xml-validate libvirt.xml
</pre>
<p>Patrick will be happy to add this command to the build process when using --kvm (or --qemu?) switch. Scripting this should be simple and the build process could fail early and closed (break).
</p><p>Patrick said: Since validation is too version specific (see above), we're not doing this.
</p>
<h2><span class="mw-headline" id="Weaker_warning_against_KVM_in_whonixcheck">Weaker warning against KVM in whonixcheck</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=68" href="https://www.whonix.org/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=68.html" title="Edit section: Weaker warning against KVM in whonixcheck">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>As soon as all blockers have been sorted out. We could recommend using <a data-href="/wiki/KVM" href="../KVM.html" title="KVM">KVM</a> instructions.
</p><p>Done.
</p>
<h2><span id="Leak_Tests?"></span><span class="mw-headline" id="Leak_Tests.3F">Leak Tests?</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=69" href="https://www.whonix.org/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=69.html" title="Edit section: Leak Tests?">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p><a class="new" data-href="/w/index.php?title=HulaHoop1&amp;action=edit&amp;redlink=1" href="https://www.whonix.org/w/index.php?title=HulaHoop1&amp;action=edit&amp;redlink=1.html" title="HulaHoop1 (page does not exist)">HulaHoop1</a> sorted that out in <a class="new" data-href="/wiki/Special:AWCforum/st/id306/" href="../Special:AWCforum/st/id306/.html" title="Special:AWCforum/st/id306/ (page does not exist)">Special:AWCforum/st/id306/</a>.
</p>
<h2><span id="Hardware_serials?"></span><span class="mw-headline" id="Hardware_serials.3F">Hardware serials?</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=70" href="https://www.whonix.org/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=70.html" title="Edit section: Hardware serials?">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p><a class="new" data-href="/w/index.php?title=HulaHoop1&amp;action=edit&amp;redlink=1" href="https://www.whonix.org/w/index.php?title=HulaHoop1&amp;action=edit&amp;redlink=1.html" title="HulaHoop1 (page does not exist)">HulaHoop1</a> sorted that out in <a class="new" data-href="/wiki/Special:AWCforum/st/id306/" href="../Special:AWCforum/st/id306/.html" title="Special:AWCforum/st/id306/ (page does not exist)">Special:AWCforum/st/id306/</a>.
</p>
<h2><span id="How_to_Edit_in_nano_with_virsh?"></span><span class="mw-headline" id="How_to_Edit_in_nano_with_virsh.3F">How to Edit in nano with virsh?</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=71" href="https://www.whonix.org/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=71.html" title="Edit section: How to Edit in nano with virsh?">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>su
</p>
<ol><li>EDITOR=nano virsh edit <i>GuestMachineName</i></li></ol>
<h2><span class="mw-headline" id="whonixcheck_KVMClock">whonixcheck KVMClock</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=72" href="https://www.whonix.org/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=72.html" title="Edit section: whonixcheck KVMClock">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Whonixcheck should check if <code>/sys/devices/system/clocksource/clocksource0/current_clocksource</code> is <code>kvm-clock</code> and warn if it does.
</p><p>Implemented: <a class="external free" data-href="https://github.com/Whonix/Whonix/commit/2584c3bdcd9a98181c7535f963a615d257e0fefd" href="https://github.com/Whonix/Whonix/commit/2584c3bdcd9a98181c7535f963a615d257e0fefd" rel="noreferrer noopener" target="_blank">https://github.com/Whonix/Whonix/commit/2584c3bdcd9a98181c7535f963a615d257e0fefd</a>
</p>
<h2><span id="Is_it_possible_to_add_64,_128_or_even_more_MB_to_the_virtual_graphics_card_using_the_command_line_to_boost_graphics_performance?"></span><span class="mw-headline" id="Is_it_possible_to_add_64.2C_128_or_even_more_MB_to_the_virtual_graphics_card_using_the_command_line_to_boost_graphics_performance.3F">Is it possible to add 64, 128 or even more MB to the virtual graphics card using the command line to boost graphics performance?</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=73" href="https://www.whonix.org/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=73.html" title="Edit section: Is it possible to add 64, 128 or even more MB to the virtual graphics card using the command line to boost graphics performance?">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Yes. Can be realised by virsh command as per the steps in here:
<a class="external free" data-href="http://serverfault.com/questions/346301/how-to-increase-video-memory-in-libvirt-kvm-gui" href="http://serverfault.com/questions/346301/how-to-increase-video-memory-in-libvirt-kvm-gui" rel="noreferrer noopener" target="_blank">http://serverfault.com/questions/346301/how-to-increase-video-memory-in-libvirt-kvm-gui</a>
</p>
<h2><span id="KVM_Instructions_recommend_to_use_a_no_cache_policy?"></span><span class="mw-headline" id="KVM_Instructions_recommend_to_use_a_no_cache_policy.3F">KVM Instructions recommend to use a no cache policy?</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=74" href="https://www.whonix.org/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=74.html" title="Edit section: KVM Instructions recommend to use a no cache policy?">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>As per <a class="external text" data-href="http://www.ilsistemista.net/index.php/virtualization/11-kvm-io-slowness-on-rhel-6.html?start=7" href="http://www.ilsistemista.net/index.php/virtualization/11-kvm-io-slowness-on-rhel-6.html?start=7" rel="noreferrer noopener" target="_blank">blog post</a> it is recommended to use a no cache policy. Do our KVM instructions need changes to incorporate this?
</p><p>Yes if its recommended then lets do this, Its easily done through the GUI by going to: disk -&gt; Cache policy: set to none
</p>
<h2><span id="Script/automate_creation_and_upload_of_qcow2_images?"></span><span class="mw-headline" id="Script.2Fautomate_creation_and_upload_of_qcow2_images.3F">Script/automate creation and upload of qcow2 images?</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=75" href="https://www.whonix.org/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=75.html" title="Edit section: Script/automate creation and upload of qcow2 images?">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Done.
</p>
<h2><span class="mw-headline" id="Verifiable_Builds_for_qcow2_images">Verifiable Builds for qcow2 images</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=76" href="https://www.whonix.org/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=76.html" title="Edit section: Verifiable Builds for qcow2 images">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>The <a class="external free" data-href="https://github.com/Whonix/Whonix/blob/master/help-steps/analyze_image" href="https://github.com/Whonix/Whonix/blob/master/help-steps/analyze_image" rel="noreferrer noopener" target="_blank">https://github.com/Whonix/Whonix/blob/master/help-steps/analyze_image</a> requires supports raw, vdi, vmdk, qcow and qcow2 images as well as .ova appliances.
</p>
<h2><span class="mw-headline" id="metadata_preallocated_images">metadata preallocated images</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=77" href="https://www.whonix.org/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=77.html" title="Edit section: metadata preallocated images">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>For better performance. (As per <a class="external text" data-href="http://www.ilsistemista.net/index.php/virtualization/11-kvm-io-slowness-on-rhel-6.html" href="http://www.ilsistemista.net/index.php/virtualization/11-kvm-io-slowness-on-rhel-6.html" rel="noreferrer noopener" target="_blank">blog post</a>.) Done in 7.7.8.0.
</p>
<h2><span class="mw-headline" id="qcow2_compression">qcow2 compression</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=78" href="https://www.whonix.org/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=78.html" title="Edit section: qcow2 compression">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>When uncompressed, upload would take ~250 hours per image. Now compressing using tar. [Not using qcow2's compression feature.]
</p>
<h2><span id="How_to_disable_KVMClock?"></span><span class="mw-headline" id="How_to_disable_KVMClock.3F">How to disable KVMClock?</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=79" href="https://www.whonix.org/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=79.html" title="Edit section: How to disable KVMClock?">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>In xml file add:
&lt;timer name='kvmclock' present='no'/&gt;
</p><p><br/>
What does KVMClock do? "kvmclock or KVM pvclock lets guests read the host’s wall clock time." This is bad. <a class="external text" data-href="http://rwmj.wordpress.com/2010/10/15/kvm-pvclock/" href="http://rwmj.wordpress.com/2010/10/15/kvm-pvclock/" rel="noreferrer noopener" target="_blank">source</a>
</p><p><br/>
How to adjust KVM to have clock=vm on host.
</p><p>See <a class="external free" data-href="http://www.linux-kvm.org/page/KVMClock" href="http://www.linux-kvm.org/page/KVMClock" rel="noreferrer noopener" target="_blank">http://www.linux-kvm.org/page/KVMClock</a>
</p><p><a class="external free" data-href="http://libvirt.org/formatdomain.html#elementsTime" href="http://libvirt.org/formatdomain.html" rel="noreferrer noopener" target="_blank">http://libvirt.org/formatdomain.html#elementsTime</a>
</p><p><a class="external free" data-href="https://www.redhat.com/archives/libvir-list/2010-March/msg01293.html" href="https://www.redhat.com/archives/libvir-list/2010-March/msg01293.html" rel="noreferrer noopener" target="_blank">https://www.redhat.com/archives/libvir-list/2010-March/msg01293.html</a>
</p><p><a class="external free" data-href="https://doc.opensuse.org/products/draft/SLES/SLES-kvm_sd_draft/cha.qemu.running.html#cha.qemu.running.gen_opts.rtc" href="https://doc.opensuse.org/products/draft/SLES/SLES-kvm_sd_draft/cha.qemu.running.html" rel="noreferrer noopener" target="_blank">https://doc.opensuse.org/products/draft/SLES/SLES-kvm_sd_draft/cha.qemu.running.html#cha.qemu.running.gen_opts.rtc</a>
</p>
<pre>ls /sys/devices/system/clocksource/clocksource0/current_clocksource
</pre>
<p>To ensure that you have successfully isolated the vm clock form the host's you must run this in the vm:
</p>
<pre>sudo chmod -x /etc/init.d/sdwdate
</pre>
<p>You should verify that kvmclock is indeed disabled by running this command as root.
</p>
<pre>cat /sys/devices/system/clocksource/clocksource0/current_clocksource
</pre>
<p>Make sure <code>kvmclock</code> is not listed as a response any longer.
</p><p>Documented for reference but is irrelevant as of now since this problem is solved.
</p><p><br/>
<a class="external free" data-href="https://bugzilla.redhat.com/show_bug.cgi?id=783921#c6" href="https://bugzilla.redhat.com/show_bug.cgi?id=783921" rel="noreferrer noopener" target="_blank">https://bugzilla.redhat.com/show_bug.cgi?id=783921#c6</a> &lt; This link provides the solution to disabling kvmclock and verifying that it is so.
</p><p>whonixcheck (since Whonix 8) would tell you if kvmclock is enabled. whonixcheck --verbose will tell you, that it is not enabled.
</p>
<h2><span class="mw-headline" id="Fix_subnet_range_in_KVM_instructions">Fix subnet range in KVM instructions</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=80" href="https://www.whonix.org/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=80.html" title="Edit section: Fix subnet range in KVM instructions">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>As found out by zweeble in <a class="external free" data-href="https://www.whonix.org/old-forum/index.php/topic,328.0.html" href="https://www.whonix.org/old-forum/index.php/topic,328.0.html" rel="noreferrer noopener" target="_blank">https://www.whonix.org/old-forum/index.php/topic,328.0.html</a>, subnet range must be adjusted to make KVM work.
</p><p>HulaHoop: I think until we can be sure that this is a problem it shouldn't be considered a blocker
</p>
<h2><span class="mw-headline" id="Readme_Commands_and_Warnings">Readme Commands and Warnings</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=81" href="https://www.whonix.org/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=81.html" title="Edit section: Readme Commands and Warnings">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Until we compile and test a list of virsh commands needed for operating on vm templates and associated disk storage, we should shot release KVM version to the public.
</p>
<pre># virsh net-define [path]/whonix_network.xml
Internal network 'Whonix' defined from network xml file residing in the following directory path.
# virsh net-autostart Whonix
Network 'Whonix' marked to be autostarted upon boot.
# virsh net-start Whonix
Network 'Whonix' has been started
</pre>
<p><br/>
</p>
<h2><span class="mw-headline" id="Leak">Leak</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=82" href="https://www.whonix.org/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=82.html" title="Edit section: Leak">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<ul><li><a class="external text" data-href="https://www.whonix.org/old-forum/index.php/topic,243.msg1636.html" href="https://www.whonix.org/old-forum/index.php/topic,243.msg1636.html" rel="noreferrer noopener" target="_blank">New FIN ACK / RST ACK Leak Test</a></li>
<li><a class="external text" data-href="https://www.whonix.org/old-forum/index.php/topic,243.msg1636.html#msg1636" href="https://www.whonix.org/old-forum/index.php/topic,243.msg1636.html" rel="noreferrer noopener" target="_blank">Reported by HulaHoop</a></li>
<li>Was a <a class="external text" data-href="https://www.whonix.org/old-forum/index.php/topic,331.msg2269.html#msg2269" href="https://www.whonix.org/old-forum/index.php/topic,331.msg2269.html" rel="noreferrer noopener" target="_blank">false positive</a> due to a bug in leak testing instructions (now fixed).</li></ul>
<h2><span id="Instructions_include_how_to_set_clock_to_UTC?"></span><span class="mw-headline" id="Instructions_include_how_to_set_clock_to_UTC.3F">Instructions include how to set clock to UTC?</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=83" href="https://www.whonix.org/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=83.html" title="Edit section: Instructions include how to set clock to UTC?">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>As per <a class="external free" data-href="http://libvirt.org/formatdomain.html#elementsTime" href="http://libvirt.org/formatdomain.html" rel="noreferrer noopener" target="_blank">http://libvirt.org/formatdomain.html#elementsTime</a>
</p><p>The <b>clock</b> setting.
</p><p>Quote:
</p>
<blockquote>
<p>The offset attribute takes four possible values, allowing fine grained control over how the guest clock is synchronized to the host. NB, not all hypervisors support all modes.
</p>
</blockquote>
<p>How to check, that it is set to <b>utc</b>?
</p><p>It is set to utc by default. A quick look at the xml file will show: &lt;clock offset='utc'&gt;
</p>
<h2><span id="How_to_use_-rtc_clock=vm_?"></span><span class="mw-headline" id="How_to_use_-rtc_clock.3Dvm_.3F">How to use -rtc clock=vm ?</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=84" href="https://www.whonix.org/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=84.html" title="Edit section: How to use -rtc clock=vm ?">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>KVM's <b>-rtc</b> option as per <a class="external free" data-href="https://doc.opensuse.org/products/draft/SLES/SLES-kvm_sd_draft/cha.qemu.running.html#cha.qemu.running.gen_opts.rtc" href="https://doc.opensuse.org/products/draft/SLES/SLES-kvm_sd_draft/cha.qemu.running.html" rel="noreferrer noopener" target="_blank">https://doc.opensuse.org/products/draft/SLES/SLES-kvm_sd_draft/cha.qemu.running.html#cha.qemu.running.gen_opts.rtc</a>
</p><p>This is the original qemu patchset that implements clock=vm in the timer back-ends: <a class="external free" data-href="https://www.redhat.com/archives/libvir-list/2010-March/msg01293.html" href="https://www.redhat.com/archives/libvir-list/2010-March/msg01293.html" rel="noreferrer noopener" target="_blank">https://www.redhat.com/archives/libvir-list/2010-March/msg01293.html</a>
</p>
<blockquote>
<p>If you need to isolate the VM Guest clock from the host one, specify clock=vm instead of the default clock=host. 
</p>
</blockquote>
<p>How to use <b>-rtc clock=vm</b> ?
</p><p>How to check, that KVM <b>-rtc</b> is set to <b>clock=vm</b> ?
</p><p><br/>
</p><p>Does not seem to be a valid or accepted parameter by libvirt as its always sanitized from the xml file upon saving. But it is  accepted by QEMU directly. However I noticed that even with kvmclock enabled, I no longer see any change in a guest's time in response to a host skew of the time. In the recent past this was not true, as any change was immediately reflected in the Guest clock immediately. kvmclock on its own can be disabled  and confirmed to be so as outlined below.
</p>
<h2><span id="What_is_timer_pit?"></span><span class="mw-headline" id="What_is_timer_pit.3F">What is timer pit?</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=85" href="https://www.whonix.org/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=85.html" title="Edit section: What is timer pit?">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>What is timer pit?
</p><p>HulaHoop:
Whatever it was, its now gone. I overlooked this by mistake.
</p><p>We are using.
</p>
<pre>    &lt;timer name='kvmclock' present='no'/&gt;
    &lt;timer name='hpet' present='no'/&gt;
</pre>
<p>But why are we using?
</p>
<pre>    &lt;timer name='pit' tickpolicy='no'/&gt;
</pre>
<p>Why are we not using?
</p>
<pre>    &lt;timer name='pit' present='no'/&gt;
</pre>
<h2><span class="mw-headline" id="virt-image">virt-image</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=86" href="https://www.whonix.org/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=86.html" title="Edit section: virt-image">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<h3><span class="mw-headline" id="Users_Expected_Scenario">Users Expected Scenario</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=87" href="https://www.whonix.org/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=87.html" title="Edit section: Users Expected Scenario">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p><font size="-3"><a class="external text" data-href="https://fedoraproject.org/wiki/Features/ApplianceTools#Users_Expected_Scenario" href="https://fedoraproject.org/wiki/Features/ApplianceTools" rel="noreferrer noopener" target="_blank">source</a></font>
</p>
<pre>sudo apt-get install virt-manager
</pre>
<p>Extract Whonix-Gateway-8.3.qcow2.xz.
</p><p>Import.
</p>
<pre>virt-image Whonix-Gateway-8.3.xml
</pre>
<p>Start Whonix-Gateway in virt-manager.
</p>
<h3><span class="mw-headline" id="xml_creation">xml creation</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=88" href="https://www.whonix.org/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=88.html" title="Edit section: xml creation">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>How can we create an xml file, that can be imported using virt-image?
</p><p>Possible help: <br/>
<a class="external free" data-href="https://fedoraproject.org/wiki/Features/ApplianceTools#Release_Engineering" href="https://fedoraproject.org/wiki/Features/ApplianceTools" rel="noreferrer noopener" target="_blank">https://fedoraproject.org/wiki/Features/ApplianceTools#Release_Engineering</a>
</p><p>Maybe we need to learn from their fedora-aos.xml to structure whonix xml.
</p><p>Since virt-image has been deprecated, this is no option. Source: <br/>
<a class="external free" data-href="http://blog.wikichoon.com/2014/04/deprecating-little-used-tool-virt-image1.html" href="http://blog.wikichoon.com/2014/04/deprecating-little-used-tool-virt-image1.html" rel="noreferrer noopener" target="_blank">http://blog.wikichoon.com/2014/04/deprecating-little-used-tool-virt-image1.html</a>
</p>
<h2><span id="How_to_get_virtio_running_for_storage?"></span><span class="mw-headline" id="How_to_get_virtio_running_for_storage.3F">How to get virtio running for storage?</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=89" href="https://www.whonix.org/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=89.html" title="Edit section: How to get virtio running for storage?">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<h3><span class="mw-headline" id="Initial_Instructions">Initial Instructions</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=90" href="https://www.whonix.org/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=90.html" title="Edit section: Initial Instructions">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Virtio-blk now works
</p><p>Here are the steps, which I'll throw altogether here before the server downtime. Will move into the wiki later:
</p><p><a class="external free" data-href="http://www.linux-kvm.org/page/Boot_from_virtio_block_device" href="http://www.linux-kvm.org/page/Boot_from_virtio_block_device" rel="noreferrer noopener" target="_blank">http://www.linux-kvm.org/page/Boot_from_virtio_block_device</a>        &lt; Original steps that needed to be changed so it can apply to Debian.
</p><p>Quote
</p>
<pre>   in guest os, change /boot/grub/device.map from "(hd0) /dev/sda" to "(hd0) /dev/vda"
   in guest os, change /boot/grub/grub.cfg from "root=/dev/sda1" to "root=/dev/vda1", if you are using UUID, then no need to do this step. 
</pre>
<p><br/>
I changed all mention of sda1 to vda1 in the grub file. I changed the disk controller type from virtmanager to virtio which takes care of this at the libvirt xml level. Now the vm boots normally with no hangups and I feel a little faster.
</p>
<pre>A bit of advice, that I'll add so you can decide:
</pre>
<p><br/>
Quote
</p>
<pre>   &lt;iggy&gt; bancfc: the better option would be using LABELs and UUIDs and such in the source image
   &lt;iggy&gt; unless this is a one time conversion kind of thing
</pre>
<h3><span class="mw-headline" id="Using_LABELs">Using LABELs</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=91" href="https://www.whonix.org/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=91.html" title="Edit section: Using LABELs">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Patrick asks: How to use LABELs?
</p><p>Patrick says: Nevermind. We're now using UUIDs.
</p>
<h3><span class="mw-headline" id="Using_UUIDs">Using UUIDs</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=92" href="https://www.whonix.org/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=92.html" title="Edit section: Using UUIDs">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Patrick writes: In Whonix 9, fstab will look like this.
</p>
<pre>cat /etc/fstab
</pre>
<pre>/dev/disk/by-uuid/26ada0c0-1165-4098-884d-aafd2220c2c6 /  auto    defaults,errors=remount-ro 0   1
proc           /proc        proc    defaults                      0   0
/dev/cdrom     /mnt/cdrom0  iso9660 ro,user,noauto                0   0
# some other examples:
# /dev/sda2       none         swap    sw,pri=0             0   0
# /dev/hda1       /Grml        ext3    dev,suid,user,noauto 0  2
# //1.2.3.4/pub   /smb/pub     cifs    user,noauto,uid=grml,gid=grml 0 0                                                                                                            
# linux:/pub      /beer        nfs     defaults             0  0                                                                                                                    
# tmpfs           /tmp         tmpfs   size=300M            0  0                                                                                                                    
# /dev/sda5       none         swap    sw                   0  0
</pre>
<p>The relevant part here is.
</p>
<pre>/dev/disk/by-uuid/26ada0c0-1165-4098-884d-aafd2220c2c6 /  auto    defaults,errors=remount-ro 0   1
</pre>
<p>The UUID <span style="border:1px dotted #005cb9">26ada0c0-1165-4098-884d-aafd2220c2c6</span> is a fixed one. (Feature by grml-debootstrap.)
</p>
<pre>grep 26ada0c0-1165-4098-884d-aafd2220c2c6 /usr/sbin/grml-debootstrap                                                                                        
           tune2fs "$TARGET" -U 26ada0c0-1165-4098-884d-aafd2220c2c6
</pre>
<p>Maybe using UUID and even a fixed one will aid this feature.
</p><p><br/>
</p><p>HulaHoop: Yes it will. I found very encouraging answers to your inquiries on the forum that I'll post here:
</p>
<pre>1. activate virtio-blk in a booted image
2. check virtio-blk is really in use (../Dev/KVM#How_to_check_if_virtio_storage_access_is_in_use_or_an_eventually_existing_fallback_driver.3F)
3. see how we can automate this using Whonix's build script / Whonix's packages
</pre>
<p>1. From my IRC chats with KVM devs, the virtio driverof concern has been included in all distros for a while now and is used by simply having libvirt select it so.
</p><p>2. lsmod : lists all currently running modules
</p>
<pre>   modinfo &lt;module name&gt; : information about associated devices
   hwinfo --short : see which driver is loaded for each particular device
</pre>
<p>3. UUID is the answer from what I recall from different sources inluding KVM documentation. From a post towards the bottom of a thread, someone describes how to configure the kernel to use UUID to boot:
forums.gentoo.org/viewtopic-p-6668919.html
</p>
<h3><span id="/boot/grub/grub.cfg_issue"></span><span class="mw-headline" id=".2Fboot.2Fgrub.2Fgrub.cfg_issue">/boot/grub/grub.cfg issue</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=93" href="https://www.whonix.org/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=93.html" title="Edit section: /boot/grub/grub.cfg issue">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Patrick comments: I think /boot/grub/grub.cfg is a unstable solution. That file says on top.
</p>
<pre># DO NOT EDIT THIS FILE
#
# It is automatically generated by grub-mkconfig using templates
# from /etc/grub.d and settings from /etc/default/grub
</pre>
<p>So when there is a kernel upgrade, /boot/grub/grub.cfg will be regenerated and the changes will be lost.
</p><p>Patrick asks: How do we apply these settings in a way, so they do survive an "sudo update-grub" (which is automatically run on every kernel upgrade).
</p><p>Patrick says: this is no longer required, since we're now using UUID's in grub.cfg.
</p>
<h3><span id="System_gets_unbootable?"></span><span class="mw-headline" id="System_gets_unbootable.3F">System gets unbootable?</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=94" href="https://www.whonix.org/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=94.html" title="Edit section: System gets unbootable?">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Patrick comments: After editing /boot/grub/grub.cfg, in worst case, maybe, the system will be no longer bootable then. You can test/simulate this case by running "sudo update-grub". Please try.
</p><p>HulaHoop comments: I found a solution, one that survives kernel and grub upgrades: <a class="external free" data-href="http://grumpymole.blogspot.nl/2007/05/ubuntu-how-to-edit-grub-boot-parameters.html" href="http://grumpymole.blogspot.nl/2007/05/ubuntu-how-to-edit-grub-boot-parameters.html" rel="noreferrer noopener" target="_blank">http://grumpymole.blogspot.nl/2007/05/ubuntu-how-to-edit-grub-boot-parameters.html</a>
</p>
<pre>2.2 Making a change survive upgrades

Depending on how frequently you upgrade your system, you might find that when a new kernel is installed, or grub is upgraded (there may be other scenarios), the /boot/grub/menu.lst file may be replaced by a newer version, or a new line might be added for the new kernel. In this case, your "permanent" changes might be as permanent as you thought.

The best way to address this is to change the "#kopt..." line in /boot/grub/menu.lst. Note that the line is not commented out, even though it starts with a "#". See the excerpt below.

    ### BEGIN AUTOMAGIC KERNELS LIST
    ## lines between the AUTOMAGIC KERNELS LIST markers will be modified
    ## by the debian update-grub script except for the default options below

    ## DO NOT UNCOMMENT THEM, Just edit them to your needs

    ## ## Start Default Options ##
    ## default kernel options
    ## default kernel options for automagic boot options
    ## If you want special options for specific kernels use kopt_x_y_z
    ## where x.y.z is kernel version. Minor versions can be omitted.
    ## e.g. kopt=root=/dev/hda1 ro
    ## kopt_2_6_8=root=/dev/hdc1 ro
    ## kopt_2_6_8_2_686=root=/dev/hdc2 ro
    # kopt=root=UUID=fccafcc7-d7cc-4594-9459-a8f0db7b9f7f ro

Add the parameter changes to the end of the line "#kopt...". These parameters will then be automatically added to any new kernel entries and should also survive an upgrade of grub</pre>
<p>Patrick comments: Have you tested this?
</p><p>Patrick comments: I am not sure editing /boot/grub/grub.cfg is a robust solution. We cannot directly ship a /boot/grub/grub.cfg in a deb, because it is an auto generated file by grub-mkconfig. (When that deb was updated, /boot/grub/grub.cfg would be outdated, system unbootable, you know?) Maybe a package could be created, that appends /boot/grub/grub.cfg, but still, any solution not touching /boot/grub/grub.cfg should be preferred. If we could edit/extend /etc/default/grub, /etc/default/grub.d or /etc/grub.d, that would be much more robust. What is the official suggestion by kvm devs to solve this as a distro?
</p><p>Patrick says: this is no longer required, since we're now using UUID's in grub.cfg.
</p>
<h3><span class="mw-headline" id="Virtio_Block_Latency">Virtio Block Latency</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=95" href="https://www.whonix.org/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=95.html" title="Edit section: Virtio Block Latency">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Not really important but is interesting: <br/>
<a class="external free" data-href="http://www.linux-kvm.org/page/Virtio/Block/Latency" href="http://www.linux-kvm.org/page/Virtio/Block/Latency" rel="noreferrer noopener" target="_blank">http://www.linux-kvm.org/page/Virtio/Block/Latency</a>
</p><p>HulaHoop: Yes it could have been the situation that there is latency as the data shows, but I'm sure this was improved by now.
</p>
<h3><span id="Well_what'ya_know_It_is_a_bug!"></span><span class="mw-headline" id="Well_what.27ya_know_It_is_a_bug.21">Well what'ya know It is a bug!</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=96" href="https://www.whonix.org/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=96.html" title="Edit section: Well what'ya know It is a bug!">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>HulaHoop wrote: <br/>
The reason I struggled so much to get this working is because of an ancient bug that has a workaround in the build process by naming disks to vdX instead of sdX.
Please generate a test image with these changes.
</p><p><a class="external free" data-href="https://bugs.launchpad.net/ubuntu/+source/vm-builder/+bug/517067" href="https://bugs.launchpad.net/ubuntu/+source/vm-builder/+bug/517067" rel="noreferrer noopener" target="_blank">https://bugs.launchpad.net/ubuntu/+source/vm-builder/+bug/517067</a>
Please read this comment for the workarounds:
<a class="external free" data-href="https://bugs.launchpad.net/ubuntu/+source/vm-builder/+bug/517067/comments/4" href="https://bugs.launchpad.net/ubuntu/+source/vm-builder/+bug/517067/comments/4" rel="noreferrer noopener" target="_blank">https://bugs.launchpad.net/ubuntu/+source/vm-builder/+bug/517067/comments/4</a>
</p><p>&gt; b.) linux/udev : you could suggest that the vdX devices should be symlinked or other to sdX so that your fstab finds the devices independent of how they're connected. -&gt; A suggestion for linux/udev. Not Whonix.
</p><p>Patrick says: this is no longer required, since we're now using UUID's in grub.cfg.
</p>
<h3><span class="mw-headline" id="Solved">Solved</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=97" href="https://www.whonix.org/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=97.html" title="Edit section: Solved">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p><a class="external free" data-href="https://www.whonix.org/old-forum/index.php/topic,401.msg3099.html#msg3099" href="https://www.whonix.org/old-forum/index.php/topic,401.msg3099.html" rel="noreferrer noopener" target="_blank">https://www.whonix.org/old-forum/index.php/topic,401.msg3099.html#msg3099</a>
</p>
<h2><span id="Enable_virtio_by_default?"></span><span class="mw-headline" id="Enable_virtio_by_default.3F">Enable virtio by default?</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=98" href="https://www.whonix.org/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=98.html" title="Edit section: Enable virtio by default?">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Probably yes?
</p><p><a class="external free" data-href="https://wiki.debian.org/DebianKVMGuests" href="https://wiki.debian.org/DebianKVMGuests" rel="noreferrer noopener" target="_blank">https://wiki.debian.org/DebianKVMGuests</a>
</p>
<h2><span id="Boot_from_virtio_block_device?"></span><span class="mw-headline" id="Boot_from_virtio_block_device.3F">Boot from virtio block device?</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=99" href="https://www.whonix.org/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=99.html" title="Edit section: Boot from virtio block device?">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>What is <a class="external free" data-href="http://www.linux-kvm.org/page/Boot_from_virtio_block_device" href="http://www.linux-kvm.org/page/Boot_from_virtio_block_device" rel="noreferrer noopener" target="_blank">http://www.linux-kvm.org/page/Boot_from_virtio_block_device</a> good for? Required?
</p>
<h2><span class="mw-headline" id="Disable_Microphone_Feature_Request">Disable Microphone Feature Request</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=100" href="https://www.whonix.org/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=100.html" title="Edit section: Disable Microphone Feature Request">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Let's together write a feature request for an option to disable sound. Maybe like this.
</p><p>Adds only speaker, no microphone.
</p>
<pre>  &lt;devices&gt;
    &lt;sound model='ich6'&gt;
      &lt;codec type='speaker'/&gt;
    &lt;sound/&gt;
  &lt;/devices&gt;
</pre>
<p>Then post it... Where?
</p><p>Done: <br/>
<a class="external free" data-href="https://bugzilla.redhat.com/show_bug.cgi?id=1126641" href="https://bugzilla.redhat.com/show_bug.cgi?id=1126641" rel="noreferrer noopener" target="_blank">https://bugzilla.redhat.com/show_bug.cgi?id=1126641</a>
</p><p><br/>
</p><p><br/>
This is finally it. Added in Libvirt 4.4.0. Need to add it when Buster rolls around.
</p><p><i>qemu: Add support for 'output' audio codec</i>
Support QEMU's 'hda-output' codec advertising only a line-out for ich6 and ich9 sound devices.<i></i>
</p>
<h2><span class="mw-headline" id="Debian_Network_NAT_Issue">Debian Network NAT Issue</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=101" href="https://www.whonix.org/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=101.html" title="Edit section: Debian Network NAT Issue">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<pre>error: Requested operation is not valid: network 'default' is not active
</pre>
<p>See: <a class="external free" data-href="https://www.whonix.org/old-forum/index.php/topic,690.msg6076.html#msg6076" href="https://www.whonix.org/old-forum/index.php/topic,690.msg6076.html" rel="noreferrer noopener" target="_blank">https://www.whonix.org/old-forum/index.php/topic,690.msg6076.html#msg6076</a>
</p>
<h1><span class="mw-headline" id="Archived_Discussions">Archived Discussions</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=102" href="https://www.whonix.org/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=102.html" title="Edit section: Archived Discussions">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<ul><li><a class="external text" data-href="https://www.whonix.org/old-forum/index.php/topic,202.0/topicseen.html" href="https://www.whonix.org/old-forum/index.php/topic,202.0/topicseen.html" rel="noreferrer noopener" target="_blank">qcow2 with metadata preallocation file sizes</a></li></ul>
<h1><span class="mw-headline" id="Archived_IRC_Logs">Archived IRC Logs</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=103" href="https://www.whonix.org/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=103.html" title="Edit section: Archived IRC Logs">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<pre>* Now talking on #kvm
* Topic for #kvm is: KVM wiki website is http://www.linux-kvm.org - try status and faq pages, no really, read them! || you can also check the qemu manual at http://wiki.qemu.org/download/qemu-doc.html || don't paste on chan, use http://pastebin.com/ instead || libvirt/virt-manager support is #virt on irc.oftc.net
* Topic for #kvm set by aliguori at Wed Mar 30 13:38:24 2011
&lt;bancfc&gt; Hi How do I check if virtio storage is in use or an existing fallback driver for an emulated device?
&lt;iggy&gt; there's no fallback in kvm like in xen
&lt;bancfc&gt; so a simple grep should verify if a virtio device is used then - not merely attached I mean?
&lt;iggy&gt; well... if you really want to check, it is going to be /dev/vdX
&lt;iggy&gt; and lspci will show virtio block device
&lt;bancfc&gt; Thanks iggy I have a few more questions that I'd really appreciate your help with
&lt;iggy&gt; ask away
&lt;bancfc&gt; I am trying to isolate the vm clock so no changes on the host can affect it. This is currently possible with -rtc clock=vm afaik,
&lt;bancfc&gt; but it would be much more helpful for my project's purpose if this can be done through something like libvirt
&lt;bancfc&gt; is this possible with libvirt?
&lt;iggy&gt; that I don't know
&lt;bancfc&gt; the appealing part of using libvirt is the xml settings file it creates, but I think something similar can be done with qemu-kvm cfgfiles option
* iggy hates xml
&lt;bancfc&gt; But that means all settings would have to be imitated but directly for the qemu-kvm utility which is fine if I can get it to do the same things
&lt;bancfc&gt; namely the functionality of isoalted internal networking between two vms
&lt;bancfc&gt; is that possible with qemu-kvm directly?
&lt;iggy&gt; libvirt has an option to pass options directly to qemu-kvm
&lt;bancfc&gt; please tell me how this is done :-)
&lt;bancfc&gt; or where I can know this.
&lt;bancfc&gt; ok nevermind, I just want to know if this means that a setting in the xml file is passed directly to qemu-kvm then?
&lt;iggy&gt; ... You might try asking in the libvirt channel
&lt;bancfc&gt; I did but no one seems to reply...
&lt;iggy&gt; I know it is possible, I don't remember it off the top of my head
&lt;bancfc&gt; Thank you so far for your replies. I am actually working on a project that uses virtualization to route all of a vm's traffic through a TOR instance running on another network facing gateway vm.
&lt;bancfc&gt; Its known as Whonix
&lt;bancfc&gt; Just letting you know that I'd appreciate any help on getting the main issues with porting it to KVM solved
&lt;bancfc&gt; so we can prepare this for a greater good.
&lt;bancfc&gt; This is the bugtracker page I am working on resolving: ../Dev/KVM#How_to_get_virtio_running_for_storage.3F
&lt;bancfc&gt; iggy do you mind if I post the contents of this thread on our forum?
&lt;iggy&gt; no...
</pre>
<pre>&lt;ancfc&gt; Is there any security drawbacks from using a raw image file?
&lt;iggy&gt; bancfc: security drawbacks? like what?
&lt;bancfc&gt; iggy: are its contents directly interpreted by the host or is that when lvm is used only?
&lt;iggy&gt; I'm not sure what you mean by "contents directly interpreted", but raw devices/files just means there's a 1:1 correlation between guest request and host request
&lt;bancfc&gt; like a virus or advanced persistent threat running in the vm
&lt;iggy&gt; the host doesn't "interpret" what it is reading/writing... it just becomes a read/write in the host
&lt;bancfc&gt; ok good just checking. iAnother question is raw snapshotting possible albeit not directly?
&lt;bancfc&gt; I saw something about a differencing image applied in qcow format, yes?
&lt;iggy&gt; only if there's something underlying the files that supports it (btrfs, lvm, zfs, etc)
&lt;bancfc&gt; so not at the "block" level I guess?
&lt;bancfc&gt; iggy: just a question or two about storage if thats ok, becuase we are trying to see which can give maximum performance
&lt;iggy&gt; lvm &gt; raw files &gt; qcow2 &gt; everything else
&lt;bancfc&gt; Is qcow2 the standard? Is qed recommended instead? When is the qcow"3" changes included into the present format?
&lt;bancfc&gt; didn't mean to send this as you had already responded
&lt;bancfc&gt; but anyhow qed seems to have been designed as a speedier replacement for qcow2. But qcow2 were adding changes to become more competitive again
&lt;bancfc&gt; I wanted to know what you think about this and thats all. thanks
&lt;iggy&gt; bancfc: qed is deprecated (as all of it is performance improvements that actually ended up helping were backported to qcow2)
&lt;iggy&gt; the features are handled by feature flags in the qcow2 format, so there's technically no need for a "qcow3" format
&lt;iggy&gt; as long as you don't use the features that qed didn't support (i.e. snapshots, etc.), qcow2 should be as fast
&lt;bancfc&gt; iggy: thanks alot for your help
&lt;iggy&gt; np
</pre>
<pre>* Now talking on #tor
* Topic for #tor is: Welcome to #tor, the discussion channel for Tor users and operators | https://www.torproject.org/ | https://www.torproject.org/docs/faq | https://tor.stackexchange.com/ | Developer discussion on #tor-dev | It is 'Tor', not 'TOR' | non-tor talk =&gt; #nottor
* Topic for #tor set by ChanServ!services@services.oftc.net at Sun Feb  2 13:56:09 2014
* Riastradh (~riastradh@82JAAD1W2.tor-irc.dnsbl.oftc.net) has joined #tor
&lt;expedient&gt; I am working on the Whonix KVM port and ran the leaktest for this bug reported here: https://lists.torproject.org/pipermail/tor-talk/2014-March/032503.html
&lt;expedient&gt; It turns out that this issue applies to us too and its an upstream bug
&lt;arma&gt; i believe you
&lt;arma&gt; upstream meaning what -- the kernel? iptables?
&lt;expedient&gt; I am thinking iptables
&lt;expedient&gt; You guys can probably get to them easier than we can
&lt;arma&gt; is there a patch?
* drtor (~drtor@9YYAAK2T4.tor-irc.dnsbl.oftc.net) has joined #tor
&lt;expedient&gt; We are looking at some workaround in iptables but are not sure how well this will work
&lt;expedient&gt; but one thing for sure is it needs to be fixed upstream because it affects any Linux platform that uses Tor as a transproxy
&lt;expedient&gt; AFAIK Patrick  -Whoix leader- doesn't write kernel level code
&lt;expedient&gt; https://www.whonix.org/old-forum/index.php/topic,243.0.html
* realitygaps has quit (Remote host closed the connection)
&lt;expedient&gt; According to my findings, the leak can be seen in tcpdump running on the host, as direct communication to Google without going through any Tor node. Its a catastrophe by all means
&lt;velope&gt; a kernel patch is not necessarily appropriate, and upstream might well not consider it a bug
&lt;velope&gt; the iptables workaround i gave is in a followup post from mike in that thread
&lt;velope&gt; it would appear that "it needs to be fixed upstream" is just false
&lt;velope&gt; i only skimmed that forum page quickly, and i really don't want to wade through every bit of it
&lt;velope&gt; it contains my workaround based on --state INVALID
&lt;expedient&gt; That's fine we will apply your advice, but are you sure that there is nothing fundamentally wrong with the kernel or iptables though?
&lt;velope&gt; but it doesn't clearly seem to have been used
&lt;velope&gt; apply it and test, a lot
&lt;velope&gt; there is not yet any solid case made that there is something "fundamentally wrong"
&lt;velope&gt; using iptables to redirect for transproxying relies on connection tracking
&lt;arma&gt; i think the conclusion is "it is hard to use these things safely"
&lt;arma&gt; which is not really a bug in upstream so much as a challenge with the approach
&lt;velope&gt; you have to test
&lt;velope&gt; people don't test thoroughly
&lt;velope&gt; they just read a man page or get some cookbook approach from some post, and run with it
&lt;velope&gt; that is why something like this goes unnoticed for so long
&lt;velope&gt; (gee, sounds like some other notable problems ...)
&lt;expedient&gt; Sorry to throw another link your way, but so far this is what we do when testing:
&lt;expedient&gt; ../Dev/Leak_Tests#FIN_ACK_.2F_RST_ACK_-_Leak_Test
&lt;expedient&gt; Any advice if this is enough or anything we should add to ensure its safe after a workaround?
* quiliro has quit (Quit: Leaving.)
&lt;velope&gt; do violent tests with your networking connection
&lt;expedient&gt; You are very sharp btw. That bug was a great find
&lt;velope&gt; interrupt it and restore it at various moments, for various periods
* blumenkraft (~eristisk@a1.networktest.34sp.com) has joined #tor
&lt;velope&gt; well actually i never announced or reported the problem, so even though i fixed the problem for myself a couple years ago, mike appropriately gets credit for finding it. i just get credit for a better workaround.
* amiller has quit (Remote host closed the connection)
&lt;velope&gt; y'all need to understand that connection tracking was never intended to be more than a loose fit around categories of traffic, not some leakproof box
&lt;expedient&gt; do you know if this applies to nftables too?
&lt;expedient&gt; Its gradually becoming the successor to iptables and was added in 3.13
&lt;velope&gt; when the kernel's info on a connection is lost or dropped (timeout), it is gone forever, so subsequent traffic won't be redirected
&lt;velope&gt; i haven't used it and don't know. unless there's been some massively radical re-architecting of connection tracking, it is unlikely to be totally different, though there could be minor differences in behavior.
&lt;arma&gt; the tails approach is starting to look a bit smarter
* eristisk has quit (Ping timeout: 480 seconds)
&lt;expedient&gt; tails is robus but it has to secure an entire rich os stack to protect the user
&lt;arma&gt; approach to torifying the traffic i mean
&lt;expedient&gt; ok
&lt;arma&gt; i don't argue that wrapping stuff in vm's can make it harder for an attacker to break out
&lt;velope&gt; in that tails doesn't rely on transproxy redirection, yes it is better
&lt;expedient&gt; what specifics are you talking about for torifying maybe we can replicate that?
&lt;arma&gt; but torifying outgoing streams is harder to make safe than explicit proxy settings
* darkclown (~darkclown@p2011-ipbf7306marunouchi.tokyo.ocn.ne.jp) has joined #tor
* anong0 has quit (Ping timeout: 480 seconds)
&lt;velope&gt; right, we've always warned that transproxying is not as great as it seems
&lt;arma&gt; "set your proxy settings to use tor, only allow tor to use the network"
* Gentlecat has quit (Ping timeout: 480 seconds)
&lt;arma&gt; so, implicitly, "don't allow anything that is not configured to use tor to use the network"
&lt;velope&gt; and most people just ignore the warnings about transproxying, because "just stuffing everything through tor" seems just what they want, and so simple. but not really.
* mdik is now known as Guest6988
* mdik (~mdik@brln-4d0c41d4.pool.mediaWays.net) has joined #tor
&lt;expedient&gt;  the problem is when a box is rooted the software that is configured to use Tor can do things it shouldn't do
&lt;expedient&gt; but I get your point
* Guest6988 has quit (Ping timeout: 480 seconds)
&lt;expedient&gt; its those people who think stuffing flash through a transproxy pipe think their safe
&lt;velope&gt; that problem only exists for you because you insist on running tor in isolation
* huseby has quit (Ping timeout: 480 seconds)
&lt;arma&gt; "be sure to send unexpected traffic over tor so it can't hurt us"
&lt;arma&gt; vs "be sure to drop unexpected traffic so it can't hurt us"
&lt;arma&gt; option b sure seems wiser
&lt;arma&gt; then a bad guy who breaks in can, at worst, generate traffic that looks expected so it goes through tor
&lt;sd&gt; Useability wise, just having unique circuit per PID might be reasonable compromise.
* TheCthulhu1 has quit (Remote host closed the connection)
&lt;arma&gt; i think that's a totally separate topic
&lt;expedient&gt; arma:  an important goal we are trying to achieve is for operators of onion services to be able to have a fighting chance in case they are targeted.
&lt;sd&gt; Trying to educate users "don't throw * at tor, but selectively firewall everything" seems like a losing battle though.
&lt;arma&gt; it does? screw those users then.
&lt;arma&gt; better to write software that works well
&lt;arma&gt; and the ones who want to use the safe software will use it
&lt;velope&gt; right, it can only be won or lost if you consider it to be a battle. users screw themselves, every day
&lt;arma&gt; and we can't do much for the ones who choose to do it wrong
&lt;velope&gt; a better analogy might be leading a horse to water
* Rym has quit (Ping timeout: 480 seconds)
&lt;sd&gt; That sounds like somewhat elitist stance. "You dont deserve privacy because you're dumb" vs "Safe defaults built in."
&lt;velope&gt; obviously better defaults are better, if they actually exist and are actually safer
&lt;sd&gt; (I can see how it can go downhill from there if users are babysitted too much, though)
&lt;velope&gt; but defaults never cover everything, because software is flexible, and people want it to be
&lt;expedient&gt; The less decisions that need to be made in security, the better everyone will be
&lt;expedient&gt; and hence why transproxy is an idea worth working towards
&lt;arma&gt; so give them only the applications that you know behave well, with those applications configured to use tor correctly
&lt;velope&gt; that principle is correct but the conclusion about transproxying is wrong
&lt;arma&gt; letting them pick their own apps and hope they are safe is a recipe for surprises again and again
&lt;expedient&gt; we do, but we can't guarantee that nothing dangerous happens when these apps are compromised unless it *all* goes through Tor
&lt;sd&gt; Ultimately the problem with transproxy is just that it is difficult to identify the source app.
* sd uses assigned source port ranges, but it is far from ideal
&lt;expedient&gt; Kgpg, TorBrowser and xchat come by default
&lt;velope&gt; even if it all goes through tor, you can't guarantee that nothing dangerous happens, you only have considered the first layer of potential problems
&lt;expedient&gt; updated system and AppArmor are other layers we have
&lt;velope&gt; that's all very nice and good
&lt;expedient&gt; but against a well funded adversary you must throuw everything in the toolbox and the toolbox itself to protect users
&lt;velope&gt; actually it is just more and more desperate band-aiding
&lt;velope&gt; the effort would be much better directed towards thoroughly auditing apps
&lt;expedient&gt; Auditing firefox is out of our league
&lt;expedient&gt; but we have verifiable builds for Whonix
&lt;sd&gt; Velope, that goal is far from realistic when we're talking huge blobs of code such as web browser or libpurple.
&lt;velope&gt; it is the true longterm challenge that people get scared away from all the time
* mttp_ (~mttp@9YYAAK2WG.tor-irc.dnsbl.oftc.net) has joined #tor
&lt;velope&gt; and the "community" pays for it dearly with things like heartbleed
</pre>
<h1><span class="mw-headline" id="Footnotes">Footnotes</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a data-href="/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=104" href="https://www.whonix.org/w/index.php?title=Dev/KVM&amp;action=edit&amp;section=104.html" title="Edit section: Footnotes">edit</a><span class="mw-editsection-bracket">]</span></span></h1>
<div class="reflist" style="list-style-type: decimal;">
<div class="mw-references-wrap mw-references-columns"><ol class="references">
<li id="cite_note-1"><span class="mw-cite-backlink"><a href="#cite_ref-1">↑</a></span> <span class="reference-text"><a class="external free" data-href="https://unix.stackexchange.com/questions/13771/dd-if-dev-random-is-randomly-bottlenecked-with-big-time-lags-but-i-have-no-i" href="https://unix.stackexchange.com/questions/13771/dd-if-dev-random-is-randomly-bottlenecked-with-big-time-lags-but-i-have-no-i" rel="noreferrer noopener" target="_blank">https://unix.stackexchange.com/questions/13771/dd-if-dev-random-is-randomly-bottlenecked-with-big-time-lags-but-i-have-no-i</a></span>
</li>
<li id="cite_note-2"><span class="mw-cite-backlink"><a href="#cite_ref-2">↑</a></span> <span class="reference-text"><a class="external free" data-href="https://www.redhat.com/archives/libvir-list/2014-August/msg01010.html" href="https://www.redhat.com/archives/libvir-list/2014-August/msg01010.html" rel="noreferrer noopener" target="_blank">https://www.redhat.com/archives/libvir-list/2014-August/msg01010.html</a></span>
</li>
<li id="cite_note-3"><span class="mw-cite-backlink"><a href="#cite_ref-3">↑</a></span> <span class="reference-text"><a class="external free" data-href="https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/6/html/Virtualization_Administration_Guide/chap-KSM.html" href="https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/6/html/Virtualization_Administration_Guide/chap-KSM.html" rel="noreferrer noopener" target="_blank">https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/6/html/Virtualization_Administration_Guide/chap-KSM.html</a></span>
</li>
<li id="cite_note-4"><span class="mw-cite-backlink"><a href="#cite_ref-4">↑</a></span> <span class="reference-text"><a class="external free" data-href="http://libvirt.org/formatdomain.html#elementsMemoryBacking" href="http://libvirt.org/formatdomain.html" rel="noreferrer noopener" target="_blank">http://libvirt.org/formatdomain.html#elementsMemoryBacking</a></span>
</li>
<li id="cite_note-5"><span class="mw-cite-backlink"><a href="#cite_ref-5">↑</a></span> <span class="reference-text"><a class="external free" data-href="https://www.suse.com/documentation/sles11/book_kvm/data/kvm_qemu_ksm.html" href="https://www.suse.com/documentation/sles11/book_kvm/data/kvm_qemu_ksm.html" rel="noreferrer noopener" target="_blank">https://www.suse.com/documentation/sles11/book_kvm/data/kvm_qemu_ksm.html</a></span>
</li>
<li id="cite_note-6"><span class="mw-cite-backlink"><a href="#cite_ref-6">↑</a></span> <span class="reference-text"><a class="external free" data-href="https://staff.aist.go.jp/k.suzaki/EuroSec2011-suzaki.pdf" href="https://staff.aist.go.jp/k.suzaki/EuroSec2011-suzaki.pdf" rel="noreferrer noopener" target="_blank">https://staff.aist.go.jp/k.suzaki/EuroSec2011-suzaki.pdf</a></span>
</li>
<li id="cite_note-7"><span class="mw-cite-backlink"><a href="#cite_ref-7">↑</a></span> <span class="reference-text"><a class="external free" data-href="https://fedoraproject.org/wiki/Features/KVM_Huge_Page_Backed_Memory#Detailed_Description" href="https://fedoraproject.org/wiki/Features/KVM_Huge_Page_Backed_Memory" rel="noreferrer noopener" target="_blank">https://fedoraproject.org/wiki/Features/KVM_Huge_Page_Backed_Memory#Detailed_Description</a></span>
</li>
<li id="cite_note-8"><span class="mw-cite-backlink"><a href="#cite_ref-8">↑</a></span> <span class="reference-text"><a class="external free" data-href="https://bugzilla.redhat.com/show_bug.cgi?id=515741" href="https://bugzilla.redhat.com/show_bug.cgi?id=515741" rel="noreferrer noopener" target="_blank">https://bugzilla.redhat.com/show_bug.cgi?id=515741</a></span>
</li>
<li id="cite_note-9"><span class="mw-cite-backlink"><a href="#cite_ref-9">↑</a></span> <span class="reference-text"><a class="external free" data-href="http://www.linux-kvm.org/wiki/images/1/19/2012-forum-memory-mgmt.pdf" href="http://www.linux-kvm.org/wiki/images/1/19/2012-forum-memory-mgmt.pdf" rel="noreferrer noopener" target="_blank">http://www.linux-kvm.org/wiki/images/1/19/2012-forum-memory-mgmt.pdf</a></span>
</li>
<li id="cite_note-10"><span class="mw-cite-backlink"><a href="#cite_ref-10">↑</a></span> <span class="reference-text"><a class="external free" data-href="https://fedoraproject.org/wiki/Features/KVM_Huge_Page_Backed_Memory#Benefit_to_Fedora" href="https://fedoraproject.org/wiki/Features/KVM_Huge_Page_Backed_Memory" rel="noreferrer noopener" target="_blank">https://fedoraproject.org/wiki/Features/KVM_Huge_Page_Backed_Memory#Benefit_to_Fedora</a></span>
</li>
<li id="cite_note-11"><span class="mw-cite-backlink"><a href="#cite_ref-11">↑</a></span> <span class="reference-text"><a class="external free" data-href="http://www.linux-kvm.org/page/Projects/auto-ballooning" href="http://www.linux-kvm.org/page/Projects/auto-ballooning" rel="noreferrer noopener" target="_blank">http://www.linux-kvm.org/page/Projects/auto-ballooning</a></span>
</li>
</ol></div></div>
<hr/>
<div style="padding-bottom:1px; padding-top:6px; border:thin solid black; background:#EEEEEE; text-align:center;"><u>Random News:</u>
<p>Are you proficient with <b>iptables</b>? Want to contribute? Check out possible <a class="external text" data-href="https://phabricator.whonix.org/maniphest/?statuses=open%28%29&amp;projects=PHID-PROJ-aanxoadr5ziixgbisy22#R" href="https://phabricator.whonix.org/maniphest/?statuses=open%28%29&amp;projects=PHID-PROJ-aanxoadr5ziixgbisy22" rel="noreferrer noopener" target="_blank">improvements to iptables</a>. Please come and introduce yourself in the <a class="external text" data-href="https://forums.whonix.org/c/development" href="https://forums.whonix.org/c/development" rel="noreferrer noopener" target="_blank">development forum</a>.
</p>
</div>
<hr/><p><font size="-1"><a class="external text" data-href="../Dev/KVM" href="../Dev/KVM" rel="noreferrer noopener" target="_blank">https</a> | (<a data-href="/wiki/Forcing_.onion_on_Whonix.org" href="../Forcing_.onion_on_Whonix.org.html" title="Forcing .onion on Whonix.org">forcing</a>) <a class="external text" data-href="http://dds6qkxpwdeubwucdiaord2xgbbeyds25rbsgr73tbfpqpt4a6vjwsyd.onion/wiki/Dev/KVM" href="http://dds6qkxpwdeubwucdiaord2xgbbeyds25rbsgr73tbfpqpt4a6vjwsyd.onion/wiki/Dev/KVM" rel="noreferrer noopener" target="_blank">onion</a><br/>
</font></p><font size="-1"></font><p><font size="-1">Share: <a data-href="https://twitter.com/intent/tweet?url=../Dev/KVM&amp;text=&amp;via=Whonix" href="https://twitter.com/intent/tweet?url=../Dev/KVM&amp;text=&amp;via=Whonix">Twitter</a>
|
<a data-href="https://facebook.com/sharer.php?u=../Dev/KVM" href="https://facebook.com/sharer.php?u=../Dev/KVM">Facebook</a></font>
</p><p><font size="-1">This is a wiki. Want to improve this page? Help is welcome and volunteer contributions are happily considered! See <a class="external text" data-href="https://github.com/Whonix/Whonix/blob/master/CONTRIBUTING.md" href="https://github.com/Whonix/Whonix/blob/master/CONTRIBUTING.md" rel="noreferrer noopener" target="_blank">Conditions for Contributions to Whonix</a>, then <a data-href="/w/index.php?title=Dev/KVM&amp;action=edit" href="https://www.whonix.org/w/index.php?title=Dev/KVM&amp;action=edit">Edit</a>! IP addresses are scrubbed, but editing over Tor is recommended. Edits are held for moderation.</font>
</p><p><font size="-1">Whonix is a <a class="external text" data-href="http://www.openinventionnetwork.com/licensees.php" href="http://www.openinventionnetwork.com/licensees.php" rel="noreferrer noopener" target="_blank">licensee</a> of the Open Invention Network. Unless otherwise noted, the content of this page is <a data-href="/wiki/Whonix:Copyrights" href="../Whonix:Copyrights.html" title="Whonix:Copyrights">copyrighted</a> and licensed under the same Libre Software <a class="external text" data-href="https://github.com/Whonix/Whonix/blob/master/debian/copyright" href="https://github.com/Whonix/Whonix/blob/master/debian/copyright" rel="noreferrer noopener" target="_blank">license</a> as Whonix itself. (<a data-href="/wiki/Why_Whonix_is_Free_Software" href="../Why_Whonix_is_Free_Software.html" title="Why Whonix is Free Software">Why?</a>)</font>
</p>
<!-- 
NewPP limit report
Cached time: 20181008220639
Cache expiry: 0
Dynamic content: true
CPU time usage: 0.228 seconds
Real time usage: 0.229 seconds
Preprocessor visited node count: 1217/1000000
Preprocessor generated node count: 2600/1000000
Post‐expand include size: 3128/2097152 bytes
Template argument size: 36/2097152 bytes
Highest expansion depth: 6/40
Expensive parser function count: 0/100
Unstrip recursion depth: 0/20
Unstrip post‐expand size: 34974/5000000 bytes
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00%   46.443      1 -total
 33.66%   15.631      1 Template:Footer
 19.25%    8.940      1 Template:Reflist
 14.13%    6.563      1 Template:FooterLight
  9.77%    4.536      1 Template:Footer_this_is_a_wiki
  8.44%    3.922      1 Template:Share
  8.24%    3.825      1 Template:Header
  7.18%    3.333      1 Template:Edit_it
  3.75%    1.743      1 Template:RandomNews
  3.52%    1.635      1 Template:Code
-->
</div></div><div class="printfooter">
Retrieved from "<a data-href="https://www.whonix.org/w/index.php?title=Dev/KVM&amp;oldid=35113" dir="ltr" href="https://www.whonix.org/w/index.php?title=Dev/KVM&amp;oldid=35113">https://www.whonix.org/w/index.php?title=Dev/KVM&amp;oldid=35113</a>"</div>
<div class="clear_both"></div>
</div>
<div class="group"><div class="catlinks" data-mw="interface" id="catlinks"><div class="mw-normal-catlinks" id="mw-normal-catlinks"><a data-href="/wiki/Special:Categories" href="../Special:Categories.html" title="Special:Categories">Category</a>: <ul><li><a data-href="/wiki/Category:Documentation" href="../Category:Documentation.html" title="Category:Documentation">Documentation</a></li></ul></div></div></div>
</div>
</div>
</div>
<footer class="row">
<div id="footer">
<div class="small-12 large-centered columns text-center" id="footer-left">
<ul id="footer-left">
<li id="footer-lastmod"> This page was last edited on 1 August 2018, at 07:08.</li>
<li id="footer-Priority_Support"><a data-href="/wiki/Priority_Support" href="../Priority_Support.html" title="Priority Support">Priority Support</a></li>
<li id="footer-Investors"><a data-href="/wiki/Investors" href="../Investors.html" title="Investors">Investors</a></li>
<li id="footer-Professional_Support"><a data-href="/wiki/Professional_Support" href="../Professional_Support.html" title="Professional Support">Professional Support</a></li>
</ul>
</div>
<div class="large-12 small-12 columns" id="footer-right-icons">
<ul id="poweredby">
</ul>
</div>
</div>
</footer>
</div>

</body>
<!-- Cached/compressed 20181008220639 -->
</html>
